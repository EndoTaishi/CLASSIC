<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/APREP.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('APREP_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">APREP.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates various land surface parameters.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5fe4fa336815bc509d646edae0744405"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="APREP_8f.html#a5fe4fa336815bc509d646edae0744405">aprep</a> (FC, FG, FCS, FGS, PAICAN, PAICNS, FSVF, FSVFS, FRAINC, FSNOWC, FRAICS, FSNOCS, RAICAN, RAICNS, SNOCAN, SNOCNS, DISP, DISPS, ZOMLNC, ZOMLCS, ZOELNC, ZOELCS, ZOMLNG, ZOMLNS, ZOELNG, ZOELNS, CHCAP, CHCAPS, CMASSC, CMASCS, CWLCAP, CWFCAP, CWLCPS, CWFCPS, RBCOEF, ZPLIMC, ZPLIMG, ZPLMCS, ZPLMGS, HTCC, HTCS, HTC, FROOT, FROOTS, WTRC, WTRS, WTRG, CMAI, PAI, PAIS, AIL, FCAN, FCANS, PSIGND, FCANMX, ZOLN, PAIMAX, PAIMIN, CWGTMX, ZRTMAX, PAIDAT, HGTDAT, THLIQ, THICE, TBAR, RCAN, SNCAN, TCAN, GROWTH, ZSNOW, TSNOW, FSNOW, RHOSNO, SNO, Z0ORO, ZBLEND, ZPLMG0, ZPLMS0, TA, RHOAIR, RADJ, DLON, RHOSNI, DELZ, DELZW, ZBOTW, THPOR, THLMIN, PSISAT, BI, PSIWLT, HCPS, ISAND, ILG, IL1, IL2, JL, IC, ICP1, IG, IDAY, IDISP, IZREF, IWF, IPAI, IHGT, RMAT, H, HS, CWCPAV, GROWA, GROWN, GROWB, RRESID, SRESID, FRTOT, FRTOTS, FCANCMX, ICTEM, ctem_on, RMATC, AILC, PAIC, AILCG, L2MAX, NOL2PFTS, AILCGS, FCANCS, FCANC, ZOLNC, CMASVEGC, SLAIC, ipeatland)</td></tr>
<tr class="memdesc:a5fe4fa336815bc509d646edae0744405"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is adaptable to any number of vegetation categories recognized by CLASS (e.g. needleleaf trees, broadleaf trees, crops and grass), if an unknown PFT is present, a call to abort number of is performed.  <a href="#a5fe4fa336815bc509d646edae0744405">More...</a><br /></td></tr>
<tr class="separator:a5fe4fa336815bc509d646edae0744405"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates various land surface parameters. </p>
<dl class="section author"><dt>Author</dt><dd>D. Verseghy, M. Lazare, V. Fortin, V. Arora, E. Chan, P. Bartlett, Y. Wu, J. Melton, A. Wu, Y. Delage </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5fe4fa336815bc509d646edae0744405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe4fa336815bc509d646edae0744405">&#9670;&nbsp;</a></span>aprep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine aprep </td>
          <td>(</td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PAICNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSVF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSVFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRAINC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOWC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRAICS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>DISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>DISPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>CHCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CHCAPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RBCOEF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ig)&#160;</td>
          <td class="paramname"><em>HTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>CMAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>AIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCANS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PSIGND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icp1)&#160;</td>
          <td class="paramname"><em>FCANMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,icp1)&#160;</td>
          <td class="paramname"><em>ZOLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>CWGTMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ZRTMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>HGTDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>SNCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GROWTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>Z0ORO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZBLEND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMG0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMS0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RADJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>DLON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSIWLT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IDAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IDISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IZREF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IWF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IPAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IHGT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic,ig)&#160;</td>
          <td class="paramname"><em>RMAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension     (ilg,ic)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ic)&#160;</td>
          <td class="paramname"><em>HS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWCPAV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RRESID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SRESID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FRTOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRTOTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANCMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICTEM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>ctem_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic,ig)&#160;</td>
          <td class="paramname"><em>RMATC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>AILC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>AILCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>L2MAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ic)&#160;</td>
          <td class="paramname"><em>NOL2PFTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ictem)&#160;</td>
          <td class="paramname"><em>AILCGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ZOLNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>CMASVEGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>SLAIC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ipeatland</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is adaptable to any number of vegetation categories recognized by CLASS (e.g. needleleaf trees, broadleaf trees, crops and grass), if an unknown PFT is present, a call to abort number of is performed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fg</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fcs</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fgs</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">paican</td><td>Plant area index of canopy over bare ground ( <img class="formulaInl" alt="$\Lambda_p$" src="form_28.png"/>) [ ]</td></tr>
    <tr><td class="paramname">paicns</td><td>Plant area index of canopy over snow ( <img class="formulaInl" alt="$\Lambda_p$" src="form_28.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fsvf</td><td>Sky view factor for bare ground under canopy ( <img class="formulaInl" alt="$\chi$" src="form_29.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fsvfs</td><td>Sky view factor for snow under canopy ( <img class="formulaInl" alt="$\chi$" src="form_29.png"/>) [ ]</td></tr>
    <tr><td class="paramname">frainc</td><td>Fractional coverage of canopy by liquid water over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">fsnowc</td><td>Fractional coverage of canopy by frozen water over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">fraics</td><td>Fractional coverage of canopy by liquid water over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">fsnocs</td><td>Fractional coverage of canopy by frozen water over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">raican</td><td>Intercepted liquid water stored on canopy over bare ground ( <img class="formulaInl" alt="$W_l$" src="form_30.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">raicns</td><td>Intercepted liquid water stored on canopy over snow ( <img class="formulaInl" alt="$W_l$" src="form_30.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">snocan</td><td>Intercepted frozen water stored on canopy over bare soil ( <img class="formulaInl" alt="$W_f$" src="form_32.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">snocns</td><td>Intercepted frozen water stored on canopy over snow ( <img class="formulaInl" alt="$W_f$" src="form_32.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">disp</td><td>Displacement height of vegetation over bare ground (d) [m]</td></tr>
    <tr><td class="paramname">disps</td><td>Displacement height of vegetation over snow (d) [m]</td></tr>
    <tr><td class="paramname">zomlnc</td><td>Logarithm of roughness length for momentum of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">zomlcs</td><td>Logarithm of roughness length for momentum of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">zoelnc</td><td>Logarithm of roughness length for heat of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">zoelcs</td><td>Logarithm of roughness length for heat of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">zomlng</td><td>Logarithm of roughness length for momentum of bare ground [ ]</td></tr>
    <tr><td class="paramname">zomlns</td><td>Logarithm of roughness length for momentum of snow [ ]</td></tr>
    <tr><td class="paramname">zoelng</td><td>Logarithm of roughness length for heat of bare ground [ ]</td></tr>
    <tr><td class="paramname">zoelns</td><td>Logarithm of roughness length for heat of snow [ ]</td></tr>
    <tr><td class="paramname">rbcoef</td><td>Parameter for calculation of leaf boundary resistance ( <img class="formulaInl" alt="$C_{rb}$" src="form_33.png"/>)</td></tr>
    <tr><td class="paramname">chcap</td><td>Heat capacity of canopy over bare ground [ <img class="formulaInl" alt="$J m^{-2} K^{-1}$" src="form_34.png"/>]</td></tr>
    <tr><td class="paramname">chcaps</td><td>Heat capacity of canopy over snow [ <img class="formulaInl" alt="$J m^{-2} K^{-1}$" src="form_34.png"/>]</td></tr>
    <tr><td class="paramname">cmassc</td><td>Mass of canopy over bare ground [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">cmascs</td><td>Mass of canopy over snow [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">cwlcap</td><td>Storage capacity of canopy over bare ground for liquid water ( <img class="formulaInl" alt="$W_{l,max}$" src="form_35.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">cwfcap</td><td>Storage capacity of canopy over bare ground for frozen water ( <img class="formulaInl" alt="$W_{f,max}$" src="form_36.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">cwlcps</td><td>Storage capacity of canopy over snow for liquid water ( <img class="formulaInl" alt="$W_{l,max}$" src="form_35.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">cwfcps</td><td>Storage capacity of canopy over snow for frozen water ( <img class="formulaInl" alt="$W_{f,max}$" src="form_36.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">zplimc</td><td>Maximum water ponding depth for ground under canopy [m]</td></tr>
    <tr><td class="paramname">zplimg</td><td>Maximum water ponding depth for bare ground [m]</td></tr>
    <tr><td class="paramname">zplmcs</td><td>Maximum water ponding depth for ground under snow under canopy [m]</td></tr>
    <tr><td class="paramname">zplmgs</td><td>Maximum water ponding depth for ground under snow [m]</td></tr>
    <tr><td class="paramname">htcc</td><td>Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_37.png"/>]</td></tr>
    <tr><td class="paramname">htcs</td><td>Diagnosed internal energy change of snow pack due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_37.png"/>]</td></tr>
    <tr><td class="paramname">wtrc</td><td>Diagnosed residual water transferred off the vegetation canopy [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_38.png"/>]</td></tr>
    <tr><td class="paramname">wtrs</td><td>Diagnosed residual water transferred into or out of the snow pack [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_38.png"/>]</td></tr>
    <tr><td class="paramname">wtrg</td><td>Diagnosed residual water transferred into or out of the soil [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_38.png"/>]</td></tr>
    <tr><td class="paramname">cmai</td><td>Aggregated mass of vegetation canopy [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">froot</td><td>Fraction of total transpiration contributed by soil layer over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">froots</td><td>Fraction of total transpiration contributed by soil layer over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">htc</td><td>Diagnosed internal energy change of soil layer due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_37.png"/>]</td></tr>
    <tr><td class="paramname">pai</td><td>Plant area index of vegetation category over bare ground [ ]</td></tr>
    <tr><td class="paramname">pais</td><td>Plant area index of vegetation category over snow [ ]</td></tr>
    <tr><td class="paramname">ail</td><td>Leaf area index of vegetation category over bare ground [ ]</td></tr>
    <tr><td class="paramname">fcan</td><td>Fractional coverage of vegetation category over bare ground ( <img class="formulaInl" alt="$X_i$" src="form_39.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fcans</td><td>Fractional coverage of vegetation category over snow ( <img class="formulaInl" alt="$X_i$" src="form_39.png"/>) [ ]</td></tr>
    <tr><td class="paramname">psignd</td><td>Minimum liquid moisture suction in soil layers [m]</td></tr>
    <tr><td class="paramname">ipeatland</td><td>Peatland flag: 0 = not a peatland, 1= bog, 2 = fen</td></tr>
    <tr><td class="paramname">fcanmx</td><td>Maximum fractional coverage of modelled area by vegetation category [ ]</td></tr>
    <tr><td class="paramname">zoln</td><td>Natural logarithm of maximum roughness length of vegetation category [ ]</td></tr>
    <tr><td class="paramname">paimax</td><td>Maximum plant area index of vegetation category [ ]</td></tr>
    <tr><td class="paramname">paimin</td><td>Minimum plant area index of vegetation category [ ]</td></tr>
    <tr><td class="paramname">cwgtmx</td><td>Maximum canopy mass for vegetation category [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">zrtmax</td><td>Maximum rooting depth of vegetation category [m]</td></tr>
    <tr><td class="paramname">paidat</td><td>Optional user-specified value of plant area indices of vegetation categories to override CLASS-calculated values [ ]</td></tr>
    <tr><td class="paramname">hgtdat</td><td>Optional user-specified values of height of vegetation categories to override CLASS-calculated values [m]</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers ( <img class="formulaInl" alt="$\theta$" src="form_40.png"/> l) [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_41.png"/>]</td></tr>
    <tr><td class="paramname">thice</td><td>Frozen water content of soil layers under vegetation [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_41.png"/>]</td></tr>
    <tr><td class="paramname">tbar</td><td>Temperature of soil layers [K]</td></tr>
    <tr><td class="paramname">rcan</td><td>Intercepted liquid water stored on canopy ( <img class="formulaInl" alt="$W_l$" src="form_30.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">sncan</td><td>Intercepted frozen water stored on canopy ( <img class="formulaInl" alt="$W_f$" src="form_32.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">tcan</td><td>Vegetation canopy temperature [K]</td></tr>
    <tr><td class="paramname">growth</td><td>Vegetation growth index [ ]</td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack ( <img class="formulaInl" alt="$z_s$" src="form_42.png"/>) [m]</td></tr>
    <tr><td class="paramname">tsnow</td><td>Snowpack temperature [K]</td></tr>
    <tr><td class="paramname">fsnow</td><td>Diagnosed fractional snow coverage [ ]</td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow ( <img class="formulaInl" alt="$ s$" src="form_43.png"/>) [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_44.png"/>]</td></tr>
    <tr><td class="paramname">sno</td><td>Mass of snow pack ( <img class="formulaInl" alt="$W_s$" src="form_45.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_31.png"/>]</td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height [K]</td></tr>
    <tr><td class="paramname">rhoair</td><td>Density of air [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_44.png"/>]</td></tr>
    <tr><td class="paramname">dlon</td><td>Longitude of grid cell (east of Greenwich) [degrees]</td></tr>
    <tr><td class="paramname">z0oro</td><td>Orographic roughness length [m]</td></tr>
    <tr><td class="paramname">zblend</td><td>Atmospheric blending height for surface roughness length averaging ( <img class="formulaInl" alt="$z_b$" src="form_46.png"/>) [m]</td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow ( <img class="formulaInl" alt="$\rho$" src="form_47.png"/> s,f) [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_44.png"/>]</td></tr>
    <tr><td class="paramname">zplmg0</td><td>Maximum water ponding depth for snow-free subareas (user-specified when running MESH code) [m]</td></tr>
    <tr><td class="paramname">zplms0</td><td>Maximum water ponding depth for snow-covered subareas (user-specified when running MESH code) [m]</td></tr>
    <tr><td class="paramname">radj</td><td>Latitude of grid cell (positive north of equator) [rad]</td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth to permeable bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer ( <img class="formulaInl" alt="$\theta$" src="form_40.png"/> p) [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_41.png"/>]</td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_41.png"/>]</td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation ( <img class="formulaInl" alt="$\Psi$" src="form_48.png"/> sat) [m]</td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical "b" parameter [ ]</td></tr>
    <tr><td class="paramname">psiwlt</td><td>Soil moisture suction at wilting point ( <img class="formulaInl" alt="$\Psi$" src="form_48.png"/> w) [m]</td></tr>
    <tr><td class="paramname">hcps</td><td>Volumetric heat capacity of soil particles [ <img class="formulaInl" alt="$J m^{-3}$" src="form_49.png"/>]</td></tr>
    <tr><td class="paramname">delz</td><td>Soil layer thickness [m]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">ailcg</td><td>GREEN LAI FOR USE WITH PHTSYN SUBROUTINE</td></tr>
    <tr><td class="paramname">ailcgs</td><td>GREEN LAI FOR CANOPY OVER SNOW SUB-AREA</td></tr>
    <tr><td class="paramname">fcanc</td><td>FRACTION OF CANOPY OVER GROUND FOR CTEM's 9 PFTs</td></tr>
    <tr><td class="paramname">fcancs</td><td>FRACTION OF CANOPY OVER SNOW FOR CTEM's 9 PFTs</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>if idisp=0, vegetation displacement heights are ignored, because the atmospheric model considers these to be part of the "terrain". if idisp=1, vegetation displacement heights are calculated.</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>if izref=1, the bottom of the atmospheric model is taken lie at the ground surface. if izref=2, the bottom of the atmospheric model is taken to lie at the local roughness height.</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>if idisp=0, vegetation displacement heights are ignored, because the atmospheric model considers these to be part of the "terrain". if idisp=1, vegetation displacement heights are calculated.</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>if izref=1, the bottom of the atmospheric model is taken lie at the ground surface. if izref=2, the bottom of the atmospheric model is taken to lie at the local roughness height. </td></tr>
  </table>
  </dd>
</dl>
<p>In the 450 and 500 loops, the fraction of plant roots in each soil layer is calculated. If CLASS is being run coupled to CTEM, the CTEM-derived values are assigned. Otherwise, for each vegetation category the rooting depth ZROOT is set to the background maximum value, except in the case of crops, for which it is set to the maximum scaled by GROWA. If the soil permeable depth is less than ZROOT, ZROOT is set to this depth instead. Values are then assigned in the matrix RMAT, which stores the fraction of roots in each vegetation category for each soil layer. According to Feddes et al. (1974) <a class="el" href="citelist.html#CITEREF_Feddes1974-ff">[33]</a> , the fractional root volume R(z) below a depth z is well represented for many varieties of plants by the following exponential function: <img class="formulaInl" alt="$R(z) = a_1 exp(-3.0z) + a_2.$" src="form_73.png"/></p>
<p>Making use of the boundary conditions <img class="formulaInl" alt="$R(0) = 1$" src="form_74.png"/> and <img class="formulaInl" alt="$R(z_r ) = 0$" src="form_75.png"/>, where <img class="formulaInl" alt="$z_r$" src="form_76.png"/> is the rooting depth ZROOT, it can be seen that the fraction of roots within a soil depth interval <img class="formulaInl" alt="$\Delta z$" src="form_77.png"/> can be obtained as the difference between R(z) evaluated at the top <img class="formulaInl" alt="$(z_T)$" src="form_78.png"/> and bottom <img class="formulaInl" alt="$(z_B)$" src="form_79.png"/> of the interval: <img class="formulaInl" alt="$R(\Delta z) = [exp(-3.0z_T) - exp(-3.0z_B)]/ [1 - exp(-3.0z_r)]$" src="form_80.png"/></p>
<p>The total fraction of roots in each soil layer, FROOT for snow-free areas and FROOTS for snow-covered areas, can then be determined as weighted averages over the four vegetation categories.</p>
<p>In loop 450, a leaf boundary resistance parameter <img class="formulaInl" alt="$C_{rb}$" src="form_33.png"/> , incorporating the plant area indices of the four vegetation subareas, is also calculated for later use in subroutine TSOLVC: <img class="formulaInl" alt="$C_{rb} = C_l \Lambda_{p,i}^{0.5} /0.75 \bullet [1 - exp(-0.75 \Lambda_{p,i}^{0.5} )]$" src="form_81.png"/> where <img class="formulaInl" alt="$C_l$" src="form_82.png"/> is a parameter that varies with the vegetation category. The aggregated value of <img class="formulaInl" alt="$C_{rb}$" src="form_33.png"/> is obtained as a weighted average over the four vegetation categories over bare ground and snow cover.</p>
<p>In loop 600, the sky view factor <img class="formulaInl" alt="$\chi$" src="form_29.png"/> of the ground underlying the canopy is calculated for the vegetated subareas. The standard approach is to determine <img class="formulaInl" alt="$\chi$" src="form_29.png"/> as an exponential function of the plant area index <img class="formulaInl" alt="$\Lambda_p$" src="form_28.png"/> : <img class="formulaInl" alt="$\chi = exp[-c \Lambda_p ]$" src="form_83.png"/> where c is a constant depending on the vegetation category. The subarea values of <img class="formulaInl" alt="$\chi$" src="form_29.png"/> are obtained as weighted averages over the four vegetation categories.</p>
<p>In the 650 loop, the fraction of the total transpiration of water by plants that is extracted from each soil layer is determined. This is done by weighting the values of FROOT and FROOTS calculated above by the relative soil moisture suction in each layer: <img class="formulaInl" alt="$( \Psi_w - \Psi_i )/( \Psi_w - \Psi_{sat} )$" src="form_84.png"/> where <img class="formulaInl" alt="$\Psi_i$" src="form_85.png"/> , the soil moisture suction in the layer, is obtained as <img class="formulaInl" alt="$\Psi_i = \Psi_{sat} ( \theta_{l,i} / \theta_p )^{-b}$" src="form_86.png"/> In these equations <img class="formulaInl" alt="$\Psi_w$" src="form_87.png"/> is the soil moisture suction at the wilting point, <img class="formulaInl" alt="$\Psi_{sat}$" src="form_88.png"/> is the suction at saturation, <img class="formulaInl" alt="$\theta_{l,i}$" src="form_89.png"/> is the volumetric liquid water content of the soil layer, <img class="formulaInl" alt="$\theta_p$" src="form_90.png"/> is the pore volume, and b is an empirical parameter developed by Clapp and Hornberger (1978) <a class="el" href="citelist.html#CITEREF_Clapp1978-898">[20]</a>. The layer values of FROOT and FROOTS are then re-normalized so that their sum adds up to unity. In this loop, the representative soil moisture suction PSIGND is also calculated for later use in the vegetation stomatal resistance formulation, as the minimum value of <img class="formulaInl" alt="$\Psi_i$" src="form_85.png"/> and <img class="formulaInl" alt="$\Psi_w$" src="form_87.png"/> over all the soil layers.</p>
<p>Finally, in loop 800 the aggregated canopy plant area indices PAICAN and PAICNS are set back to their original values, from the modified values used for the snow interception calculations above; and if CLASS is being run coupled with CTEM, a set of CTEM-related calculations is performed.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="APREP_8f.html">APREP.f</a></li>
    <li class="footer">Generated on Thu Jul 4 2019 12:03:55 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
