<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: disturbance_scheme Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacedisturbance__scheme.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">disturbance_scheme Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parameterization of fire-related disturbance.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:adad01ea5332d847bada5b4ba62f0a563"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedisturbance__scheme.html#adad01ea5332d847bada5b4ba62f0a563">disturb</a> (stemmass, rootmass, gleafmas, bleafmas,thliq,THLW,THFC,uwind,vwind,lightng,fcancmx, litrmass,prbfrhuc, rmatctem, extnprob, transientPOPD,il1,il2,sort, nol2pfts,grclarea,thice,popdin, lucemcom,dofire,currlat,iday,fsnow,isand,</td></tr>
<tr class="memdesc:adad01ea5332d847bada5b4ba62f0a563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates whether fire occurs, burned area, amount of C emitted and litter generated.  <a href="#adad01ea5332d847bada5b4ba62f0a563">More...</a><br /></td></tr>
<tr class="separator:adad01ea5332d847bada5b4ba62f0a563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:gae72fa0c94541c3e88a45d71f2442be9c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__disturbance__scheme__burntobare.html#gae72fa0c94541c3e88a45d71f2442be9c">burntobare</a> (il1, il2, nilg, sort, pvgbioms, pgavltms, pgavscms, fcancmx, burnvegf, stemmass, rootmass, gleafmas, bleafmas, litrmass, soilcmas, pstemmass, pgleafmass, nppveg)</td></tr>
<tr class="memdesc:gae72fa0c94541c3e88a45d71f2442be9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update fractional coverages of pfts to take into account the area burnt by fire. Adjust all pools with new densities in their new areas and increase bare fraction. And while we are doing this also run a small check to make sure grid averaged quantities do not get messed up.  <a href="group__disturbance__scheme__burntobare.html#gae72fa0c94541c3e88a45d71f2442be9c">More...</a><br /></td></tr>
<tr class="separator:gae72fa0c94541c3e88a45d71f2442be9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parameterization of fire-related disturbance. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="adad01ea5332d847bada5b4ba62f0a563"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public disturbance_scheme::disturb </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>uwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>vwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>lightng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,iccp1)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>prbfrhuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd)&#160;</td>
          <td class="paramname"><em>rmatctem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>extnprob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>transientPOPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>grclarea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>popdin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>lucemcom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>dofire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>currlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>fsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>isand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates whether fire occurs, burned area, amount of C emitted and litter generated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transientpopd</td><td>if set true use population density data to calculate fire extinguishing probability and probability of fire due to human causes, or if false, read directly from .ctm file</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sort</td><td>index for correspondence between 9 pfts and size 12 of parameters vectors</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dofire</td><td>boolean, if true allow fire, if false no fire.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_448.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_448.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gleafmas</td><td>green leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_448.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">bleafmas</td><td>brown leaf mass</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thliq</td><td>liquid soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thlw</td><td>wilting point soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thfc</td><td>field capacity soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uwind</td><td>wind speed, <img class="formulaInl" alt="$m/s$" src="form_566.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vwind</td><td>wind speed, <img class="formulaInl" alt="$m/s$" src="form_566.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fcancmx</td><td>fractional coverages of ctem's 9 pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lightng</td><td>total <img class="formulaInl" alt="$lightning, flashes/(km^2 . year)$" src="form_567.png"/> it is assumed that cloud to ground lightning is some fixed fraction of total lightning.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">litrmass</td><td>litter mass for each of the 9 pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">prbfrhuc</td><td>probability of fire due to human causes</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">extnprob</td><td>fire extinguishing probability</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rmatctem</td><td>fraction of roots in each soil layer for each pft</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thice</td><td>frozen soil moisture content over canopy fraction</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">popdin</td><td>population density <img class="formulaInl" alt="$(people / km^2)$" src="form_555.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lucemcom</td><td>land use change (luc) related combustion emission losses, <img class="formulaInl" alt="$u-mol co2/m2.sec$" src="form_568.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fsnow</td><td>fraction of snow simulated by class</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">grclarea</td><td>gcm grid cell area, <img class="formulaInl" alt="$km^2$" src="form_447.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>initialize required arrays to zero, or assign value</p>
<p>if not simulating fire, leave the subroutine now.</p>
<p>initialization ends</p>
<p>Find pft areas before</p>
<p>area in <img class="formulaInl" alt="$km^2$" src="form_447.png"/></p>
<p>Find the probability of fire as a product of three functions with dependence on total biomass, soil moisture, and lightning</p>
<ol type="1">
<li>Dependence on total biomass</li>
</ol>
<p>don't allow it to bring in crops since they are not allowed to burn.</p>
<p>Root biomass is not used to initiate fire. For example if the last fire burned all grass leaves, and some of the roots were left, its unlikely these roots could catch fire.</p>
<p>Find average biomass over the vegetated fraction</p>
<p>Sum up the vegetated area</p>
<p>calculate bterm for individual PFTs as well</p>
<ol type="1">
<li>Dependence on soil moisture</li>
</ol>
<p>This is calculated in a way such that the more dry the root zone of a pft type is, and more fractional area is covered with that pft, the more likely it is that fire will get started. that is the dryness factor is weighted by fraction of roots in soil layers, as well as according to the fractional coverage of different pfts. the assumption here is that if there is less moisture in root zone, then it is more likely the vegetation will be dry and thus the likeliness of fire is more.</p>
<p>First find the dryness factor for each soil layer.</p>
<p>If there is snow on the ground, similarly if not soil, do not allow fire so set betadrgt to 0 for all soil layers otherwise calculate as per normal.</p>
<p>Now find weighted value of this dryness factor averaged over the rooting depth, for each pft</p>
<p>Next find this dryness factor averaged over the vegetated fraction <img class="formulaInl" alt="$avgdryns(i) = avgdryns(i) + drgtstrs(i,j)*fcancmx(i,j)$" src="form_569.png"/></p>
<p>The litter and brown leaves are not affected by the soil water potential therefore they will react only to the moisture conditions (our proxy here is the upper soil moisture). If it is dry they increase the probability of fire corresponding to the proportion of total C they contribute. Only allow if there is no snow.</p>
<p>Use average root zone vegetation dryness to find likelihood of fire due to moisture.</p>
<p>calculate mterm for each PFT</p>
<p>duff fraction for each PFT, Vivek</p>
<p><img class="formulaInl" alt="$drgtstrs(i,j)$" src="form_570.png"/> is <img class="formulaInl" alt="$\phi_{root}$" src="form_571.png"/> in Melton and Arora GMDD (2015) paper</p>
<p>no fire likelihood due to moisture if no vegetation</p>
<ol type="1">
<li>dependence on lightning</li>
</ol>
<p>Dependence on lightning is modelled in a simple way which implies that a large no. of lightning flashes are more likely to cause fire than few lightning flashes.</p>
<p>New approximation of Price and Rind equation. It was developed from a more complete dataset than Prentice and Mackerras. Lightning comes in in units of <img class="formulaInl" alt="$flashes/km^2/yr$" src="form_572.png"/> so divide by 12 to make per month.</p>
<p>Determine the probability of fire due to human causes this is based upon the population density from the .popd read-in file</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;\</p>
<p>This is not used in CTEM in general but we keep the code here for testing purposes</p>
<p>calculate natural and anthorpogenic ignitions/km2.day the constant 0.25 assumes not all c2g lightning hits causes ignitions, only 0.25 of them do the constant (1/30.4) converts c2g lightning from flashes/km2.month to flashes/km2.day MAKE SURE LIGHTNING IS IN UNITS OF FLASHES/KM2.MONTH</p>
<p>Eqs. (4) and (5) of Li et al. 2012 doi:10.5194/bg-9-2761-2012 + also see corrigendum</p>
<p>calculate fire suppression also as a function of population density. Li et al. (2012) formulation is quite similar to what we already use based on Kloster et al. (2010, I think) but we use Kloster's formulation together with our fire extingishing probability. Here, the fire suppression formulation is just by itself</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;//</p>
<p>calculate fire probability for each PFT. Recall that lightning term is still grid averaged</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;\</p>
<p>This is not used in CTEM in general but we keep the code here for testing purposes</p>
<p>calculate total number of ignitions based natural and anthorpogenic ignitions for the whole grid cell</p>
<p>finally calculate number of fire, noting that not all ignitions turn into fire because moisture and biomass may now allow that to happen, and some of those will be suppressed due to fire fighting efforts</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;//</p>
<p>Calculate area burned for each PFT, make sure it's not greater than the area available, then find area and fraction burned for the whole gridcell</p>
<p>soil moisture dependence on fire spread rate</p>
<p>wind speed, which is gridcell specific</p>
<p>Length to breadth ratio from Li et al. (2012)</p>
<p>head to back ratio from Li et al. (2012).</p>
<p>dependence of spread rate on wind</p>
<p>fire spread rate per PFT</p>
<p>area burned in 1 day for that PFT</p>
<p>fire extinguishing probability as a function of grid-cell averaged population density</p>
<p>account for low suppression in Savanna regions, see above for increase in ignition due to cultural practices</p>
<p>area multipler to calculate area burned over the duration of the fire</p>
<p>per PFT area burned, <img class="formulaInl" alt="$km^2$" src="form_447.png"/></p>
<p>Calculate gridcell area burned and fraction</p>
<p>Finally estimate amount of litter generated from each pft, and each vegetation component (leaves, stem, and root) based on their resistance to combustion. Update the veg pools due to combustion.</p>
<p>Set aside these pre-disturbance stem and root masses for use in burntobare subroutine.</p>
<p>Update the pools:</p>
<p>Output the burned area per PFT (the units here are burned fraction of each PFTs area. So if a PFT has 50% gridcell cover and 50% of that burns it will have a burnvegf of 0.5 (which then translates into a gridcell fraction of 0.25). This units is for consistency outside of this subroutine.</p>
<p>If .not. dofire then we enter here and perform the calculations for the emissions since we might have some from luc.</p>
<p>We also estimate <img class="formulaInl" alt="$CO_2$" src="form_559.png"/> emissions from each of these components. Note that the litter which is generated due to disturbance is uniformly distributed over the entire area of a given pft, and this essentially thins the vegetation biomass. If PFTCompetition is not on, this does not change the vegetation fractions, if competition is on a fraction will become bare. That is handled in burntobare subroutine called from competition subroutine.</p>
<p>Calculate the emissions of trace gases and aerosols based upon how much plant matter was burnt</p>
<p>Sum all pools that will be converted to emissions/aerosols <img class="formulaInl" alt="$(g c/m^2)$" src="form_573.png"/></p>
<p>Add in the emissions due to luc fires (deforestation) the luc emissions are converted from <img class="formulaInl" alt="$umol co_2 m-2 s-1 to g c m-2$" src="form_574.png"/> (day-1) before adding to tot_emit</p>
<p>Convert burnt plant matter from carbon to dry organic matter using a conversion factor, assume all parts of the plant has the same ratio of carbon to dry organic matter. units: <img class="formulaInl" alt="$kg dom / m^2$" src="form_575.png"/></p>
<p>Convert the dom to emissions/aerosols using emissions factors units: <img class="formulaInl" alt="$g species / m^2$" src="form_576.png"/></p>
<p>FLAG for the optimization of popd effect on fire I am taking the lterm out as the 'temp' var. So I have made tmp be dimension ilg and I overwrite the lterm (which is written to an output file) here in its place. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedisturbance__scheme.html">disturbance_scheme</a></li>
    <li class="footer">Generated on Tue Oct 24 2017 15:13:15 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
