<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: disturbance_scheme Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacedisturbance__scheme.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">disturbance_scheme Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates disturbance as both natural and human-influenced fires.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:adad01ea5332d847bada5b4ba62f0a563"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedisturbance__scheme.html#adad01ea5332d847bada5b4ba62f0a563">disturb</a> (stemmass, rootmass, gleafmas, bleafmas,thliq,THLW,THFC,uwind,vwind,lightng,fcancmx, litrmass,prbfrhuc, rmatctem, extnprob, transientPOPD,il1,il2,sort, nol2pfts,grclarea,thice,popdin, lucemcom,dofire,currlat,iday,fsnow,isand,</td></tr>
<tr class="memdesc:adad01ea5332d847bada5b4ba62f0a563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates whether fire occurs, burned area, amount of C emitted and litter generated.  <a href="#adad01ea5332d847bada5b4ba62f0a563">More...</a><br /></td></tr>
<tr class="separator:adad01ea5332d847bada5b4ba62f0a563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ae72fa0c94541c3e88a45d71f2442be9c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacedisturbance__scheme.html#ae72fa0c94541c3e88a45d71f2442be9c">burntobare</a> (il1, il2, nilg, sort, pvgbioms, pgavltms, pgavscms, fcancmx, burnvegf, stemmass, rootmass, gleafmas, bleafmas, litrmass, soilcmas, pstemmass, pgleafmass, nppveg)</td></tr>
<tr class="memdesc:ae72fa0c94541c3e88a45d71f2442be9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update fractional coverages of pfts to take into account the area burnt by fire. Adjust all pools with new densities in their new areas and increase bare fraction. And while we are doing this also run a small check to make sure grid averaged quantities do not get messed up.  <a href="#ae72fa0c94541c3e88a45d71f2442be9c">More...</a><br /></td></tr>
<tr class="separator:ae72fa0c94541c3e88a45d71f2442be9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates disturbance as both natural and human-influenced fires. </p>
<p>CTEM v. 2.0 represents disturbance as both natural and human-influenced fires. The original fire parametrization corresponding to CTEM v. 1.0 is described in <a class="el" href="citelist.html#CITEREF_Arora20052ac">[5]</a>. The parametrization has since been adapted and used in several other DGVMs <a class="el" href="citelist.html#CITEREF_Kloster2010-633">[47]</a> <a class="el" href="citelist.html#CITEREF_Kloster2012-c79">[48]</a> <a class="el" href="citelist.html#CITEREF_Migliavacca2013-eh">[61]</a> <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>. CTEM v. 2.0 incorporates changes suggested in these studies as well as several new improvements.</p>
<p>Fire in CTEM is simulated using a process-based scheme of intermediate complexity that accounts for all elements of the fire triangle: fuel load, combustibility of fuel, and an ignition source. CTEM represents the probability of a fire occurrence ( <img class="formulaInl" alt="$P_\mathrm{f}$" src="form_564.png"/>), for a representative area of <img class="formulaInl" alt="$500\,km^2$" src="form_565.png"/> ( <img class="formulaInl" alt="$a_{rep}$" src="form_566.png"/>), as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{fieya} P_\mathrm{f} = P_\mathrm{b}P_\mathrm{i}P_\mathrm{m},\]" src="form_567.png"/>
</p>
<p> where the right hand side terms represent the fire probabilities that are conditioned on (i) the availability of biomass as a fuel source ( <img class="formulaInl" alt="$P_\mathrm{b}$" src="form_568.png"/>), (ii) the combustibility of the fuel based on its moisture content ( <img class="formulaInl" alt="$P_\mathrm{m}$" src="form_569.png"/>), and (iii) the presence of an ignition source ( <img class="formulaInl" alt="$P_\mathrm{i}$" src="form_570.png"/>). The probability of fire and the subsequent calculations are performed for each PFT present in a grid cell (but the PFT index <img class="formulaInl" alt="$\alpha$" src="form_428.png"/> is omitted for clarity in Eq. fieya}). Since the CTEM parametrization is based on one fire per day per representative area, the representative area has to be sufficiently small that the requirement of only one fire per day is reasonable, yet sufficiently large such that it is not possible to burn the entire representative area in 1 day. Based on MODIS observed fire counts in Fig. 1 of <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>, <img class="formulaInl" alt="$500\,km^2$" src="form_565.png"/> is an appropriate size to not have more than one fire per day and still be a large enough area to be assumed representative of the grid cell as a whole.</p>
<p>The <img class="formulaInl" alt="$P_\mathrm{b}$" src="form_568.png"/> term depends on the aboveground biomass ( <img class="formulaInl" alt="$B_{ag}$" src="form_571.png"/>) available for sustaining a fire (which includes the green and brown leaf mass, stem mass and litter mass, <img class="formulaInl" alt="$B_{ag} = C_\mathrm{L} + C_\mathrm{S} + C_\mathrm{D}$" src="form_572.png"/>). Below a lower threshold of aboveground biomass ( <img class="formulaInl" alt="$B_{low}$" src="form_573.png"/>; <img class="formulaInl" alt="$0.2\, kg\,C\,m^{-2}$" src="form_574.png"/>; similar to <a class="el" href="citelist.html#CITEREF_Moorcroft2001-co">[63]</a>, and <a class="el" href="citelist.html#CITEREF_Kucharik2000-xk">[49]</a>), fire is not sustained and thus has a probability of 0. Above a biomass of <img class="formulaInl" alt="$1.0\, kg\,C\,m^{-2}$" src="form_575.png"/> ( <img class="formulaInl" alt="$B_{high}$" src="form_576.png"/>), <img class="formulaInl" alt="$P_\mathrm{b}$" src="form_568.png"/> is set to 1 as the amount of fuel available is assumed sufficient for fire. <img class="formulaInl" alt="$P_\mathrm{b}$" src="form_568.png"/> is then calculated using the aboveground biomass, <img class="formulaInl" alt="$B_{ag}$" src="form_571.png"/> ( <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_491.png"/>) with a linear variation between the upper and lower thresholds as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn:Pb} P_\mathrm{b}=\max\left[0, \min\left(1,\frac{B_{ag}-B_{low}} {B_{high} - B_{low}}\right)\right]. \]" src="form_577.png"/>
</p>
<p>The linear decrease of <img class="formulaInl" alt="$P_\mathrm{b}$" src="form_568.png"/> from <img class="formulaInl" alt="$B_{high}$" src="form_576.png"/> to <img class="formulaInl" alt="$B_{low}$" src="form_573.png"/> reflects the fragmentation of fuel that occurs as biomass decreases. Fuel fragmentation impacts upon area burned as it impedes the fire spread rate <a class="el" href="citelist.html#CITEREF_Guyette2002-rc">[40]</a>.</p>
<p>The probability of fire based on the presence of ignition sources ( <img class="formulaInl" alt="$P_\mathrm{i}$" src="form_570.png"/>) is influenced by both natural (lightning) and anthropogenic agents (either intentional or accidental). An initial lightning scalar, <img class="formulaInl" alt="$\vartheta_F$" src="form_578.png"/>, that varies between 0 and 1 is found as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \vartheta_F = \max\left[0, \min \left(1,\frac{F_c2g - F_{low}}{F_{high} - F_{low}} \right)\right],\]" src="form_579.png"/>
</p>
<p> where <img class="formulaInl" alt="$F_{low}$" src="form_580.png"/> and <img class="formulaInl" alt="$F_{high}$" src="form_581.png"/> represent lower and upper thresholds of cloud-to-ground lightning strikes ( <img class="formulaInl" alt="$F_c2g$" src="form_582.png"/>, <img class="formulaInl" alt="$flashes\,km^{-2}\,month^{-1}$" src="form_583.png"/>) , respectively. Similar to Eq. (eqn:Pb}), below the lower threshold ( <img class="formulaInl" alt="$F_{low}$" src="form_580.png"/>; <img class="formulaInl" alt="$0.25\,flashes\,km^{-2}\,month^{-1}$" src="form_584.png"/>), <img class="formulaInl" alt="$\vartheta_F$" src="form_578.png"/> is 0 implying lightning strikes are not sufficient to cause fire ignition, above the upper threshold ( <img class="formulaInl" alt="$F_{high}$" src="form_581.png"/>; <img class="formulaInl" alt="$10.0\,flashes\,km^{-2}\,month^{-1}$" src="form_585.png"/>) <img class="formulaInl" alt="$\vartheta_F$" src="form_578.png"/> is 1, as ignition sources now do not pose a constraint on fire. The amount of cloud-to-ground lightning, <img class="formulaInl" alt="$F_c2g$" src="form_582.png"/>, is a fraction of the total lightning based on the relationship derived by <a class="el" href="citelist.html#CITEREF_Price1993-fm">[68]</a> (approximation of their Eqs. 1 and 2) as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ F_c2g = 0.22 \exp (0.0059 \times \vert {\Phi}\vert) F_{tot},\]" src="form_586.png"/>
</p>
<p>where <img class="formulaInl" alt="$\Phi$" src="form_587.png"/> is the grid cell latitude in degrees and <img class="formulaInl" alt="$F_{tot}$" src="form_588.png"/> is the total number of lightning <img class="formulaInl" alt="$flashes\,km^{-2}\,month^{-1}$" src="form_583.png"/> (both cloud-to-cloud and cloud-to-ground). The probability of fire due to natural ignition, <img class="formulaInl" alt="$P_i,n$" src="form_589.png"/>, depends on the lightning scalar, <img class="formulaInl" alt="$\vartheta_F$" src="form_578.png"/>, as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ P_i,n = y(\vartheta_F) - y(0)(1 - \vartheta_F) + \vartheta_F[1-y(1)] \nonumber\\ y(\vartheta_F) = \frac{1}{1 + \exp\left(\frac{0.8 - \vartheta_F}{0.1}\right)}. \]" src="form_590.png"/>
</p>
<p>Fire probability due to ignition caused by humans, <img class="formulaInl" alt="$P_i,h$" src="form_591.png"/>, is parametrized following <a class="el" href="citelist.html#CITEREF_Kloster2010-633">[47]</a> with a dependence on population density, <img class="formulaInl" alt="$p_\mathrm{d}$" src="form_592.png"/> ( <img class="formulaInl" alt="$number of people\,km^{-2}$" src="form_593.png"/>) </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn:Ph} P_i,h = \min\left[1,\left(\frac{p_\mathrm{d}}{p_{thres}}\right)^{0.43}\right], \]" src="form_594.png"/>
</p>
<p> where <img class="formulaInl" alt="$p_{thres}$" src="form_595.png"/> is a population threshold ( <img class="formulaInl" alt="$300\,people\,km^{-2}$" src="form_596.png"/>) above which <img class="formulaInl" alt="$P_{i,h}$" src="form_597.png"/> is 1. The probability of fire conditioned on ignition, <img class="formulaInl" alt="$P_\mathrm{i}$" src="form_570.png"/>, is then the total contribution from both natural and human ignition sources </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn:Pi} P_\mathrm{i} = \max[0, \min\{1, P_{i,n} + (1 - P_{i,n})P_{i,h}\}]. \]" src="form_598.png"/>
</p>
<p>The population data used to calculate probability of fire ignition caused by humans and anthropogenic fire suppression (discussed further down in this section) is based on the HYDE 3.1 data set <a class="el" href="citelist.html#CITEREF_Klein_Goldewijk2010-lh">[46]</a></p>
<p>The probability of fire due to the combustibility of the fuel, <img class="formulaInl" alt="$P_\mathrm{m}$" src="form_569.png"/>, is dependent on the soil moisture in vegetation's root zone and in the litter layer. The root-zone soil wetness ( <img class="formulaInl" alt="$\phi_{root}$" src="form_557.png"/>, Eq. degsoilsat}) is used as a surrogate for the vegetation moisture content and the soil wetness of the top soil layer as a surrogate for the litter moisture content. If a grid cell is covered by snow, <img class="formulaInl" alt="$P_\mathrm{m}$" src="form_569.png"/> is set to zero. The probability of fire conditioned on soil wetness in vegetation's rooting zone, <img class="formulaInl" alt="$P_{m,V}$" src="form_599.png"/>, is then </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ P_{m,V} = 1-\tanh \left[\left( \frac{1.75\ \phi_{root}} {E_\mathrm{V}}\right )^2\right],\]" src="form_600.png"/>
</p>
<p> where <img class="formulaInl" alt="$E_\mathrm{V}$" src="form_601.png"/> is the extinction soil wetness above which <img class="formulaInl" alt="$P_{f,V}$" src="form_602.png"/> is reduced to near zero and is set to 0.30.</p>
<p>The probability of fire based on the moisture content in the <img class="formulaInl" alt="$\textit{duff}$" src="form_603.png"/> layer, <img class="formulaInl" alt="$P_{m,D}$" src="form_604.png"/>, which includes the brown leaf mass (grasses only) and litter mass ( <img class="formulaInl" alt="$B_{duff} = C_{L,b} + C_\mathrm{D}$" src="form_605.png"/>; <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_491.png"/>), is calculated in a similar way but uses the soil wetness of the first soil layer, ( <img class="formulaInl" alt="$\phi_1$" src="form_606.png"/>, Eq. phitheta}), as a surrogate for the moisture in the duff layer itself as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ P_{m,D} = 1 -\tanh\left[\left(\frac{1.75 \phi_1}{E_{\mathrm{D}}}\right)^2\right], \]" src="form_607.png"/>
</p>
<p> where the extinction soil wetness for the litter layer, <img class="formulaInl" alt="$E_{\mathrm{D}}$" src="form_608.png"/>, is set to 0.50, which yields a higher probability of fire for the litter layer than for the vegetation for the same soil wetness. <img class="formulaInl" alt="$P_\mathrm{m}$" src="form_569.png"/> is then the weighted average of <img class="formulaInl" alt="$P_{m,V}$" src="form_599.png"/> and <img class="formulaInl" alt="$P_{m,D}$" src="form_604.png"/> given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn:Pf} P_\mathrm{m} = P_{m,V} (1-f_{duff}) + P_{m,D} f_{duff} \nonumber \\ f_{duff}=\frac{B_{duff}}{B_{ag}}\]" src="form_609.png"/>
</p>
<p> where <img class="formulaInl" alt="$f_{duff}$" src="form_610.png"/> is the duff fraction of aboveground combustible biomass.</p>
<p>The area burned ( <img class="formulaInl" alt="$a$" src="form_611.png"/>) is assumed to be elliptical in shape for fires based upon the wind speed and properties of an ellipse </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a(t)=\pi \frac{l}{2}\frac{w}{2}= \frac{\pi}{2} (v_\mathrm{d}+v_\mathrm{u})v_\mathrm{p}t^2,\]" src="form_612.png"/>
</p>
<p>where <img class="formulaInl" alt="$l$" src="form_613.png"/> ( <img class="formulaInl" alt="$m$" src="form_101.png"/>) and <img class="formulaInl" alt="$w$" src="form_614.png"/> ( <img class="formulaInl" alt="$m$" src="form_101.png"/>) are the lengths of major and minor axes of the elliptical area burnt; <img class="formulaInl" alt="$v_\mathrm{d}$" src="form_615.png"/> ( <img class="formulaInl" alt="$km\,h^{-1}$" src="form_616.png"/>) and <img class="formulaInl" alt="$v_\mathrm{u}$" src="form_617.png"/> ( <img class="formulaInl" alt="$km\,h^{-1}$" src="form_616.png"/>) are the fire spread rates in the downwind and upwind directions, respectively; <img class="formulaInl" alt="$v_\mathrm{p}$" src="form_618.png"/> ( <img class="formulaInl" alt="$km\,h^{-1}$" src="form_616.png"/>) is the fire spread rate perpendicular to the wind direction and <img class="formulaInl" alt="$t$" src="form_619.png"/> is the time ( <img class="formulaInl" alt="$h$" src="form_620.png"/>).</p>
<p>The fire spread rate in the downwind direction ( <img class="formulaInl" alt="$v_\mathrm{d}$" src="form_615.png"/>) is represented as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{firespreadrate} v_\mathrm{d} = v_{d,max}\,g(u)\,h(\phi_{r, d})\]" src="form_621.png"/>
</p>
<p>where <img class="formulaInl" alt="$v_{d,max}$" src="form_622.png"/> ( <img class="formulaInl" alt="$km\,h^{-1}$" src="form_616.png"/>) is the PFT-specific maximum fire spread rate from <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>, which is set to zero for crop PFTs (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>). The functions <img class="formulaInl" alt="$g(u)$" src="form_623.png"/> accounts for the effect of wind speed and <img class="formulaInl" alt="$ h(\phi_{r, d})$" src="form_624.png"/> accounts for the effect of rooting zone and duff soil wetness on the fire spread rate, as discussed below.</p>
<p>The wind speed ( <img class="formulaInl" alt="$u$" src="form_625.png"/>; <img class="formulaInl" alt="$km\,h^{-1}$" src="form_616.png"/>) is used to determine the length ( <img class="formulaInl" alt="$l$" src="form_613.png"/>) to breadth ( <img class="formulaInl" alt="$w$" src="form_614.png"/>) ratio, <img class="formulaInl" alt="$L_\mathrm{b}$" src="form_626.png"/>, of the elliptical area burned by fire </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{lb} L_\mathrm{b}= \frac{l}{w} = \frac{v_\mathrm{d} + v_\mathrm{u}}{2v_\mathrm{p}} = 1 + 10 [1 -\exp(-0.06 u)] \]" src="form_627.png"/>
</p>
<p> and its head to back ratio, <img class="formulaInl" alt="$H_\mathrm{b}$" src="form_628.png"/>, following <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>, as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{hb} H_\mathrm{b} = \frac{v_\mathrm{d}}{v_\mathrm{u}} = \frac{L_\mathrm{b} + (L_\mathrm{b}^2 - 1)^{0.5}}{L_\mathrm{b} - (L_\mathrm{b}^2 - 1)^{0.5}}, \]" src="form_629.png"/>
</p>
<p> which help determine the fire spread rate in the direction perpendicular to the wind speed and in the downward direction. Equations (lb}) and (hb}) are combined to estimate the wind scalar <img class="formulaInl" alt="$g(u)$" src="form_623.png"/> as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g(u)= g(0) \frac{2.0 L_\mathrm{b}}{(1 + 1/H_\mathrm{b})} \nonumber\\ \frac{g(u)}{g(0)}=\frac{v_\mathrm{d}}{v_\mathrm{p}} = \frac{2.0 L_\mathrm{b}} {(1 + 1/H_\mathrm{b})}, \]" src="form_630.png"/>
</p>
<p>which varies between 0.05 and 1. The lower limit is imposed by the <img class="formulaInl" alt="$g(0)$" src="form_631.png"/> term, which has a value of 0.05 and represents the fire spread rate in the absence of wind ( <img class="formulaInl" alt="$u = 0$" src="form_632.png"/>); the upper limit is assigned a maximum value of 1. The fire spread rate in the absence of wind is essentially the spread rate in the direction perpendicular to the wind speed ( <img class="formulaInl" alt="$v_\mathrm{p}$" src="form_618.png"/>). The value of the <img class="formulaInl" alt="$g(0)$" src="form_631.png"/> term is derived by considering the case where the wind speed becomes very large. As <img class="formulaInl" alt="$u$" src="form_625.png"/> <img class="formulaInl" alt="$\rightarrow \infty$" src="form_633.png"/> then <img class="formulaInl" alt="$L_\mathrm{b} \rightarrow 11$" src="form_634.png"/> and <img class="formulaInl" alt="$H_\mathrm{b} \rightarrow 482$" src="form_635.png"/>, while <img class="formulaInl" alt="$g(\infty)=1$" src="form_636.png"/> due to its definition, which yields <img class="formulaInl" alt="$g(0) = 0.0455 \approx 0.05$" src="form_637.png"/>.</p>
<p>The dependence of fire spread rate on the rooting zone and duff soil wetness, <img class="formulaInl" alt="$h(\phi_{r, d})$" src="form_638.png"/> is represented as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ h(\phi_{r, d})= h(\phi_{root})(1-f_{duff}) + h(\phi_{1})f_{duff}\nonumber \\ h(\phi_{root})= \left(1-min \left(1,\frac{\phi_{root}}{E_\mathrm{V}} \right) \right)^2\nonumber \\ h(\phi_{1})= \left(1-min \left(1,\frac{\phi_{1}}{E_\mathrm{D}} \right) \right)^2. \]" src="form_639.png"/>
</p>
<p>Both <img class="formulaInl" alt="$h(\phi_{root})$" src="form_640.png"/> and <img class="formulaInl" alt="$h(\phi_{1})$" src="form_641.png"/> gradually decrease from 1 (when soil wetness is 0 and soil moisture does not constrain fire spread rate) to 0 when soil wetness exceeds the respective extinction wetness thresholds, <img class="formulaInl" alt="$E_\mathrm{V}$" src="form_601.png"/> and <img class="formulaInl" alt="$E_\mathrm{D}$" src="form_642.png"/>.</p>
<p>With fire spread rate determined, and the geometry of the burned area defined, the area burned in 1 day, <img class="formulaInl" alt="$a_{1{\mathrm{d}}}$" src="form_643.png"/> ( <img class="formulaInl" alt="$km^2\,day^{-1}$" src="form_644.png"/>), following <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>, is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a_{1{\mathrm{d}}} = \frac{\pi v_\mathrm{d}^2 t^2}{4L_\mathrm{b}}\left(1 + \frac{1}{H_\mathrm{b}}\right)^2 \nonumber\\ = \frac{\pi v_\mathrm{d}^2 (24^2)} {4L_\mathrm{b}}\left(1 + \frac{1}{H_\mathrm{b}}\right)^2\label{aburned} \]" src="form_645.png"/>
</p>
<p> by setting <img class="formulaInl" alt="$t$" src="form_619.png"/> equal to <img class="formulaInl" alt="$24\,h$" src="form_646.png"/>.</p>
<p>The fire extinguishing probability, <img class="formulaInl" alt="$q$" src="form_647.png"/>, is used to calculate the duration ( <img class="formulaInl" alt="$\tau$" src="form_648.png"/>, <img class="formulaInl" alt="$days$" src="form_649.png"/>) of the fire, which in turn is used to calculated the area burned over the duration of the fire, <img class="formulaInl" alt="${a_{\tau d}}$" src="form_650.png"/>. <img class="formulaInl" alt="$q$" src="form_647.png"/> is represented following <a class="el" href="citelist.html#CITEREF_Kloster2010-633">[47]</a> as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ q = 0.5 + \frac{\max\left[0,0.9 - \exp(-0.025\,p_\mathrm{d})\right]}{2}, \]" src="form_651.png"/>
</p>
<p> which yields a value of <img class="formulaInl" alt="$q$" src="form_647.png"/> that varies from 0.5 to 0.95 as population density, <img class="formulaInl" alt="$p_\mathrm{d}$" src="form_592.png"/> ( <img class="formulaInl" alt="$number of people\,km^{-2}$" src="form_593.png"/>), increases from zero to infinity. Higher population density thus implies a higher probability of fire being extinguished. <img class="formulaInl" alt="$q$" src="form_647.png"/> represents the probability that a fire will be extinguished on the same day it initiated and the probability that it will continue to the next day is ( <img class="formulaInl" alt="$1-q$" src="form_652.png"/>). Assuming individual days are independent, the probability that the fire will still be burning on day <img class="formulaInl" alt="$\tau$" src="form_648.png"/> is <img class="formulaInl" alt="$(1-q)^\tau$" src="form_653.png"/>. The probability that a fire will last exactly $$ days, $P()$, is the product of the probability that the fire still exists at day <img class="formulaInl" alt="$\tau$" src="form_648.png"/> and the probability it will be extinguished on that day hence <img class="formulaInl" alt="$P(\tau) = q(1-q)^\tau$" src="form_654.png"/>. This yields an exponential distribution of fire duration whose expected value is</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{\tau} = E(\tau) = \sum_{\tau=0}^\infty\,\tau\,q(1-q)^{\tau} = \frac{1-q}{q}. \]" src="form_655.png"/>
</p>
<p> Based on this fire duration and the area burned in 1 day (Eq. aburned}), the area burned over the duration of the fire ( <img class="formulaInl" alt="$a_{\tau \mathrm{d}}$" src="form_656.png"/>) (but still implemented in 1 day since the model does not track individual fires over their duration, <img class="formulaInl" alt="$km^2\,day^{-1}$" src="form_644.png"/>) is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a_{\tau \mathrm{d}} =E(a_{1{\mathrm{d}}} \tau^2)=\sum_{\tau=0}^ \infty\,a_{1{\mathrm{d}}}\,\tau^2 q(1-q)^{\tau} \\ = a_{1{\mathrm{d}}}\, \frac{(1-q) (2-q)}{q^2}.\nonumber \]" src="form_657.png"/>
</p>
<p>Finally, and reintroducing the PFT index <img class="formulaInl" alt="$\alpha$" src="form_428.png"/>, the area burned is extrapolated for a PFT <img class="formulaInl" alt="$\alpha$" src="form_428.png"/> ( <img class="formulaInl" alt="$A_{\mathrm{b},\alpha}$" src="form_658.png"/>, <img class="formulaInl" alt="$km^2\, day^{-1}$" src="form_659.png"/>) to the whole grid cell as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[A_{\mathrm{b},\alpha}=P_{f,\alpha}\,a_{\tau \mathrm{d},\alpha} \frac{A_\mathrm{g}f_\alpha}{a_{rep}}, \]" src="form_660.png"/>
</p>
<p> where <img class="formulaInl" alt="$A_\mathrm{g}$" src="form_661.png"/> is area of a grid cell ( <img class="formulaInl" alt="$km^2$" src="form_531.png"/>), <img class="formulaInl" alt="$f_\alpha$" src="form_662.png"/> the fractional coverage of PFT <img class="formulaInl" alt="$\alpha$" src="form_428.png"/> and <img class="formulaInl" alt="$a_{rep}$" src="form_566.png"/> the representative area of <img class="formulaInl" alt="$500\,km^2$" src="form_565.png"/>, as mentioned earlier. Area burned over the whole grid cell ( <img class="formulaInl" alt="$A_\mathrm{b}$" src="form_663.png"/>, <img class="formulaInl" alt="$km^2\,day^{-1}$" src="form_644.png"/>) is then calculated as the sum of area burned for individual PFTs, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_\mathrm{b}=\sum_{\alpha=1}^{N}A_{\mathrm{b},\alpha}.\]" src="form_664.png"/>
</p>
<p>Fire emits <img class="formulaInl" alt="$CO_2$" src="form_544.png"/>, other trace gases, and aerosols as biomass is burned while plant mortality and damage due to fire contribute to the litter pool. The emissions of a trace gas/aerosol species <img class="formulaInl" alt="$j$" src="form_665.png"/> from PFT <img class="formulaInl" alt="$\alpha$" src="form_428.png"/>, <img class="formulaInl" alt="$E_{\alpha,j}$" src="form_666.png"/> ( <img class="formulaInl" alt="$g species (m^{-2} grid cell area) day^{-1}$" src="form_667.png"/>) are obtained from a vector of carbon densities <img class="formulaInl" alt="$\vec{C}_{\alpha} = (C_\mathrm{L}, C_\mathrm{S}, C_\mathrm{R}, C_\mathrm{D})_\alpha$" src="form_668.png"/> ( <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_491.png"/>) for its leaf, stem, root and litter components, multiplied by a vector of combustion factors <img class="formulaInl" alt="$mho_{\alpha} = (mho_\mathrm{L}, mho_\mathrm{S}, mho_\mathrm{R}, mho_\mathrm{D})_\alpha$" src="form_669.png"/>, which determines what fraction of leaf, stem, root and litter components gets burned, multiplied by a vector of emissions factors <img class="formulaInl" alt="$\Upsilon_{j} = (\Upsilon_\mathrm{L}, \Upsilon_\mathrm{S}, \Upsilon_\mathrm{R}, \Upsilon_\mathrm{D})_j$" src="form_670.png"/> ( <img class="formulaInl" alt="$g species (kg\,C\,dry organic matter)^{-1}$" src="form_671.png"/>), and by the area burned <img class="formulaInl" alt="$A_{\mathrm{b},\alpha}$" src="form_658.png"/> for that PFT.</p>
<p>The dot product of <img class="formulaInl" alt="$\vec{C}_{\alpha}$" src="form_672.png"/>, <img class="formulaInl" alt="$\Upsilon_{j}$" src="form_673.png"/> and <img class="formulaInl" alt="$mho_{\alpha} $" src="form_674.png"/> thus yields emissions per unit grid cell area of species <img class="formulaInl" alt="$j$" src="form_665.png"/> from PFT <img class="formulaInl" alt="$\alpha$" src="form_428.png"/>, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{emiss_combust_factor} {E_{\alpha,j}}= ((\vec{C}_\alpha\cdot mho_{\alpha} )\cdot \Upsilon_{j}) \frac{A_{\mathrm{b},\alpha}}{A_\mathrm{g}}\frac{1000}{450}, \]" src="form_675.png"/>
</p>
<p>where the constant 1000 converts <img class="formulaInl" alt="$\vec{C}_\alpha$" src="form_676.png"/> from <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_491.png"/> to <img class="formulaInl" alt="$g\,C\,m^{-2}$" src="form_677.png"/> and the constant 450 ( <img class="formulaInl" alt="$g\,C\,(kg dry organic matter)^{-1} $" src="form_678.png"/>) converts biomass from carbon units to dry organic matter <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>. The corresponding loss of carbon ( <img class="formulaInl" alt="$kg\,C\,m^{-2}\,day^{-1}$" src="form_486.png"/>) from the three live vegetation components (L, S, R) and the litter pool (D) of PFT <img class="formulaInl" alt="$\alpha$" src="form_428.png"/> is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{emiss_combust_loss} H_{\alpha, i}= C_{\alpha, i} mho_i\left(\frac{A_{\mathrm{b},\alpha}}{A_\mathrm{g}}\right)\quad i={L, S, R, D}. \]" src="form_679.png"/>
</p>
<p>The PFT-specific combustion factors for leaf ( <img class="formulaInl" alt="$mho_\mathrm{L}$" src="form_680.png"/>), stem ( <img class="formulaInl" alt="$mho_{\mathrm{S}}$" src="form_681.png"/>), root ( <img class="formulaInl" alt="$mho_{\mathrm{R}}$" src="form_682.png"/>) and litter ( <img class="formulaInl" alt="$mho_{\mathrm{D}}$" src="form_683.png"/>) components are summarized in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>. Emission factors for all species of trace gases and aerosols ( <img class="formulaInl" alt="$CO_2$" src="form_544.png"/>, <img class="formulaInl" alt="$CO$" src="form_684.png"/>, <img class="formulaInl" alt="$CH_4$" src="form_532.png"/>, <img class="formulaInl" alt="$H_2$" src="form_685.png"/>, <img class="formulaInl" alt="$NHMC$" src="form_686.png"/>, <img class="formulaInl" alt="$NO_x$" src="form_687.png"/>, <img class="formulaInl" alt="$N_2O$" src="form_688.png"/>, total particulate matter, particulate matter less than <img class="formulaInl" alt="$2.5\, \mu m$" src="form_689.png"/> in diameter, and black and organic carbon) are based on an updated set by <a class="el" href="citelist.html#CITEREF_Andreae2001-e04">[3]</a> listed in Tables 3 and 4 of <a class="el" href="citelist.html#CITEREF_Li20121c2">[55]</a>.</p>
<p>Litter generated by fire is based on similar mortality factors, which reflect a PFT's susceptibility to damage due to fire <img class="formulaInl" alt="$\vec{\Theta}_{\alpha} = (\Theta_\mathrm{L}, \Theta_\mathrm{S}, \Theta_\mathrm{R})_\alpha$" src="form_690.png"/> (fraction). The contribution to litter pool of each PFT due to plant mortality associated with fire ( <img class="formulaInl" alt="$kg\,C\,m^{-2}\,day^{-1}$" src="form_486.png"/>) is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn_using_mort_factors} {M_{\alpha}}= (\vec{C}_\alpha \cdot \Theta_{\alpha} ) \frac{A_{\mathrm{b},\alpha}}{A_\mathrm{g}}, \]" src="form_691.png"/>
</p>
<p> which is the sum of contribution from individual live vegetation pools </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eqn_using_mort_factors_individual} M_{\alpha, i}= C_{\alpha, i} \Theta_{\alpha, i} \left(\frac{A_{\mathrm{b},\alpha}}{A_\mathrm{g}} \right) \quad i={L, S, R}. \]" src="form_692.png"/>
</p>
<p>The carbon loss terms associated with combustion of vegetation components and litter ( <img class="formulaInl" alt="$H_{\alpha, i}, i={L, S, R, D}$" src="form_693.png"/>) and mortality of vegetation components ( <img class="formulaInl" alt="$M_{\alpha, i}, i={L, S, R}$" src="form_694.png"/>) due to fire are used in Eqs. ( rate_change_eqns_live_pools}) and (rate_change_eqns_dead_pools}), which describe the rate of change of carbon in model's five pools (however, listed there without the PFT subscript <img class="formulaInl" alt="$\alpha$" src="form_428.png"/>). The PFT-specific mortality factors for leaf ( <img class="formulaInl" alt="$\Theta_\mathrm{L}$" src="form_695.png"/>), stem ( <img class="formulaInl" alt="$\Theta_{\mathrm{S}}$" src="form_696.png"/>) and root ( <img class="formulaInl" alt="$\Theta_\mathrm{R}$" src="form_697.png"/>) components are listed in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>.</p>
<p>When CTEM is run with prescribed PFT fractional cover, the area of PFTs does not change and the fire-related emissions of <img class="formulaInl" alt="$CO_2$" src="form_544.png"/>, other trace gases and aerosols , and generation of litter act to thin the remaining biomass. When competition between PFTs for space is allowed, fire both thins the remaining biomass and through plant mortality creates bare ground, which is subsequently available for colonization. The creation of bare ground depends on the susceptibility of each PFT to stand replacing fire ( <img class="formulaInl" alt="$\zeta_\mathrm{r}$" src="form_698.png"/>, fraction) (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>) and the PFT area burned. The fire-related mortality rate, <img class="formulaInl" alt="$m_{dist}$" src="form_699.png"/> ( <img class="formulaInl" alt="$day^{-1}$" src="form_436.png"/>), used in Eq. (mortality}), is then </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{m_dist} m_{dist,\alpha} = \zeta_{\mathrm{r},\alpha} \frac{A_{\mathrm{b},\alpha}}{f_\alpha A_\mathrm{g}}. \]" src="form_700.png"/>
</p>
<p>After bare ground generation associated with fire, the thinned biomass is spread uniformly over the remaining fraction of a PFT. However, it is ensured that the carbon density of the remaining biomass does not increase to a value above what it was before the fire occurred. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ae72fa0c94541c3e88a45d71f2442be9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public disturbance_scheme::burntobare </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc), intent(in)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>pvgbioms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>pgavltms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>pgavscms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>burnvegf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,iccp1), intent(inout)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,iccp1), intent(inout)&#160;</td>
          <td class="paramname"><em>soilcmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>pstemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>pgleafmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>nppveg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update fractional coverages of pfts to take into account the area burnt by fire. Adjust all pools with new densities in their new areas and increase bare fraction. And while we are doing this also run a small check to make sure grid averaged quantities do not get messed up. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nilg</td><td>no. of grid cells in latitude circle (this is passed in as either ilg or nlat depending on mos/comp)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sort</td><td>index for correspondence between 9 ctem pfts and size 12 of parameter vectors</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvgbioms</td><td>initial veg biomass</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pgavltms</td><td>initial litter mass</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pgavscms</td><td>initial soil c mass</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fcancmx</td><td>initial fractions of the ctem pfts</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">burnvegf</td><td>per PFT fraction burned of that PFTs area</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gleafmas</td><td>green leaf carbon mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bleafmas</td><td>brown leaf carbon mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stemmass</td><td>stem carbon mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rootmass</td><td>roots carbon mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nppveg</td><td>npp for individual pfts, <img class="formulaInl" alt="$u-mol co_2/m^2.sec$" src="form_563.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">soilcmas</td><td>soil carbon mass for each of the 9 ctem pfts + bare, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">litrmass</td><td>litter carbon mass for each of the 9 ctem pfts + bare, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pstemmass</td><td>grid averaged stemmass prior to disturbance, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pgleafmass</td><td>grid averaged rootmass prior to disturbance, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>Do some initializations</p>
<p>Account for disturbance creation of bare ground. This occurs with relatively low frequency and is PFT dependent. We must adjust the amount of bare ground created to ensure that we do not increase the density of the remaining vegetation.</p>
<p>Test the pftfraca to ensure it does not cause densification of the exisiting biomass Trees compare the stemmass while grass compares the root mass.</p>
<p>the pstemmass is from before the fire occurred, i.e. no thinning!</p>
<p>adjust the bare frac to accomodate for the changes</p>
<p>the pgleafmass is from before the fire occurred, i.e. no thinning!</p>
<p>adjust the bare frac to accomodate for the changes</p>
<p>Soil and litter carbon are treated such that we actually transfer the carbon to the bare fraction since it would remain in place as a location was devegetated In doing so we do not adjust the litter or soilc density on the remaining vegetated fraction. But we do adjust it on the bare fraction to ensure our carbon balance works out.</p>
<p>only do checks if we actually shifted fractions here.</p>
<p>check if total grid average biomass density is same before and after adjusting fractions</p>
<p>only do checks if we actually shifted fractions here.</p>
<p>then add the bare ground in. </p>

</div>
</div>
<a class="anchor" id="adad01ea5332d847bada5b4ba62f0a563"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public disturbance_scheme::disturb </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>uwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>vwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>lightng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,iccp1)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>prbfrhuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd)&#160;</td>
          <td class="paramname"><em>rmatctem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>extnprob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>transientPOPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>grclarea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>popdin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>lucemcom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>dofire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>currlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>fsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>isand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates whether fire occurs, burned area, amount of C emitted and litter generated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transientpopd</td><td>if set true use population density data to calculate fire extinguishing probability and probability of fire due to human causes, or if false, read directly from .ctm file</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sort</td><td>index for correspondence between 9 pfts and size 12 of parameters vectors</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dofire</td><td>boolean, if true allow fire, if false no fire.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gleafmas</td><td>green leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_534.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">bleafmas</td><td>brown leaf mass</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thliq</td><td>liquid soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thlw</td><td>wilting point soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thfc</td><td>field capacity soil moisture content</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">uwind</td><td>wind speed, <img class="formulaInl" alt="$m/s$" src="form_552.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vwind</td><td>wind speed, <img class="formulaInl" alt="$m/s$" src="form_552.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fcancmx</td><td>fractional coverages of ctem's 9 pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lightng</td><td>total <img class="formulaInl" alt="$lightning, flashes/(km^2 . year)$" src="form_553.png"/> it is assumed that cloud to ground lightning is some fixed fraction of total lightning.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">litrmass</td><td>litter mass for each of the 9 pfts</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">prbfrhuc</td><td>probability of fire due to human causes</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">extnprob</td><td>fire extinguishing probability</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rmatctem</td><td>fraction of roots in each soil layer for each pft</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">thice</td><td>frozen soil moisture content over canopy fraction</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">popdin</td><td>population density <img class="formulaInl" alt="$(people / km^2)$" src="form_533.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lucemcom</td><td>land use change (luc) related combustion emission losses, <img class="formulaInl" alt="$u-mol co2/m2.sec$" src="form_554.png"/></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fsnow</td><td>fraction of snow simulated by class</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">grclarea</td><td>gcm grid cell area, <img class="formulaInl" alt="$km^2$" src="form_531.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>initialize required arrays to zero, or assign value</p>
<p>if not simulating fire, leave the subroutine now.</p>
<p>initialization ends</p>
<p>Find pft areas before</p>
<p>area in <img class="formulaInl" alt="$km^2$" src="form_531.png"/></p>
<p>Find the probability of fire as a product of three functions with dependence on total biomass, soil moisture, and lightning</p>
<ol type="1">
<li>Dependence on total biomass</li>
</ol>
<p>don't allow it to bring in crops since they are not allowed to burn.</p>
<p>Root biomass is not used to initiate fire. For example if the last fire burned all grass leaves, and some of the roots were left, its unlikely these roots could catch fire.</p>
<p>Find average biomass over the vegetated fraction</p>
<p>Sum up the vegetated area</p>
<p>calculate bterm for individual PFTs as well</p>
<ol type="1">
<li>Dependence on soil moisture</li>
</ol>
<p>This is calculated in a way such that the more dry the root zone of a pft type is, and more fractional area is covered with that pft, the more likely it is that fire will get started. that is the dryness factor is weighted by fraction of roots in soil layers, as well as according to the fractional coverage of different pfts. the assumption here is that if there is less moisture in root zone, then it is more likely the vegetation will be dry and thus the likeliness of fire is more.</p>
<p>First find the dryness factor for each soil layer.</p>
<p>If there is snow on the ground, similarly if not soil, do not allow fire so set betadrgt to 0 for all soil layers otherwise calculate as per normal.</p>
<p>Now find weighted value of this dryness factor averaged over the rooting depth, for each pft</p>
<p>Next find this dryness factor averaged over the vegetated fraction <img class="formulaInl" alt="$avgdryns(i) = avgdryns(i) + drgtstrs(i,j)*fcancmx(i,j)$" src="form_555.png"/></p>
<p>The litter and brown leaves are not affected by the soil water potential therefore they will react only to the moisture conditions (our proxy here is the upper soil moisture). If it is dry they increase the probability of fire corresponding to the proportion of total C they contribute. Only allow if there is no snow.</p>
<p>Use average root zone vegetation dryness to find likelihood of fire due to moisture.</p>
<p>calculate mterm for each PFT</p>
<p>duff fraction for each PFT, Vivek</p>
<p><img class="formulaInl" alt="$drgtstrs(i,j)$" src="form_556.png"/> is <img class="formulaInl" alt="$\phi_{root}$" src="form_557.png"/> in Melton and Arora GMDD (2015) paper</p>
<p>no fire likelihood due to moisture if no vegetation</p>
<ol type="1">
<li>dependence on lightning</li>
</ol>
<p>Dependence on lightning is modelled in a simple way which implies that a large no. of lightning flashes are more likely to cause fire than few lightning flashes.</p>
<p>New approximation of Price and Rind equation. It was developed from a more complete dataset than Prentice and Mackerras. Lightning comes in in units of <img class="formulaInl" alt="$flashes/km^2/yr$" src="form_558.png"/> so divide by 12 to make per month.</p>
<p>Determine the probability of fire due to human causes this is based upon the population density from the .popd read-in file</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;\</p>
<p>This is not used in CTEM in general but we keep the code here for testing purposes</p>
<p>calculate natural and anthorpogenic ignitions/km2.day the constant 0.25 assumes not all c2g lightning hits causes ignitions, only 0.25 of them do the constant (1/30.4) converts c2g lightning from flashes/km2.month to flashes/km2.day MAKE SURE LIGHTNING IS IN UNITS OF FLASHES/KM2.MONTH</p>
<p>Eqs. (4) and (5) of Li et al. 2012 doi:10.5194/bg-9-2761-2012 + also see corrigendum</p>
<p>calculate fire suppression also as a function of population density. Li et al. (2012) formulation is quite similar to what we already use based on Kloster et al. (2010, I think) but we use Kloster's formulation together with our fire extingishing probability. Here, the fire suppression formulation is just by itself</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;//</p>
<p>calculate fire probability for each PFT. Recall that lightning term is still grid averaged</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;\</p>
<p>This is not used in CTEM in general but we keep the code here for testing purposes</p>
<p>calculate total number of ignitions based natural and anthorpogenic ignitions for the whole grid cell</p>
<p>finally calculate number of fire, noting that not all ignitions turn into fire because moisture and biomass may now allow that to happen, and some of those will be suppressed due to fire fighting efforts</p>
<p>&ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; Number of fire calculations -&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;//</p>
<p>Calculate area burned for each PFT, make sure it's not greater than the area available, then find area and fraction burned for the whole gridcell</p>
<p>soil moisture dependence on fire spread rate</p>
<p>wind speed, which is gridcell specific</p>
<p>Length to breadth ratio from Li et al. (2012)</p>
<p>head to back ratio from Li et al. (2012).</p>
<p>dependence of spread rate on wind</p>
<p>fire spread rate per PFT</p>
<p>area burned in 1 day for that PFT</p>
<p>fire extinguishing probability as a function of grid-cell averaged population density</p>
<p>account for low suppression in Savanna regions, see above for increase in ignition due to cultural practices</p>
<p>area multipler to calculate area burned over the duration of the fire</p>
<p>per PFT area burned, <img class="formulaInl" alt="$km^2$" src="form_531.png"/></p>
<p>Calculate gridcell area burned and fraction</p>
<p>Finally estimate amount of litter generated from each pft, and each vegetation component (leaves, stem, and root) based on their resistance to combustion. Update the veg pools due to combustion.</p>
<p>Set aside these pre-disturbance stem and root masses for use in burntobare subroutine.</p>
<p>Update the pools:</p>
<p>Output the burned area per PFT (the units here are burned fraction of each PFTs area. So if a PFT has 50% gridcell cover and 50% of that burns it will have a burnvegf of 0.5 (which then translates into a gridcell fraction of 0.25). This units is for consistency outside of this subroutine.</p>
<p>If .not. dofire then we enter here and perform the calculations for the emissions since we might have some from luc.</p>
<p>We also estimate <img class="formulaInl" alt="$CO_2$" src="form_544.png"/> emissions from each of these components. Note that the litter which is generated due to disturbance is uniformly distributed over the entire area of a given pft, and this essentially thins the vegetation biomass. If PFTCompetition is not on, this does not change the vegetation fractions, if competition is on a fraction will become bare. That is handled in burntobare subroutine called from competition subroutine.</p>
<p>Calculate the emissions of trace gases and aerosols based upon how much plant matter was burnt</p>
<p>Sum all pools that will be converted to emissions/aerosols <img class="formulaInl" alt="$(g c/m^2)$" src="form_559.png"/></p>
<p>Add in the emissions due to luc fires (deforestation) the luc emissions are converted from <img class="formulaInl" alt="$umol co_2 m-2 s-1 to g c m-2$" src="form_560.png"/> (day-1) before adding to tot_emit</p>
<p>Convert burnt plant matter from carbon to dry organic matter using a conversion factor, assume all parts of the plant has the same ratio of carbon to dry organic matter. units: <img class="formulaInl" alt="$kg dom / m^2$" src="form_561.png"/></p>
<p>Convert the dom to emissions/aerosols using emissions factors units: <img class="formulaInl" alt="$g species / m^2$" src="form_562.png"/></p>
<p>FLAG for the optimization of popd effect on fire I am taking the lterm out as the 'temp' var. So I have made tmp be dimension ilg and I overwrite the lterm (which is written to an output file) here in its place. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedisturbance__scheme.html">disturbance_scheme</a></li>
    <li class="footer">Generated on Thu Oct 26 2017 11:36:04 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
