<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/CLASSZ.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('CLASSZ_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSZ.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Checks for energy and water balance closure over modelled area.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3011accdb26e214045175dff31aead39"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSZ_8f.html#a3011accdb26e214045175dff31aead39">classz</a> (ISTEP, CTVSTP, CTSSTP, CT1STP, CT2STP, CT3STP, WTVSTP, WTSSTP, WTGSTP, FSGV, FLGV, HFSC, HEVC, HMFC, HTCC, FSGS, FLGS, HFSS, HEVS, HMFN, HTCS, FSGG, FLGG, HFSG, HEVG, HMFG, HTC, PCFC, PCLC, QFCF, QFCL, ROFC, WTRC, PCPN, QFN, ROFN, WTRS, PCPG, QFG, QFC, ROF, WTRG, CMAI, RCAN, SCAN, TCAN, SNO, WSNOW, TSNOW, THLIQ, THICE, HCPS, THPOR, DELZW, TBAR, ZPOND, TPOND, DELZ, FCS, FGS, FC, FG, IL1, IL2, ILG, IG, N)</td></tr>
<tr class="separator:a3011accdb26e214045175dff31aead39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Checks for energy and water balance closure over modelled area. </p>
<dl class="section author"><dt>Author</dt><dd>D. Verseghy </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a3011accdb26e214045175dff31aead39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3011accdb26e214045175dff31aead39">&#9670;&nbsp;</a></span>classz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classz </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ISTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CTVSTP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CTSSTP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CT1STP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CT2STP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CT3STP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WTVSTP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WTSSTP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WTGSTP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HMFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ig)&#160;</td>
          <td class="paramname"><em>HTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ig)&#160;</td>
          <td class="paramname"><em>QFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>ROF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>CMAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>SCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">istep</td><td>Flag indicating position at beginning or end of time step</td></tr>
    <tr><td class="paramname">ctvstp</td><td>Change in internal energy of vegetation over current time step <img class="formulaInl" alt="$[W m^{-2}] $" src="form_365.png"/></td></tr>
    <tr><td class="paramname">ctsstp</td><td>Change in internal energy of snow pack over current time step <img class="formulaInl" alt="$[W m^{-2}] $" src="form_365.png"/></td></tr>
    <tr><td class="paramname">ct1stp</td><td>Change in internal energy of first soil layer over current time step <img class="formulaInl" alt="$[W m^{-2}] $" src="form_365.png"/></td></tr>
    <tr><td class="paramname">ct2stp</td><td>Change in internal energy of second soil layer over current time step <img class="formulaInl" alt="$[W m^{-2}] $" src="form_365.png"/></td></tr>
    <tr><td class="paramname">ct3stp</td><td>Change in internal energy of third soil layer over current time step <img class="formulaInl" alt="$[W m^{-2}] $" src="form_365.png"/></td></tr>
    <tr><td class="paramname">wtvstp</td><td>Change in vegetation mass over current time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">wtsstp</td><td>Change in snow mass over current time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">wtgstp</td><td>Change in soil water storage over current time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">fsgv</td><td>Diagnosed net shortwave radiation on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}] (K_{*,c})$" src="form_366.png"/></td></tr>
    <tr><td class="paramname">flgv</td><td>Diagnosed net longwave radiation on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}] (L_{*,c})$" src="form_367.png"/></td></tr>
    <tr><td class="paramname">hfsc</td><td>Diagnosed sensible heat flux on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}] (Q_{H,c})$" src="form_368.png"/></td></tr>
    <tr><td class="paramname">hevc</td><td>Diagnosed latent heat flux on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}] (Q_{E,c})$" src="form_369.png"/></td></tr>
    <tr><td class="paramname">hmfc</td><td>Diagnosed energy associated with phase change of water on vegetation <img class="formulaInl" alt="$[W m^{-2}] (Q_{M,c})$" src="form_370.png"/></td></tr>
    <tr><td class="paramname">htcc</td><td>Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}] (Q_{I,c})$" src="form_371.png"/></td></tr>
    <tr><td class="paramname">fsgs</td><td>Diagnosed net shortwave radiation at snow surface <img class="formulaInl" alt="$[W m^{-2}] (K_{*,s})$" src="form_372.png"/></td></tr>
    <tr><td class="paramname">flgs</td><td>Diagnosed net longwave radiation at snow surface <img class="formulaInl" alt="$[W m^{-2}] (L_{*,s})$" src="form_373.png"/></td></tr>
    <tr><td class="paramname">hfss</td><td>Diagnosed sensible heat flux at snow surface <img class="formulaInl" alt="$[W m^{-2}] (Q_{H,s})$" src="form_374.png"/></td></tr>
    <tr><td class="paramname">hevs</td><td>Diagnosed latent heat flux at snow surface <img class="formulaInl" alt="$[W m^{-2}] (Q_{E,s})$" src="form_375.png"/></td></tr>
    <tr><td class="paramname">hmfn</td><td>Diagnosed energy associated with phase change of water in snow pack <img class="formulaInl" alt="$[W m^{-2}] (Q_{M,s})$" src="form_376.png"/></td></tr>
    <tr><td class="paramname">htcs</td><td>Diagnosed internal energy change of snow pack due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}] (Q_{I,s})$" src="form_377.png"/></td></tr>
    <tr><td class="paramname">fsgg</td><td>Diagnosed net shortwave radiation at soil surface <img class="formulaInl" alt="$[W m^{-2}] (K_{*,g})$" src="form_378.png"/></td></tr>
    <tr><td class="paramname">flgg</td><td>Diagnosed net longwave radiation at soil surface <img class="formulaInl" alt="$[W m^{-2}] (L_{*,g})$" src="form_379.png"/></td></tr>
    <tr><td class="paramname">hfsg</td><td>Diagnosed sensible heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}] (Q_{H,g})$" src="form_380.png"/></td></tr>
    <tr><td class="paramname">hevg</td><td>Diagnosed latent heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}] (Q_{E,g})$" src="form_381.png"/></td></tr>
    <tr><td class="paramname">hmfg</td><td>Diagnosed energy associated with phase change of water in soil layers <img class="formulaInl" alt="$[W m^{-2}] (Q_{M,g})$" src="form_382.png"/></td></tr>
    <tr><td class="paramname">htc</td><td>Diagnosed internal energy change of soil layer due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}] (Q_{I,g})$" src="form_383.png"/></td></tr>
    <tr><td class="paramname">pcfc</td><td>Diagnosed frozen precipitation intercepted by vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (P_{f,c})$" src="form_384.png"/></td></tr>
    <tr><td class="paramname">pclc</td><td>Diagnosed liquid precipitation intercepted by vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (P_{l,c})$" src="form_385.png"/></td></tr>
    <tr><td class="paramname">qfcf</td><td>Diagnosed vapour flux from frozen water on vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (E_{f,c})$" src="form_386.png"/></td></tr>
    <tr><td class="paramname">qfcl</td><td>Diagnosed vapour flux from liquid water on vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (E_{l,c})$" src="form_387.png"/></td></tr>
    <tr><td class="paramname">rofc</td><td>Liquid/frozen water runoff from vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (R_c)$" src="form_388.png"/></td></tr>
    <tr><td class="paramname">wtrc</td><td>Diagnosed water transferred off the vegetation canopy <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (A_c)$" src="form_389.png"/></td></tr>
    <tr><td class="paramname">pcpn</td><td>Diagnosed precipitation incident on snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (P_s)$" src="form_390.png"/></td></tr>
    <tr><td class="paramname">qfn</td><td>Diagnosed water vapour flux from snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (E_s)$" src="form_391.png"/></td></tr>
    <tr><td class="paramname">rofn</td><td>Liquid water runoff from snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (R_s)$" src="form_392.png"/></td></tr>
    <tr><td class="paramname">wtrs</td><td>Diagnosed water transferred into or out of the snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (A_s)$" src="form_393.png"/></td></tr>
    <tr><td class="paramname">pcpg</td><td>Diagnosed precipitation incident on ground <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (P_g)$" src="form_394.png"/></td></tr>
    <tr><td class="paramname">qfg</td><td>Diagnosed water vapour flux from ground surface <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (E_g)$" src="form_395.png"/></td></tr>
    <tr><td class="paramname">qfc</td><td>Diagnosed vapour flux from transpiration over modelled area <img class="formulaInl" alt="$[W m^{-2}] (E_c)$" src="form_396.png"/></td></tr>
    <tr><td class="paramname">rof</td><td>Total runoff from soil <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (R_g)$" src="form_397.png"/></td></tr>
    <tr><td class="paramname">wtrg</td><td>Diagnosed water transferred into or out of the soil <img class="formulaInl" alt="$[kg m^{-2} s^{-1}] (A_g)$" src="form_398.png"/></td></tr>
    <tr><td class="paramname">cmai</td><td>Current mass of vegetation canopy <img class="formulaInl" alt="$[kg m^{-2}] (W_c)$" src="form_399.png"/></td></tr>
    <tr><td class="paramname">rcan</td><td>Intercepted liquid water stored on canopy <img class="formulaInl" alt="$[kg m^{-2}] (W_{l,c})$" src="form_123.png"/></td></tr>
    <tr><td class="paramname">scan</td><td>Intercepted frozen water stored on canopy <img class="formulaInl" alt="$[kg m^{-2}] (W_{f,c})$" src="form_124.png"/></td></tr>
    <tr><td class="paramname">tcan</td><td>Vegetation canopy temperature <img class="formulaInl" alt="$[K] (T_c)$" src="form_125.png"/></td></tr>
    <tr><td class="paramname">sno</td><td>Mass of snow pack <img class="formulaInl" alt="$[kg m^{-2}] (W_s)$" src="form_249.png"/></td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2}] (W_{l,s})$" src="form_400.png"/></td></tr>
    <tr><td class="paramname">tsnow</td><td>Snowpack temperature <img class="formulaInl" alt="$[K] (T_s)$" src="form_401.png"/></td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_l)$" src="form_402.png"/></td></tr>
    <tr><td class="paramname">thice</td><td>Volumetric frozen water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_f)$" src="form_403.png"/></td></tr>
    <tr><td class="paramname">hcps</td><td>Volumetric heat capacity of soil particles <img class="formulaInl" alt="$[J m^{-3}] (C_g)$" src="form_404.png"/></td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable thickness of soil layer <img class="formulaInl" alt="$[m] (\Delta_zw)$" src="form_405.png"/></td></tr>
    <tr><td class="paramname">delz</td><td>Total thickness of soil layer <img class="formulaInl" alt="$[m] (\Delta_z)$" src="form_406.png"/></td></tr>
    <tr><td class="paramname">tbar</td><td>Temperature of soil layers <img class="formulaInl" alt="$[K] (T_g)$" src="form_216.png"/></td></tr>
    <tr><td class="paramname">zpond</td><td>Depth of ponded water on surface <img class="formulaInl" alt="$[m] (z_p)$" src="form_407.png"/></td></tr>
    <tr><td class="paramname">tpond</td><td>Total thickness of soil layer <img class="formulaInl" alt="$[m] (\Delta_z)$" src="form_406.png"/></td></tr>
    <tr><td class="paramname">fcs</td><td>Fractional coverage of vegetation over snow on modelled area [ ]</td></tr>
    <tr><td class="paramname">fgs</td><td>Fractional coverage of snow over bare ground on modelled area [ ]</td></tr>
    <tr><td class="paramname">fc</td><td>Fractional coverage of vegetation over bare ground on modelled area [ ]</td></tr>
    <tr><td class="paramname">fg</td><td>Fractional coverage of bare ground on modelled area [ ] </td></tr>
  </table>
  </dd>
</dl>
<p>In this subroutine, checks are carried out to ensure that the change in energy storage in each of the components of the modelled area (canopy, snow and soil) is equal to the sum of the energy fluxes into and out of them; and that the change in moisture storage in each of the components is equal to the sum of the water fluxes into and out of them. The subroutine is called twice, once at the beginning (ISTEP=0) and once at the end (ISTEP=1) of each time step. At the beginning, the instantaneous energy and moisture storage terms are evaluated, and at the end the differences over the time step are calculated:</p>
<p>Change in canopy energy storage = <img class="formulaInl" alt="$\Delta [(c_c W_c + c_w W_{l,c} + c_i W_{f,c} )T_c ] / \Delta t$" src="form_408.png"/></p>
<p>Change in snow energy storage = <img class="formulaInl" alt="$\Delta [(C_i W_s /\rho_i + C_w W_{l,s} / \rho_w )T_s ]/ \Delta t $" src="form_409.png"/></p>
<p>Change in soil layer energy storage = <img class="formulaInl" alt="$\Delta {[(C_w \theta_l + C_i \theta_f + C_g \theta_g ) \Delta z_w + C_b (\Delta z – \Delta z_w )]T_j }/ \Delta t$" src="form_410.png"/> (For the first soil layer, the numerator contains the additional term <img class="formulaInl" alt="$C_w z_p T_p$" src="form_411.png"/>.)</p>
<p>Change in canopy moisture storage = <img class="formulaInl" alt="$\Delta[W_{l,c} + W_{f,c}]$" src="form_412.png"/></p>
<p>Change in snow moisture storage = <img class="formulaInl" alt="$\Delta[W_s + W_{l,s}]$" src="form_413.png"/></p>
<p>Change in soil moisture storage = <img class="formulaInl" alt="$\Delta [(\theta_l \rho_w + \theta_f \rho_i ) \Delta z_w + z_p \rho_w ]$" src="form_414.png"/></p>
<p>The net energy and moisture fluxes are also evaluated at the end of the time step:</p>
<p>Net energy flux for canopy = <img class="formulaInl" alt="$K_{*,c} + L_{*,c} – Q_{H,c} – Q_{E,c} – Q_{M,c} + Q_{I,c}$" src="form_415.png"/></p>
<p>Net energy flux for snow = <img class="formulaInl" alt="$K_{*,s} + L_{*,s} – Q_{H,s} – Q_{E,s} – Q_{M,s} + Q_{I,s}$" src="form_416.png"/></p>
<p>Net energy flux for first soil layer = <img class="formulaInl" alt="$K_{*,g} + L_{*,g} – Q_{H,g} – Q_{E,g} – Q_{M,1} + Q_{I,1}$" src="form_417.png"/></p>
<p>Net energy flux for other soil layers = <img class="formulaInl" alt="$- Q_{M,j} + Q_{I,j}$" src="form_418.png"/></p>
<p>Net moisture flux for canopy = <img class="formulaInl" alt="$P_{l,c} + P_{f,c} – E_{l,c} – E_{f,c} – R_c + A_c$" src="form_419.png"/></p>
<p>Net moisture flux for snow = <img class="formulaInl" alt="$P_s – E_s – R_s + A_s$" src="form_420.png"/></p>
<p>Net moisture flux for soil = <img class="formulaInl" alt="$P_g – E_g – R_g + A_g - E_c$" src="form_421.png"/></p>
<p>In these equations the <img class="formulaInl" alt="$K_*$" src="form_422.png"/> terms refer to net shortwave radiation, the <img class="formulaInl" alt="$L_*$" src="form_423.png"/> terms to net longwave radiation, the <img class="formulaInl" alt="$Q_H$" src="form_424.png"/> terms to sensible heat flux, the <img class="formulaInl" alt="$Q_E$" src="form_425.png"/> terms to latent heat flux, the <img class="formulaInl" alt="$Q_M$" src="form_426.png"/> terms to heat associated with melting or freezing of water, and the <img class="formulaInl" alt="$Q_I$" src="form_427.png"/> terms to changes in heat storage caused by conduction or redistribution of water. The P terms refer to precipitation, the E terms to evaporation, the R terms to runoff and the A terms to water transferred between different components of the landscape. The subscript 1 refers to the first soil layer, and j to a generalized other layer.</p>
<p>Finally, each change in energy or moisture storage is compared in turn with the corresponding net flux of energy or moisture, and if the difference is greater than a selected threshold value, an error message is printed out and the run is stopped.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="CLASSZ_8f.html">CLASSZ.f</a></li>
    <li class="footer">Generated on Tue Mar 12 2019 15:42:13 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
