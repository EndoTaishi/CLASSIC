<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: src/CLASSB.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('CLASSB_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSB.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Assigns thermal and hydraulic properties to soil layers based on sand/clay content, or soil type. Also calculates permeable thickness of soil layers, and wet and dry surface albedo for mineral soils.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:abc81628397c097e3244bd460913ec098"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSB_8f.html#abc81628397c097e3244bd460913ec098">classb</a> (THPOR, THLRET, THLMIN, BI, PSISAT, GRKSAT, THLRAT, HCPS, TCS, THFC, THLW, PSIWLT, DELZW, ZBOTW, ALGWV, ALGWN, ALGDV, ALGDN, SAND, CLAY, ORGM, SOCI, DELZ, ZBOT, SDEPTH, ISAND, IGDR, NL, NM, IL1, IL2, IM, IG, ipeatland)</td></tr>
<tr class="separator:abc81628397c097e3244bd460913ec098"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Assigns thermal and hydraulic properties to soil layers based on sand/clay content, or soil type. Also calculates permeable thickness of soil layers, and wet and dry surface albedo for mineral soils. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="abc81628397c097e3244bd460913ec098"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classb </td>
          <td>(</td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>GRKSAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLRAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>TCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>PSIWLT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGWV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGWN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGDV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>SAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>CLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ORGM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm)&#160;</td>
          <td class="paramname"><em>SOCI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>ZBOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>SDEPTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (nl,nm)&#160;</td>
          <td class="paramname"><em>IGDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>ipeatland</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thpor</td><td>Pore volume <img class="formulaInl" alt="$[m^3 m^{-3} ] ( \theta_p )$" src="form_256.png"/></td></tr>
    <tr><td class="paramname">thlret</td><td>Liquid water retention capacity for organic soil <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{ret} )$" src="form_257.png"/></td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{min} )$" src="form_258.png"/></td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical parameter [ ] (b)</td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation [m] <img class="formulaInl" alt="$(\Psi_{sat} )$" src="form_259.png"/></td></tr>
    <tr><td class="paramname">grksat</td><td>Hydraulic conductivity of soil at saturation <img class="formulaInl" alt="$[m s^{-1} ] (K_{sat} )$" src="form_260.png"/></td></tr>
    <tr><td class="paramname">thlrat</td><td>Fractional saturation of soil at half the saturated hydraulic conductivity [ ] <img class="formulaInl" alt="$(f_{inf} )$" src="form_261.png"/></td></tr>
    <tr><td class="paramname">hcps</td><td>Volumetric heat capacity of soil matter <img class="formulaInl" alt="$[J m^{-3} K^{-1} ] (C_g )$" src="form_262.png"/></td></tr>
    <tr><td class="paramname">tcs</td><td>Thermal conductivity of soil <img class="formulaInl" alt="$[W m^{-1} K^{-1} ] (\tau_g )$" src="form_263.png"/></td></tr>
    <tr><td class="paramname">thfc</td><td>Field capacity <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{fc} )$" src="form_264.png"/></td></tr>
    <tr><td class="paramname">thlw</td><td>Soil water content at wilting point, <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{wilt})$" src="form_265.png"/></td></tr>
    <tr><td class="paramname">psiwlt</td><td>Soil moisture suction at wilting point [m] <img class="formulaInl" alt="$(\Psi_{wilt} )$" src="form_266.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Thickness of permeable part of soil layer [m]</td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth of bottom of permeable part of soil layer [m]</td></tr>
    <tr><td class="paramname">algwv</td><td>Visible albedo of wet soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algwn</td><td>Near-IR albedo of wet soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algdv</td><td>Visible albedo of dry soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algdn</td><td>Near-IR albedo of dry soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">igdr</td><td>Index of soil layer in which bedrock is encountered</td></tr>
    <tr><td class="paramname">ipeatland</td><td>Peatland flag: 0 = not a peatland, 1= bog, 2 = fen</td></tr>
    <tr><td class="paramname">sand</td><td>Percent sand content of soil layer [percent] <img class="formulaInl" alt="$(X_{sand} )$" src="form_267.png"/></td></tr>
    <tr><td class="paramname">clay</td><td>Percent clay content of soil layer [percent] <img class="formulaInl" alt="$(X_{clay} )$" src="form_268.png"/></td></tr>
    <tr><td class="paramname">orgm</td><td>Percent organic matter content of soil layer [percent]</td></tr>
    <tr><td class="paramname">delz</td><td>Thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">zbot</td><td>Depth of bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">sdepth</td><td>Permeable depth of soil column (depth to bedrock) [m] <img class="formulaInl" alt="$(z_b )$" src="form_269.png"/></td></tr>
    <tr><td class="paramname">soci</td><td>Soil colour index </td></tr>
  </table>
  </dd>
</dl>
<p>In the first section of code, two integer flags are evaluated: IGDR, the index of the soil layer in which the bottom of the soil permeable depth, <img class="formulaInl" alt="$z_b$" src="form_46.png"/> , occurs; and ISAND, the value of the SAND variable for each soil layer converted to an integer. ISAND is used throughout the CLASS code as a flag to determine which branches of code to execute.</p>
<p>In loop 200, calculations are done to determine the permeable thickness DELZW of each soil layer. If the land cover is an ice sheet (indicated by an ISAND value of -4 in the top layer), the value of DELZW in each layer is set to DELZ, the standard thickness of the corresponding thermal layer, and the soil flag is set to -4. If the layer consists of rock, indicated by an ISAND value of -3, DELZW is set to 0. For soil layers where <img class="formulaInl" alt="$z_b$" src="form_46.png"/> occurs below the bottom of the layer, DELZW is set to DELZ; for layers where <img class="formulaInl" alt="$z_b$" src="form_46.png"/> occurs near the top of the layer, DELZW is set to 0 and ISAND is set to -3. For the soil layer containing <img class="formulaInl" alt="$z_b$" src="form_46.png"/> , DELZW is set to the distance from the top of the layer to <img class="formulaInl" alt="$z_b$" src="form_46.png"/> , and is further constrained to be <img class="formulaInl" alt="$\geq$" src="form_270.png"/> 5 cm, to avoid overshoots in the water movement calculations. For all layers, the distance to the bottom of its respective permeable depth, ZBOTW, is set to the depth of the top of the layer plus DELZW. At the end of the loop, if the soil is a mineral one, the wet and dry visible and near-IR soil albedo values are assigned using the lookup tables ALWV, ALWN, ALDV and ALDN found in the DATA section of the subroutine, on the basis of a global gridded soil “colour” (i.e. reflectivity) index SOCI, documented in Lawrence and Chase (2007) <a class="el" href="citelist.html#CITEREF_Lawrence2007-bc">[51]</a> and Oleson et al. (2010) <a class="el" href="citelist.html#CITEREF_Oleson2010-c88">[66]</a>.</p>
<p>In loop 300, various thermal and hydraulic soil properties are assigned to each of the soil layers, depending on soil type. Values of ISAND greater than or equal to zero indicate mineral soil. The pore volume <img class="formulaInl" alt="$\theta_p$" src="form_90.png"/> , the saturated hydraulic conductivity <img class="formulaInl" alt="$K_{sat}$" src="form_271.png"/> , and the soil moisture suction at saturation <img class="formulaInl" alt="$\Psi$" src="form_48.png"/> sat are calculated from the percentage sand content <img class="formulaInl" alt="$X_{sand}$" src="form_272.png"/> , and the hydraulic parameter b is calculated from the percentage clay content <img class="formulaInl" alt="$X_{clay}$" src="form_273.png"/> , based on empirical relationships given in Cosby et al. (1984) <b>[Cosby1984-jc:]</b> </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="CLASSB_8f.html">CLASSB.f</a></li>
    <li class="footer">Generated on Mon Nov 20 2017 21:27:59 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
