<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: Overview of the Canadian Land Surface Scheme (CLASS)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('overviewCLASS.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview of the Canadian Land Surface Scheme (CLASS) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Canadian Land Surface Scheme, CLASS, was originally developed for use with the Canadian Global Climate Model or GCM (Verseghy, 1991 <a class="el" href="citelist.html#CITEREF_Verseghy1991-635">[83]</a> ; Verseghy et al., 1993 <a class="el" href="citelist.html#CITEREF_Verseghy1993-1ee">[82]</a> ). The table at the end of this overview summarizes the development of CLASS from the late 1980’s onward.</p>
<p>The basic function of CLASS is to integrate the energy and water balances of the land surface forward in time from an initial starting point, making use of atmospheric forcing data to drive the simulation. When CLASS is run in coupled mode with a global or regional atmospheric model, the required forcing data are passed to it at each time step over each modeled grid cell from the atmospheric driver. CLASS then performs its internal calculations, evaluating a suite of prognostic and diagnostic variables such as albedo and surface radiative and turbulent fluxes, which are in turn passed back to the driver. CLASS can also be run in uncoupled or offline mode, using forcing data derived from field measurements, and the output values of its prognostic and diagnostic variables can then be validated against observations.</p>
<p>CLASS models separately the energy and water balances of the soil, snow, and vegetation canopy (see the diagram below). The basic prognostic variables consist of the temperatures and the liquid and frozen moisture contents of the soil layers; the mass, temperature, density, albedo and liquid water content of the snow pack; the temperature of the vegetation canopy and the mass of intercepted rain and snow present on it; the temperature and depth of ponded water on the soil surface; and an empirical vegetation growth index. These variables must be initialized, and a set of physical parameters describing the soil and vegetation existing on the modelled area must be assigned background values, at the beginning of the simulation (see <a class="el" href="forcingData.html">Atmospheric Forcing Data</a>).</p>
<p>At each time step, CLASS calculates the bulk characteristics of the vegetation canopy on the basis of the vegetation types present over the modelled area. In a pre-processing step, each vegetation type is assigned representative values of parameters such as albedo, roughness length, annual maximum and minimum plant area index, rooting depth and so on (see <a class="el" href="initProgVar.html">Initialization of Prognostic Variables</a>). These values are then aggregated over four main vegetation categories identified by CLASS usually: needleleaf trees, broadleaf trees, crops, and grass (i.e. short vegetation). The physiological characteristics of the vegetation in each category are determined at the current time step using the aggregated background parameters and assumed annual or diurnal variation functions. These physiological characteristics are then aggregated to produce the bulk canopy characteristics for the current time step.</p>
<div class="image">
<img src="schematicDiagramOfClass.png" alt="schematicDiagramOfClass.png"/>
<div class="caption">
Schematic Diagram Of CLASS</div></div>
 In performing the surface flux calculations the modeled area is divided into up to four subareas: bare soil, vegetation over soil, snow over bare soil, and vegetation over snow. The fractional snow coverage is determined using the concept of a threshold snow depth. If the calculated snow depth is less than this value, the snow depth is set to the threshold value and the fractional snow cover is calculated on the basis of conservation of snow mass. The fluxes are calculated for each of the four subareas, and these and the prognostic variables are then areally averaged before being passed back to the atmospheric model.</p>
<p>Originally CLASS performed only one set of these calculations for each grid cell of the model domain. In more recent versions, a “mosaic” option has been added to handle sub-grid scale heterogeneity more effectively. When this option is utilized, each grid cell is divided into a user-specified number of mosaic “tiles”, and the CLASS calculations are performed in turn over each. The surface fluxes are averaged, but the prognostic variables are kept separate for each of the tiles of the mosaic between time steps (see <a class="el" href="compvsmosaic.html">here for more</a>).</p>
<p>In the CLASSIC offline driver, a gather-scatter operation is included in the driver, mimicking the practice in atmospheric models of “gathering” land surface points on latitude circles onto long vectors prior to the calculations (e.g. <a class="el" href="CLASSG_8f.html" title="Gathers variables from two-dimensional arrays (latitude circle x mosaic tiles) onto long vectors for ...">src/CLASSG.f</a> or <a class="el" href="ctemg2_8f.html" title="Performs subsequent &#39;gather&#39; operation on CTEM variables for consistency with physics variables gathe...">src/ctemg2.f</a>), for improved computational efficiency on vector supercomputers. For CLASS, the mosaic tiles on each of the modelled grid cells are “gathered” onto long arrays prior to calling the CLASS subroutines (thus collapsing the first two dimensions of the arrays into one), and subsequently “scattered” back onto the grid cells before performing the diagnostic averaging calculations (e.g. <a class="el" href="CLASSS_8f.html" title="Scatters variables from long, gathered vectors back onto original two-dimensional arrays (latitude ci...">src/CLASSS.f</a> or <a class="el" href="ctems2_8f.html" title="Performs subsequent scatter operation on biogeochemical variables. ">src/ctems2.f</a>).</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | l || l | } 1.0 &amp; April 1989 &amp; Basic thermal and hydrological model of snow and soil. \\ 2.0 &amp; August 1991 &amp; Addition of vegetation thermal and hydrological model. \\ 2.1 &amp; May 1993 &amp; Full vectorization of code to enable efficienr running on vector supercomputers. \\ 2.2 &amp; April 1994 &amp; Augmentation of diagnostic calculations; incorporation of in-line comments throughout; development \\ &amp; &amp; of a parallel stand-alone version of the model for use with field data. \\ 2.3 &amp; December 1994 &amp; Revisions to diagnostic calculations; new near-surface atmospheric stability functions. \\ 2.4 &amp; August 1995 &amp; Complete set of water budget diagnostic calculations; parametrizations of organic soils and \\ &amp; &amp;rock soils; allowance for inhomegeneity between soil layers; incorporation of variable \\ &amp; &amp; surface detention capacity. \\ 2.5 &amp; January 1996 &amp; Completion of energy budget diagnostic calculations. \\ 2.6 &amp; August 1997 &amp; Revisions to surface stability function calculations. \\ 2.7 &amp; December 1997 &amp; Incorporation of variable soil permeable depth; calculation of soil thermal and hydraulic properties based on textural composition; modified surface temperature iteration scheme. \\ 3.0 &amp; December 2002 &amp; Improved treatment of soil evaporation; complete treatment of organic soils; new canopy conductance formulation; preliminary routines for lateral movement of soil water; enhanced snow density and snow interception; improved turbulent transfer from vegetation; mosaic formulation. \\ 3.1 &amp; April 2005 &amp; Faster surface temperature iteration scheme; refinements to leaf boundary resistance formulation; improved treatment of snow sublimation and interception; transition to Fortran 90 and single precision variables. \\ 3.2 &amp; May 2006 &amp; Option for multiple soil layers at depth; additional liquid water content of snow pack; revised radiation transmission in vegetation. \\ 3.3 &amp; December 2006 &amp; Separate temperature profile curve fit for snow and soil; multiple-layer option for ice sheets; water and energy balance checks for each time step; modifications to soil hydraulic conductivity calculations. \\ 3.4 &amp; April 2008 &amp; Streamline and clean up code; updated soil thermal conductivity calculations; revisions to handling of water stored on vegetation. \\ 3.5 &amp; December 2010 &amp; Updated field capacity calculation; revised treatment of water on canopy; reworked calculation of baseflow. \\ 3.6 &amp; December 2011 &amp; Revised ponding depth over organic soils; revised snow albedo refreshment threshold; new snow thermal conductivity algorithm; interface with Canadian Terrestrial Ecosystem Model (CTEM). \\ 3.6.1 &amp; December 2016 &amp; New treatment of bare soil albedo; new optional four-band snow albedo formulation; fixes to guard against overshoots in water drawdown by evapotranspiration; upper limit on snow depth. \\ \end{tabular} \]" src="form_1508.png"/>
</p>
<h1><a class="anchor" id="overviewCTEM"></a>
Overview of the Canadian Terrestrial Ecosystem Model (CTEM)</h1>
<p>Version 1 of the CTEM is the terrestrial carbon cycle component of the second generation Canadian Earth System Model (CanESM2) (Arora et al., 2011)<a class="el" href="citelist.html#CITEREF_Arora2011-79f">[12]</a> where it is coupled to version 2.7 of the Canadian Land Surface Scheme (CLASS). CTEM v. 2.0 (Melton and Arora, 2016) <a class="el" href="citelist.html#CITEREF_Melton2016-zx">[62]</a> was coupled to CLASS v. 3.6 (Verseghy, 2012) <a class="el" href="citelist.html#CITEREF_Verseghy2012-c0e">[84]</a>. The coupled CLASS&ndash;CTEM model is capable of being run online in the CanESM model or offline, driven by observation-based meteorological forcings. CTEM models terrestrial ecosystem processes for nine PFTs, two of which are crop PFTs (see table below), by tracking the flow of carbon through three living vegetation components (leaves, stem and roots) and two dead carbon pools (litter and soil).</p>
<table class="doxtable">
<tr>
<th align="center">CLASS PFTs </th><th align="center">CTEM PFTs </th><th></th><th></th><th align="center">Peatland PFTs </th><th></th></tr>
<tr>
<td align="center">Needleleaf tree </td><td align="center">Evergreen </td><td>Deciduous </td><td></td><td align="center"></td><td></td></tr>
<tr>
<td align="center">Broadleaf tree </td><td align="center">Evergreen </td><td>Cold Deciduous </td><td>Drought/Dry Decidous </td><td align="center">Evergreen Shrubs </td><td>Deciduous Shrubs </td></tr>
<tr>
<td align="center">Crop </td><td align="center">C <img class="formulaInl" alt="$_3$" src="form_1545.png"/> </td><td>C$_4$ </td><td></td><td align="center"></td><td></td></tr>
<tr>
<td align="center">Grass </td><td align="center">C$_3$ </td><td>C$_4$ </td><td></td><td align="center">Sedges </td><td></td></tr>
</table>
<p>The amount of carbon in these five carbon pools is simulated prognostically (see below). In the CLASSIC framework, CLASS uses structural vegetation attributes (including LAI, vegetation height, canopy mass and rooting depth) simulated by CTEM, and CTEM uses soil moisture, soil temperature and net radiation calculated by CLASS. Combined, CLASS and CTEM simulate the atmosphere&ndash;land fluxes of energy, water and <img class="formulaInl" alt="$CO_2$" src="form_545.png"/>.</p>
<p>Version 1.0 of CTEM is described in a collection of papers detailing parametrization of photosynthesis, autotrophic and heterotrophic respiration (Arora, 2003) <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[13]</a>; phenology, carbon allocation, biomass turnover and conversion of biomass to structural attributes (Arora and Boer, 2005) <a class="el" href="citelist.html#CITEREF_Arora2005-6b1">[7]</a>; dynamic root distribution (Arora and Boer, 2003) <a class="el" href="citelist.html#CITEREF_Arora2003838">[5]</a>; and disturbance (fire) (Arora and Boer, 2005) <a class="el" href="citelist.html#CITEREF_Arora20052ac">[6]</a>. These processes are modelled over prescribed fractional coverage of (typically) nine PFTs (Wang et al., 2006) <a class="el" href="citelist.html#CITEREF_Wang2006-he">[87]</a> and determine the structural vegetation dynamics including vegetation biomass, LAI, vegetation height, fraction of roots in each of the three soil layers, leaf onset and offset times and primary <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> fluxes of gross primary productivity (GPP) and NPP. CTEM v. 2.0 is described in Melton and Arora, 2016 <a class="el" href="citelist.html#CITEREF_Melton2016-zx">[62]</a>.</p>
<h2><a class="anchor" id="CTEMRateChgEqns"></a>
Rate change equations for carbon pools</h2>
<p>From the gross canopy photosynthesis rate ( <img class="formulaInl" alt="$G_{\text{canopy}}$" src="form_1546.png"/>, <a class="el" href="PHTSYN3_8f.html" title="Photosynthesis and canopy conductance. ">src/PHTSYN3.f</a>), maintenance and growth respirations ( <img class="formulaInl" alt="$R_\mathrm{m}$" src="form_833.png"/> and <img class="formulaInl" alt="$R_\mathrm{g}$" src="form_834.png"/>, <a class="el" href="mainres_8f.html" title="Calculates maintenance respiration, over a given sub-area, for stem and root components. leaf respiration is estimated within the phtsyn subroutine. ">src/mainres.f</a>), and heterotrophic respiration components ( <img class="formulaInl" alt="$R_{\text{h,H}}$" src="form_1547.png"/> and <img class="formulaInl" alt="$R_{\text{h,D}}$" src="form_1548.png"/>, <a class="el" href="hetres__mod_8f90.html" title="Central module for all heterotrophic respiration-related operations. ">src/hetres_mod.f90</a>), it is possible to estimate the change in carbon amount of the model's five pools.</p>
<p>When the daily NPP ( <img class="formulaInl" alt="$ G_{canopy} - R_\mathrm{m} - R_\mathrm{g}$" src="form_1549.png"/>) is positive, carbon is allocated to the plant's live carbon pools and the rate of change is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\mathrm{d}C_i}{\mathrm{d}t} = a_{fi} \left(G_{canopy}-R_\mathrm{m}-R_\mathrm{g} \right) - D_i - H_i - M_i \\ \quad i = {L, S, R} \]" src="form_1554.png"/>
</p>
<p>where <img class="formulaInl" alt="$a_{fi}$" src="form_1555.png"/> is the corresponding allocation fractions for each pool (stem, root and leaves) and <img class="formulaInl" alt="$D_i$" src="form_1556.png"/> is the litter produced from these components as explained in <a class="el" href="phenolgy_8f90.html" title="Calculates the leaf status for CTEM&#39;s pfts and leaf litter generated by normal turnover of leaves and...">src/phenolgy.f90</a>. <img class="formulaInl" alt="$H_i$" src="form_1557.png"/> is the loss associated with fire that releases {CO_2} and other trace gases to the atmosphere and <img class="formulaInl" alt="$M_i$" src="form_1558.png"/> is the mortality associated with fire that contributes to the litter pool as explained in <a class="el" href="disturb_8f90.html" title="Calculates disturbance as both natural and human-influenced fires. ">src/disturb.f90</a>.</p>
<p>If the daily NPP is negative ( <img class="formulaInl" alt="$G_{canopy} &lt; R_\mathrm{m}$" src="form_1559.png"/>, <img class="formulaInl" alt="$R_\mathrm{g} = 0$" src="form_1560.png"/>), the rate of change is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\mathrm{d}C_i}{\mathrm{d}t} = a_{fi}G_{canopy} - R_{m,i} - D_i - H_i - M_i, \\ \quad i = {L, S, R} \]" src="form_1561.png"/>
</p>
<p>Negative NPP causes the plant to lose carbon from its live carbon pools due to respiratory costs in addition to the losses due to litter production ( <img class="formulaInl" alt="$D_i$" src="form_1556.png"/>) and disturbance ( <img class="formulaInl" alt="$H_i$" src="form_1557.png"/>, <img class="formulaInl" alt="$M_i$" src="form_1558.png"/>).</p>
<p>The rate change equations for the litter and soil carbon pools are given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \frac{\mathrm{d}C_\mathrm{D}}{\mathrm{d}t} &amp;=&amp; D_\mathrm{L} + D_\mathrm{S} + D_\mathrm{R} + M_\mathrm{L} + M_\mathrm{R} + M_\mathrm{S} - H_\mathrm{D} -C_{\mathrm{D} \rightarrow \mathrm{H}} - R_{h,D} \\ \frac{\mathrm{d}C_\mathrm{H}}{\mathrm{d}t} &amp;=&amp; C_{\mathrm{D} \rightarrow \mathrm{H}} - R_{h,H} \end{eqnarray*}" src="form_1565.png"/>
</p>
<p>where <img class="formulaInl" alt="$C_{\mathrm{D} \rightarrow \mathrm{H}}$" src="form_801.png"/> represents the transfer of humified litter to the soil carbon pool and <img class="formulaInl" alt="$H_\mathrm{D}$" src="form_1564.png"/> is loss associated with burning of litter associated with fire that releases {CO_2} and other trace gases to the atmosphere.</p>
<p>A parametrization for competition between PFTs in an earlier version of CTEM is described by <a class="el" href="citelist.html#CITEREF_Arora2006-pp">[8]</a> <a class="el" href="citelist.html#CITEREF_Arora2006-ax">[9]</a> where it was evaluated at select locations. Here we present CTEM v. 2.0, which builds upon the model framework of CTEM v. 1.0 and can be run in two different modes, either (i) using specified fractional coverage of its nine PFTs, or (ii) allowing the fractional coverage of its seven non-crop PFTs to be dynamically determined based on competition between PFTs. The parametrization for simulating competition between PFTs is summarized in Sect. compmain}. The fire parametrization has also been refined in the new model version as described in Appendix fire}. The CLASS&ndash;CTEM modelling framework has the capability of representing the sub-grid scale variability of PFTs using either a composite or a mosaic configuration <a class="el" href="citelist.html#CITEREF_Li2012-f7f">[56]</a> <a class="el" href="citelist.html#CITEREF_Melton2014-xk">[60]</a>. In the composite (or single tile) configuration, the vegetation attributes for all PFTs present in a grid cell are averaged and used in energy and water balance calculations that determine the physical land surface conditions including soil moisture, soil temperature and thickness and fractional coverage of snow (if present). In the mosaic (or multi-tile) configuration each PFT is allocated its own tile for which separate energy and water balance calculations are performed. As a result, the simulated carbon balance evolves somewhat differently in the two configurations despite being driven with identical climate forcing (see <a class="el" href="citelist.html#CITEREF_Melton2014-xk">[60]</a>). The results presented in this paper are obtained using the composite configuration. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Aug 9 2018 14:12:18 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
