<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/SNOALBA.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('SNOALBA_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">SNOALBA.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Diagnoses snowpack visible and near-IR albedos given the all-wave albedo at the current time step. Calculates snowpack transmissivity for shortwave radiation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a414a4eaf6a7d196c40633aa1c1ab2159"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SNOALBA_8f.html#a414a4eaf6a7d196c40633aa1c1ab2159">snoalba</a> (ALVSSN, ALIRSN, ALVSSC, ALIRSC, ALBSNO, TRSNOWC, ALSNO, TRSNOWG, FSDB, FSFB, RHOSNO, REFSN, BCSN, SNO, CSZ, ZSNOW, FSNOW, ASVDAT, ASIDAT, ALVSG, ALIRG, ILG, IG, IL1, IL2, JL, IALS, NBS, ISNOALB)</td></tr>
<tr class="separator:a414a4eaf6a7d196c40633aa1c1ab2159"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Diagnoses snowpack visible and near-IR albedos given the all-wave albedo at the current time step. Calculates snowpack transmissivity for shortwave radiation. </p>
<dl class="section author"><dt>Author</dt><dd>D. Verseghy, J. Cole, M. Lazare </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a414a4eaf6a7d196c40633aa1c1ab2159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a414a4eaf6a7d196c40633aa1c1ab2159">&#9670;&nbsp;</a></span>snoalba()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine snoalba </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSSN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRSN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALBSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRSNOWC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,nbs)&#160;</td>
          <td class="paramname"><em>ALSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,nbs)&#160;</td>
          <td class="paramname"><em>TRSNOWG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,nbs)&#160;</td>
          <td class="paramname"><em>FSDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,nbs)&#160;</td>
          <td class="paramname"><em>FSFB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>REFSN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>BCSN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>CSZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ASVDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ASIDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ALVSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ALIRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IALS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NBS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ISNOALB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nbs</td><td>Number of modelled shortwave radiation wavelength bands</td></tr>
    <tr><td class="paramname">isnoalb</td><td>Switch to model snow albedo in two or more wavelength bands</td></tr>
    <tr><td class="paramname">alvssn</td><td>Visible albedo of snow pack on bare ground <img class="formulaInl" alt="$[ ] (alpha_{s,VIS})$" src="form_1119.png"/></td></tr>
    <tr><td class="paramname">alirsn</td><td>Near-IR albedo of snow pack on bare ground <img class="formulaInl" alt="$[ ] (alpha_{s,NIR})$" src="form_1120.png"/></td></tr>
    <tr><td class="paramname">alvssc</td><td>Visible albedo of snow on ground under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">alirsc</td><td>Near-IR albedo of snow on ground under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">trsnowc</td><td>Transmissivity of snow under vegetation to shortwave radiation <img class="formulaInl" alt="$[ ] (\tau_{s,c})$" src="form_1121.png"/></td></tr>
    <tr><td class="paramname">alsno</td><td>Albedo of snow in each modelled wavelength band [ ]</td></tr>
    <tr><td class="paramname">trsnowg</td><td>Transmissivity of snow in bare areas to shortwave radiation <img class="formulaInl" alt="$[ ] (\tau_{s,g})$" src="form_1122.png"/></td></tr>
    <tr><td class="paramname">alvsg</td><td>Near-IR albedo f bare ground [ ]</td></tr>
    <tr><td class="paramname">alirg</td><td>Visible albedo of bare ground [ ]</td></tr>
    <tr><td class="paramname">fsdb</td><td>Direct solar radiation in each modelled wavelength band <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">fsfb</td><td>Diffuse solar radiation in each modelled wavelength band <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">albsno</td><td>All-wave albedo of snow pack <img class="formulaInl" alt="$[ ] (\alpha_{s,T})$" src="form_1123.png"/></td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow <img class="formulaInl" alt="$[m] (z_s)$" src="form_247.png"/></td></tr>
    <tr><td class="paramname">fsnow</td><td>Fractional coverage of snow on grid cell [ ]</td></tr>
    <tr><td class="paramname">asvdat</td><td>Assigned value of visible albedo of snow pack – optional [ ]</td></tr>
    <tr><td class="paramname">asidat</td><td>Assigned value of near-IR albedo of snow pack – optional [ ]</td></tr>
    <tr><td class="paramname">refsn</td><td>Snow grain size [m]</td></tr>
    <tr><td class="paramname">bcsn</td><td>Black carbon mixing ratio <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">csz</td><td>Cosine of solar zenith angle [ ]</td></tr>
    <tr><td class="paramname">sno</td><td>Mass of snow pack <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow pack <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>In subroutine SNOALBW, called at the end of CLASSW, the change of total snow albedo over the current time step is calculated using an empirical exponential decay function, which has different coefficients depending on whether the snow is dry or melting. In this subroutine, if the ISNOALB switch is set to 0, the visible and near-IR components of the snow albedo are diagnosed from the total albedo. According to the literature (Aguado, 1985 <a class="el" href="citelist.html#CITEREF_Aguado1985-fv">[2]</a> ; Robinson and Kukla, 1984; Dirmhirn and Eaton, 1975 <a class="el" href="citelist.html#CITEREF_Dirmhirn1975-vx">[33]</a>), the following represent typical snow albedos for fresh snow, old dry snow and melting snow:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular} { | l | c | c | c | } \hline &amp; Total albedo &amp; Visible albedo &amp; Near-IR albedo \\ \hline Fresh snow &amp; 0.84 &amp; 0.95 &amp; 0.73 \\ \hline Old dry snow &amp; 0.70 &amp; 0.84 &amp; 0.56 \\ \hline Melting snow &amp; 0.50 &amp; 0.62 &amp; 0.38 \\ \hline \end{tabular} \]" src="form_1124.png"/>
</p>
<p>The same decay function is assumed to apply to all three albedo ranges, so the relative location of the visible and near-IR albedos, <img class="formulaInl" alt="$\alpha_{s,VIS}$" src="form_1125.png"/> and <img class="formulaInl" alt="$\alpha_{s,NIR}$" src="form_1126.png"/>, on the decay curve will be analogous to that of the total albedo, <img class="formulaInl" alt="$\alpha_{s,T}$" src="form_1127.png"/>. Thus, for dry snow:</p>
<p><img class="formulaInl" alt="$[\alpha_{s,VIS} - 0.84]/[0.95-0.84] = [\alpha_{s,T} - 0.70]/[0.84-0.70]$" src="form_1128.png"/> <img class="formulaInl" alt="$[\alpha_{s,NIR} - 0.56]/[0.73-0.56] = [\alpha_{s,T} - 0.70]/[0.84-0.70]$" src="form_1129.png"/></p>
<p>or, simplifying:</p>
<p><img class="formulaInl" alt="$\alpha_{s,VIS} = 0.7857 \alpha_{s,T} + 0.2900$" src="form_1130.png"/> <img class="formulaInl" alt="$\alpha_{s,NIR} = 1.2142 \alpha_{s,T} - 0.2900$" src="form_1131.png"/></p>
<p>For melting snow:</p>
<p>[ <img class="formulaInl" alt="$\alpha_{s,VIS} - 0.62]/[0.95-0.62] = [\alpha_{s,T} - 0.50]/[0.84-0.50]$" src="form_1132.png"/> [ <img class="formulaInl" alt="$\alpha_{s,NIR} - 0.38]/[0.73-0.38] = [\alpha_{s,T} - 0.50]/[0.84-0.50]$" src="form_1133.png"/></p>
<p>or, simplifying:</p>
<p><img class="formulaInl" alt="$\alpha_{s,VIS} = 0.9706 \alpha_{s,T} + 0.1347$" src="form_1134.png"/> <img class="formulaInl" alt="$\alpha_{s,NIR} = 1.0294 \alpha_{s,T} - 0.1347$" src="form_1135.png"/></p>
<p>The above calculations are performed if the flag IALS is set to zero. If IALS is set to one, indicating that assigned snow albedos are to be used instead of calculated values, <img class="formulaInl" alt="$\alpha_{s,VIS}$" src="form_1125.png"/> and <img class="formulaInl" alt="$\alpha_{s,NIR}$" src="form_1126.png"/> are set to the assigned values ASVDAT and ASIDAT respectively. The sub-canopy values of visible and near-IR albedo are currently set equal to the open snowpack values (this is expected to change if a canopy litterfall parametrization is developed).</p>
<p>The transmissivity of snow under vegetation <img class="formulaInl" alt="$\tau_{s,c}$" src="form_1136.png"/> is then calculated from the snow depth ZSNOW using Beer’s law, with an empirical extinction coefficient of <img class="formulaInl" alt="$25.0 m^{-1}$" src="form_1137.png"/> derived from the literature (Grenfell and Maykut, 1977 <a class="el" href="citelist.html#CITEREF_Grenfell1977-pi">[41]</a> ; Thomas, 1963):</p>
<p><img class="formulaInl" alt="$\tau_{s,c} = exp[-25.0 z_s]$" src="form_1138.png"/></p>
<p>If the ISNOALB switch is set to zero, the value of ALSNO in the first wavelength band is set to the previously calculated value of <img class="formulaInl" alt="$\alpha_{s,VIS}$" src="form_1125.png"/> and the values for the remaining bands are set to the previously calculated value of <img class="formulaInl" alt="$\alpha_{s,NIR}$" src="form_1126.png"/>; the value of <img class="formulaInl" alt="$\tau_{s,g}$" src="form_1139.png"/> is set to <img class="formulaInl" alt="$\tau_{s,c}$" src="form_1136.png"/>. If the ISNOALB switch is set to 1, a new parameterization for the snow albedo and transmissivity in four shortwave radiation bands (one visible and three near-IR) is used, according to Cole et al. (2017). This parameterization incorporates the effects of snow grain size and black carbon content, and makes use of lookup tables contained in the CCCma subroutines SNOW_ALBVAL and SNOW_TRANVAL.</p>
<p>Convert the units of the snow grain size and BC mixing ratio Snow grain size from meters to microns and BC from <img class="formulaInl" alt="$kg BC/m^3$" src="form_1140.png"/> to ng BC/kg SNOW</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="SNOALBA_8f.html">SNOALBA.f</a></li>
    <li class="footer">Generated on Fri Jan 25 2019 10:41:41 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
