<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/CLASSW.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('CLASSW_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSW.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calls subroutines to perform surface water budget calculations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aac1827011ed2ca61bd0274e83d1f80ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSW_8f.html#aac1827011ed2ca61bd0274e83d1f80ad">classw</a> (THLIQ, THICE, TBAR, TCAN, RCAN, SNCAN, RUNOFF, TRUNOF, SNO, TSNOW, RHOSNO, ALBSNO, WSNOW, ZPOND, TPOND, GROWTH, TBASE, GFLUX, PCFC, PCLC, PCPN, PCPG, QFCF, QFCL, QFN, QFG, QFC, HMFC, HMFG, HMFN, HTCC, HTCS, HTC, ROFC, ROFN, ROVG, WTRS, WTRG, OVRFLW, SUBFLW, BASFLW, TOVRFL, TSUBFL, TBASFL, EVAP, QFLUX, RHOAIR, TBARC, TBARG, TBARCS, TBARGS, THLIQC, THLIQG, THICEC, THICEG, HCPC, HCPG, RPCP, TRPCP, SPCP, TSPCP, PCPR, TA, RHOSNI, GGEO, FC, FG, FCS, FGS, TPONDC, TPONDG, TPNDCS, TPNDGS, EVAPC, EVAPCG, EVAPG, EVAPCS, EVPCSG, EVAPGS, QFREZC, QFREZG, QMELTC, QMELTG, RAICAN, SNOCAN, RAICNS, SNOCNS, FSVF, FSVFS, CWLCAP, CWFCAP, CWLCPS, CWFCPS, TCANO, TCANS, CHCAP, CHCAPS, CMASSC, CMASCS, ZSNOW, GZEROC, GZEROG, GZROCS, GZROGS, G12C, G12G, G12CS, G12GS, G23C, G23G, G23CS, G23GS, TSNOCS, TSNOGS, WSNOCS, WSNOGS, RHOSCS, RHOSGS, ZPLIMC, ZPLIMG, ZPLMCS, ZPLMGS, TSFSAV, TCTOPC, TCBOTC, TCTOPG, TCBOTG, FROOT, FROOTS, THPOR, THLRET, THLMIN, BI, PSISAT, GRKSAT, THLRAT, THFC, XDRAIN, HCPS, DELZ, DELZW, ZBOTW, XSLOPE, GRKFAC, WFSURF, WFCINT, ISAND, IGDR, IWF, ILG, IL1, IL2, N, JL, IC, IG, IGP1, IGP2, NLANDCS, NLANDGS, NLANDC, NLANDG, NLANDI)</td></tr>
<tr class="separator:aac1827011ed2ca61bd0274e83d1f80ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calls subroutines to perform surface water budget calculations. </p>
<dl class="section author"><dt>Author</dt><dd>D. Verseghy, P. Bartlett, M. Lazare </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aac1827011ed2ca61bd0274e83d1f80ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1827011ed2ca61bd0274e83d1f80ad">&#9670;&nbsp;</a></span>classw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classw </td>
          <td>(</td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>SNCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RUNOFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRUNOF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALBSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GROWTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TBASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>GFLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>QFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>HMFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROVG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>OVRFLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SUBFLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>BASFLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TOVRFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TSUBFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TBASFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>EVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>QFLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>RHOAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THICEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THICEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TRPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>SPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>GGEO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPONDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPONDG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPNDCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPNDGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>EVAPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>EVAPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVPCSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QFREZC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QFREZG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QMELTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QMELTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSVF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSVFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TCANO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TCANS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>CHCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CHCAPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZEROC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZEROG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZROCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZROGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>G12C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>G12G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>G12CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>G12GS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>G23C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>G23G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>G23CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>G23GS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TSNOGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WSNOGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,4)&#160;</td>
          <td class="paramname"><em>TSFSAV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCTOPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCBOTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCTOPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCBOTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>GRKSAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLRAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>XDRAIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>XSLOPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GRKFAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WFSURF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WFCINT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>IGDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IWF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IGP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IGP2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NLANDCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NLANDGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NLANDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NLANDG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NLANDI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iwf</td><td>Flag governing lateral soil water flow calculations</td></tr>
    <tr><td class="paramname">nlandcs</td><td>Number of modelled areas that contain subareas of canopy over snow</td></tr>
    <tr><td class="paramname">nlandgs</td><td>Number of modelled areas that contain subareas of snow</td></tr>
    <tr><td class="paramname">nlandc</td><td>Number of modelled areas that contain subareas of canopy over bare ground</td></tr>
    <tr><td class="paramname">nlandg</td><td>Number of modelled areas that contain subareas of bare ground</td></tr>
    <tr><td class="paramname">nlandi</td><td>Number of modelled areas that are ice sheets [ ]</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thice</td><td>Volumetric frozen water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">tbar</td><td>Temperature of soil layers [K]</td></tr>
    <tr><td class="paramname">gflux</td><td>Heat flux at interfaces between soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">tcan</td><td>Vegetation canopy temperature [K]</td></tr>
    <tr><td class="paramname">rcan</td><td>Intercepted liquid water stored on canopy <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">sncan</td><td>Intercepted frozen water stored on canopy <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">runoff</td><td>Total runoff from soil <img class="formulaInl" alt="$[m or kg m^{-2} s^{-1}]$" src="form_360.png"/></td></tr>
    <tr><td class="paramname">sno</td><td>Mass of snow pack <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">tsnow</td><td>Snowpack temperature [K]</td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">albsno</td><td>Snow albedo [ ]</td></tr>
    <tr><td class="paramname">zpond</td><td>Depth of ponded water on surface [m]</td></tr>
    <tr><td class="paramname">tpond</td><td>Temperature of ponded water [K]</td></tr>
    <tr><td class="paramname">growth</td><td>Vegetation growth index [ ]</td></tr>
    <tr><td class="paramname">tbase</td><td>Temperature of bedrock in third soil layer [K]</td></tr>
    <tr><td class="paramname">trunof</td><td>Temperature of total runoff [K]</td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">pcfc</td><td>Frozen precipitation intercepted by vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">pclc</td><td>Liquid precipitation intercepted by vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">pcpn</td><td>Precipitation incident on snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">pcpg</td><td>Precipitation incident on ground <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qfcf</td><td>Sublimation from frozen water on vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qfcl</td><td>Evaporation from liquid water on vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qfn</td><td>Sublimation from snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qfg</td><td>Evaporation from ground <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">hmfc</td><td>Diagnosed energy associated with phase change of water on vegetation <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">hmfn</td><td>Diagnosed energy associated with phase change of water in snow pack <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">htcc</td><td>Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">htcs</td><td>Diagnosed internal energy change of snow pack due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">rofc</td><td>Liquid/frozen water runoff from vegetation <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">rofn</td><td>Liquid water runoff from snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">rovg</td><td>Liquid/frozen water runoff from vegetation to ground surface <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">wtrs</td><td>Diagnosed residual water transferred into or out of the snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">wtrg</td><td>Diagnosed residual water transferred into or out of the soil <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">ovrflw</td><td>Overland flow from top of soil column</td></tr>
    <tr><td class="paramname">subflw</td><td>Interflow from sides of soil column <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">basflw</td><td>Base flow from bottom of soil column <img class="formulaInl" alt="$[m or kg m^{-2} s^{-1}]$" src="form_360.png"/></td></tr>
    <tr><td class="paramname">tovrfl</td><td>Temperature of overland flow from top of soil column [K]</td></tr>
    <tr><td class="paramname">tsubfl</td><td>Temperature of interflow from sides of soil column [K]</td></tr>
    <tr><td class="paramname">tbasfl</td><td>Temperature of base flow from bottom of soil column [K]</td></tr>
    <tr><td class="paramname">evap</td><td>Diagnosed total surface water vapour flux over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qflux</td><td>Product of surface drag coefficient, wind speed and surface-air specific humidity difference <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">rhoair</td><td>Density of air <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">qfc</td><td>Water removed from soil layers by transpiration <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">hmfg</td><td>Diagnosed energy associated with phase change of water in soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">htc</td><td>Diagnosed internal energy change of soil layer due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">rpcp</td><td>Rainfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">trpcp</td><td>Rainfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">spcp</td><td>Snowfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">tspcp</td><td>Snowfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">pcpr</td><td>Surface precipitation rate <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height [K]</td></tr>
    <tr><td class="paramname">tbarc</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbarg</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbarcs</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbargs</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">thliqc</td><td>Liquid water content of soil layers under vegetation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thliqg</td><td>Liquid water content of soil layers in bare areas <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thicec</td><td>Frozen water content of soil layers under vegetation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thiceg</td><td>Frozen water content of soil layers in bare areas <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">hcpc</td><td>Heat capacity of soil layers under vegetation <img class="formulaInl" alt="$[J m^{-3} K^{-1}]$" src="form_361.png"/></td></tr>
    <tr><td class="paramname">hcpg</td><td>Heat capacity of soil layers in bare areas <img class="formulaInl" alt="$[J m^{-3} K^{-1}]$" src="form_361.png"/></td></tr>
    <tr><td class="paramname">tctopc</td><td>Thermal conductivity of soil at top of layer (vegetation over ground) <img class="formulaInl" alt="$[W m^{-1} K^{-1}]$" src="form_280.png"/></td></tr>
    <tr><td class="paramname">tcbotc</td><td>Thermal conductivity of soil at bottom of layer (vegetation over ground) <img class="formulaInl" alt="$[W m^{-1} K^{-1}]$" src="form_280.png"/></td></tr>
    <tr><td class="paramname">tctopg</td><td>Thermal conductivity of soil at top of layer (bare ground) <img class="formulaInl" alt="$[W m^{-1} K^{-1}]$" src="form_280.png"/></td></tr>
    <tr><td class="paramname">tcbotg</td><td>Thermal conductivity of soil at bottom of layer (bare ground) <img class="formulaInl" alt="$[W m^{-1} K^{-1}]$" src="form_280.png"/></td></tr>
    <tr><td class="paramname">froot</td><td>Fraction of total transpiration contributed by soil layer over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">froots</td><td>Fraction of total transpiration contributed by soil layer over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">tsfsav</td><td>Ground surface temperature over subarea [K]</td></tr>
    <tr><td class="paramname">fc</td><td>Subarea fractional coverage of modelled area [ ]</td></tr>
    <tr><td class="paramname">fg</td><td>Subarea fractional coverage of modelled area [ ]</td></tr>
    <tr><td class="paramname">fcs</td><td>Subarea fractional coverage of modelled area [ ]</td></tr>
    <tr><td class="paramname">fgs</td><td>Subarea fractional coverage of modelled area [ ]</td></tr>
    <tr><td class="paramname">tpondc</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpondg</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpndcs</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpndgs</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">evapc</td><td>Evaporation from vegetation over ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapcg</td><td>Evaporation from ground under vegetation <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapg</td><td>Evaporation from bare ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapcs</td><td>Evaporation from vegetation over snow <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evpcsg</td><td>Evaporation from snow under vegetation <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapgs</td><td>Evaporation from snow on bare ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">qfrezc</td><td>Heat sink to be used for freezing water on ground under canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">qfrezg</td><td>Heat sink to be used for freezing water on bare ground <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">qmeltc</td><td>Heat to be used for melting snow under canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">qmeltg</td><td>Heat to be used for melting snow on bare ground <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">raican</td><td>Intercepted liquid water stored on canopy over ground <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">snocan</td><td>Intercepted frozen water stored on canopy over ground <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">raicns</td><td>Intercepted liquid water stored on canopy over snow <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">snocns</td><td>Intercepted frozen water stored on canopy over snow <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">fsvf</td><td>Sky view factor of ground under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">fsvfs</td><td>Sky view factor of snow under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">cwlcap</td><td>Storage capacity of canopy over bare ground for liquid water <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">cwfcap</td><td>Storage capacity of canopy over bare ground for frozen water <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">cwlcps</td><td>Storage capacity of canopy over snow for liquid water <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">cwfcps</td><td>Storage capacity of canopy over snow for frozen water <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">tcano</td><td>Temperature of canopy over ground [K]</td></tr>
    <tr><td class="paramname">tcans</td><td>Temperature of canopy over snow [K]</td></tr>
    <tr><td class="paramname">chcap</td><td>Heat capacity of canopy over bare ground <img class="formulaInl" alt="$[J m^{-2} K^{-1}] $" src="form_362.png"/></td></tr>
    <tr><td class="paramname">chcaps</td><td>Heat capacity of canopy over snow <img class="formulaInl" alt="$[J m^{-2} K^{-1}] $" src="form_362.png"/></td></tr>
    <tr><td class="paramname">cmassc</td><td>Mass of canopy over bare ground <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">cmascs</td><td>Mass of canopy over snow <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack [m]</td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">gzeroc</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">gzerog</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">gzrocs</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">gzrogs</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g12c</td><td>Subarea heat flux between first and second soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g12g</td><td>Subarea heat flux between first and second soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g12cs</td><td>Subarea heat flux between first and second soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g12gs</td><td>Subarea heat flux between first and second soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g23c</td><td>Subarea heat flux between second and third soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g23g</td><td>Subarea heat flux between second and third soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g23cs</td><td>Subarea heat flux between second and third soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">g23gs</td><td>Subarea heat flux between second and third soil layers <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">tsnocs</td><td>Temperature of snow pack under vegetation [K]</td></tr>
    <tr><td class="paramname">tsnogs</td><td>Temperature of snow pack in bare areas [K]</td></tr>
    <tr><td class="paramname">wsnocs</td><td>Liquid water content of snow pack under vegetation <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">wsnogs</td><td>Liquid water content of snow pack in bare areas <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">rhoscs</td><td>Density of snow under vegetation <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">rhosgs</td><td>Density of snow in bare areas <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">zplimc</td><td>Subarea maximum ponding depth [m]</td></tr>
    <tr><td class="paramname">zplimg</td><td>Subarea maximum ponding depth [m]</td></tr>
    <tr><td class="paramname">zplmcs</td><td>Subarea maximum ponding depth [m]</td></tr>
    <tr><td class="paramname">zplmgs</td><td>Subarea maximum ponding depth [m]</td></tr>
    <tr><td class="paramname">ggeo</td><td>Geothermal heat flux at bottom of soil profile <img class="formulaInl" alt="$[W m^{-2}]$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thlret</td><td>Liquid water retention capacity for organic soil [m3 m-3 ]</td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical "b" parameter [ ]</td></tr>
    <tr><td class="paramname">grksat</td><td>Saturated hydraulic conductivity of soil layer <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation [m]</td></tr>
    <tr><td class="paramname">thlrat</td><td>Fractional saturation of soil behind the wetting front [ ]</td></tr>
    <tr><td class="paramname">thfc</td><td>Field capacity <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">hcps</td><td>Heat capacity of soil material <img class="formulaInl" alt="$[J m^{-3} K^{-1}]$" src="form_361.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Overall thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth to permeable bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">xdrain</td><td>Drainage index at bottom of soil profile [ ]</td></tr>
    <tr><td class="paramname">xslope</td><td>Surface slope (used when running MESH code) [degrees]</td></tr>
    <tr><td class="paramname">grkfac</td><td>WATROF parameter used when running MESH code [ ]</td></tr>
    <tr><td class="paramname">wfsurf</td><td>WATROF parameter used when running MESH code [ ]</td></tr>
    <tr><td class="paramname">wfcint</td><td>WATROF parameter used when running MESH code [ ]</td></tr>
    <tr><td class="paramname">delz</td><td>Overall thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">igdr</td><td>Index of soil layer in which bedrock is encountered </td></tr>
  </table>
  </dd>
</dl>
<p>First, subroutine WPREP is called to initialize various arrays and produce parameters for the four subareas of canopy over snow (CS), snow on ground (GS), canopy over ground (C) and bare ground (G). Then, for each of the four subareas, if the number of modelled areas containing that subarea is greater than zero, a series of subroutines is called. The subroutines associated with each subarea are listed in the table below.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular} { | l | l | c | } \hline CANVAP &amp; Evaporation/sublimation of water from vegetation canopy &amp; CS,C \\ \hline CANADD &amp; Addition of rainfall/snowfall to canopy; throughfall and drip &amp; CS,C \\ \hline CWCALC &amp; Freezing/thawing of liquid/frozen water on canopy &amp; CS,C \\ \hline SUBCAN &amp; Precipitaiton and condensation under canopy &amp; CS,C \\ \hline TWCALC &amp; Freezing/thawing of liquid/frozen water in soil &amp; CS,GS,C,G \\ \hline SNOVAP &amp; Sublimaiton from snow pack &amp; CS,GS,C,G \\ \hline TFREEZ &amp; Freezing of ponded water on soil &amp; CS,GS,C,G \\ \hline TMELT &amp; Melting of snow pack &amp; CS,GS \\ \hline SNOADD &amp; Accumulation of snow on ground &amp; CS,GS,C,G \\ \hline SNINFL &amp; Infiltration of rain into snow pack &amp; CS,GS \\ \hline ICEBAL &amp; Energy and water budget of ice sheets &amp; GS,G \\ \hline GRINFL &amp; Infiltraiton of water into soil &amp; CS,GS,C,G \\ \hline GRDRAN &amp; Soil water movement in response to gravity and suction forces &amp; CS,GS,C,G \\ \hline TMCALC &amp; Step ahead soil layer temperatures, check for freezing/thawing &amp; CS,GS,C,G \\ \hline CHKWAT &amp; Check subarea moisture balances for closure &amp; CS,GS,C,G \\ \hline SNOALBW &amp; Temporal variation of snow albedo and density &amp; CS,GS \\ \hline \end{tabular} \]" src="form_363.png"/>
</p>
<p>After these calls have been done, average values of the main prognostic variables over the modelled area are determined by performing weighted averages over the four subareas, and checks are carried out to identify and remove vanishingly small values. First the bedrock temperature in the third soil layer, the total runoff and the runoff temperature are calculated. Then the total runoff and the overland flow, interflow and baseflow are converted from units of m to <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_38.png"/>. The total surface water vapour flux over the modelled area is updated to account for the residual amounts of evaporative demand over the four subareas that could not be supplied by surface stores (WLSTCS, WLSTGS, WLOSTC and WLOSTG, variables that are defined internally in this subroutine), and the diagnostic variable QFLUX is evaluated.</p>
<p>The temperature of the vegetation canopy TCAN and the amount of intercepted liquid water RCAN are calculated as weighted averages over the two canopy subareas. A flag is set to trigger a call to abort if TCAN is less than -100 C or greater than 100 C. If RCAN is vanishingly small, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic arrays ROFC, ROVG, PCPG and HTCC are updated, and RCAN is set to zero. The amount of intercepted snow SNCAN is likewise calculated as a weighted average over the two canopy subareas. If SNCAN is vanishingly small, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic arrays ROFC, ROVG, PCPG and HTCC are updated, and SNCAN is set to zero. If there is no canopy present, TCAN is set to zero.</p>
<p>At the end of the 600 loop, the depth of ponded water ZPOND and its temperature TPOND over the modelled area are calculated as weighted averages over the four subareas. If ZPOND is vanishingly small, then as in the case of intercepted water, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic array HTC is updated, ZPOND is set to zero and TPOND is set to 0 <img class="formulaInl" alt="$^o$" src="form_364.png"/>C.</p>
<p>In the 650 loop, values of the snow prognostic variables are calculated as weighted averages over the four subareas. The weightings for the subareas include the four internally-defined CLASSW variables XSNOCS, XSNOGS, XSNOWC and XSNOWG, which are set in subroutine CHKWAT to 1 if the subarea snow depth is greater than zero, and to zero otherwise. If the snow depth over the CS and GS subareas is greater than zero (meaning that there was a pre-existing snow cover at the beginning of the time step), the average snow albedo ALBSNO is preferentially set to the average over these two subareas. Otherwise ALBSNO is set to the average over the C and G subareas (where snow has just been added in the current time step). The snow temperature TSNOW and density RHOSNO are set to weighted averages over the four subareas, using the internally-defined subarea volumetric heat capacities HCPSCS/GS/C/G and RHOSCS/GS/C/G. Finally the snow depth ZSNOW is calculated from the subarea depths; the liquid water content of the snow pack WSNOW is obtained as a weighted average over the CS and GS subareas (assuming that freshly fallen snow does not yet contain liquid water); and the snow mass is determined from ZSNOW and RHOSNO. Upper and lower limits apply to the snow pack. If the snow depth exceeds 10 m, the excess snow and its associated liquid water content are added to the overland flow and the total runoff, the respective temperatures of the latter are recalculated and the diagnostic arrays ROFN, PCPG and HTCS are updated. As in the case of intercepted and ponded water, if the snow mass is vanishingly small it and its liquid water content are added to the overland flow and to the total runoff, and their respective temperatures are recalculated, the diagnostic arrays ROFN, PCPG and HTCS are updated, and TSNOW, RHOSNO, SNO and WSNOW are set to zero. Flags are set to trigger calls to abort if TSNOW is less than 0 K or greater than 0.001 C. Finally, the three abort flags set thus far are checked, and calls to abort are performed if they are greater than zero.</p>
<p>In the 700 loop, the temperature of each soil layer is calculated as a weighted average over the four subareas. In the case of the third soil layer., if the standard three-layer configuration is being modelled (with a very thick third soil layer of 3.75 m), the subarea layer temperatures TBARCS/GS/C/G and the layer heat capacities HCPCS/GS/C/G apply to the permeable depth DELZW of the layer, and the bedrock temperature TBASE and the rock heat capacity HCPSND to the remainder, DELZ-DELZW. The averaging is carried out accordingly. In all other soil layers, the layer temperature applies to the whole thickness, whose heat capacity is a weighted average of HCPCS/GS/C/G over DELZW and HCPSND over DELZ-DELZW. The volumetric liquid water content THLIQ, the volumetric frozen water content THICE, and the heat flux at the soil layer interfaces GFLUX are calculated as simple weighted averages over the subareas. A flag is set to trigger a call to abort if the soil layer temperature is less than -100 C or greater than 100 C, and after the end of the loop, a call to abort is performed if the flag is greater than zero.</p>
<p>Finally, subroutine CGROW is called to update the vegetation growth index.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="CLASSW_8f.html">CLASSW.f</a></li>
    <li class="footer">Generated on Tue Apr 9 2019 08:59:52 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
