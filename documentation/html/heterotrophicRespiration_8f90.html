<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/heterotrophicRespiration.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('heterotrophicRespiration_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">heterotrophicRespiration.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Central module for all heterotrophic respiration-related operations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:acda778ec663493c0960bbfb419001741"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heterotrophicRespiration_8f90.html#acda778ec663493c0960bbfb419001741">heterotrophic_respiration::hetresg</a> (litrmass, soilcmas, delzw, thpor, il1, il2, ilg, tbar, psisat, b, thliq, thice, frac, isand, litres, socres)</td></tr>
<tr class="memdesc:acda778ec663493c0960bbfb419001741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Heterotrophic respiration subroutine for bare ground fraction.  <a href="heterotrophicRespiration_8f90.html#acda778ec663493c0960bbfb419001741">More...</a><br /></td></tr>
<tr class="separator:acda778ec663493c0960bbfb419001741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ad32e36d597aea9e00671448d26095c34"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heterotrophicRespiration_8f90.html#ad32e36d597aea9e00671448d26095c34">heterotrophic_respiration::hetresv</a> (fcan, fct, litrmass, soilcmas, delzw, thpor, il1, il2, ilg, tbar, psisat, thliq, sort, b, isand, thice, ipeatland, ltresveg, scresveg)</td></tr>
<tr class="memdesc:ad32e36d597aea9e00671448d26095c34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Heterotrophic Respiration Subroutine For Vegetated Fraction.  <a href="heterotrophicRespiration_8f90.html#ad32e36d597aea9e00671448d26095c34">More...</a><br /></td></tr>
<tr class="separator:ad32e36d597aea9e00671448d26095c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Central module for all heterotrophic respiration-related operations. </p>
<p>Heterotrophic Respiration Module (Vegetated and Bare Ground)</p>
<p>Central module for all heterotrophic respiration-related operations</p>
<p>Heterotrophic respiration, <img class="formulaInl" alt="$R_\mathrm{h}$" src="form_765.png"/> ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_766.png"/>), in CTEM is based on respiration from the litter (which includes contributions from the stem, leaf and root components), <img class="formulaInl" alt="$R_{h,D}$" src="form_767.png"/>, and soil carbon, <img class="formulaInl" alt="$R_{h,H}$" src="form_768.png"/>, pools,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{hetres_all} R_\mathrm{h}=R_{h,D}+R_{h,H}. \hspace{10pt}[Eqn 1] \]" src="form_1673.png"/>
</p>
<p>Heterotrophic respiration is regulated by soil temperature and moisture and is calculated on a daily time step. The original heterotrophic respiration scheme is described in Arora (2003) <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a> while the modified parametrization used in CTEM v. 2.0 is detailed in Melton and Arora (2014) <a class="el" href="citelist.html#CITEREF_Melton2014-xy">[60]</a>. Respiration from the litter and soil carbon pools takes the following basic form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_{\mathrm{h},i} = 2.64 \times 10^{-6}\,\varsigma_i C_i f_{15}(Q_{10}) f(\Psi)_i f(z), \nonumber \\ i = \mathrm{D}, \mathrm{H}. \hspace{10pt}[Eqn 2] \]" src="form_1674.png"/>
</p>
<p>The soil carbon and litter respiration depends on the amount of carbon in these components ( <img class="formulaInl" alt="$C_\mathrm{H}$" src="form_529.png"/> and <img class="formulaInl" alt="$C_\mathrm{D}$" src="form_528.png"/>; <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_492.png"/>) and on a PFT-dependent respiration rate specified at <img class="formulaInl" alt="$15\,{C}$" src="form_771.png"/> ( <img class="formulaInl" alt="$\varsigma_\mathrm{H}$" src="form_772.png"/> and <img class="formulaInl" alt="$\varsigma_\mathrm{D}$" src="form_773.png"/>; <img class="formulaInl" alt="$kg\,C\,(kg\,C)^{-1}\,yr^{-1}$" src="form_774.png"/>; see also <a class="el" href="classic__params_8f90.html" title="This module holds CLASSIC globally accessible parameters. ">classic_params.f90</a>). The constant <img class="formulaInl" alt="$2.64 \times 10^{-6}$" src="form_775.png"/> converts units from <img class="formulaInl" alt="$kg\,C\,m^{-2}\,yr^{-1}$" src="form_776.png"/> to <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_766.png"/>.</p>
<p>The effect of soil moisture is accounted for via dependence on soil matric potential ( <img class="formulaInl" alt="$f(\Psi)$" src="form_777.png"/>), described later. The temperature dependency of microbial soil respiration rates has been estimated by several different formulations, ranging from simple <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> (exponential) to Arrhenius-type formulations (see review by Lloyd and Taylor (1994) <a class="el" href="citelist.html#CITEREF_Lloyd1994-ct">[56]</a>). In CTEM, soil temperature influences heterotrophic respiration through a temperature-dependent <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> function ( <img class="formulaInl" alt="$f_{15}(Q_{10})$" src="form_779.png"/>). The value of <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> itself is assumed to be a function of temperature following a hyperbolic tan function:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q_{10} = 1.44 + 0.56\,\tanh[0.075 (46.0 - T_i)], \nonumber\\ i = \mathrm{D}, \mathrm{H}, \hspace{10pt}[Eqn 3]\]" src="form_1675.png"/>
</p>
<p>where <img class="formulaInl" alt="$T_{\{D,H\}}$" src="form_781.png"/> is the temperature of either the litter or soil carbon pool ( <img class="formulaInl" alt="$C$" src="form_782.png"/>), respectively. The parametrization is a compromise between the temperature-independent <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> commonly found in many terrestrial ecosystem models (Cox, 2011) <a class="el" href="citelist.html#CITEREF_Cox2001-am">[26]</a> and the temperature-dependent <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> of Kirschbaum (1995) <a class="el" href="citelist.html#CITEREF_Kirschbaum1995-db">[42]</a>. While a constant <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> yields an indefinitely increasing respiration rate with increasing temperature, the formulation of Kirschbaum (1995) <a class="el" href="citelist.html#CITEREF_Kirschbaum1995-db">[42]</a> gives a continuously increasing <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> under decreasing temperature, which leads to unreasonably high soil and litter carbon pools at high latitudes in CTEM. The CTEM parametrization avoids these issues with a <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> value of about 2.0 for temperatures less than <img class="formulaInl" alt="$20\,C$" src="form_783.png"/>, while a decreasing value of <img class="formulaInl" alt="$Q_{10}$" src="form_778.png"/> at temperatures above <img class="formulaInl" alt="$20\,C$" src="form_783.png"/> ensures that the respiration rate does not increase indefinitely. As the soil temperature decreases below <img class="formulaInl" alt="$ T_{crit} $" src="form_1676.png"/> (typically <img class="formulaInl" alt="$1\,C$" src="form_1677.png"/>) a step function is applied to the <img class="formulaInl" alt="$f_{15}(Q_{10})$" src="form_779.png"/> function to reflect lost mobility of the microbial populations due to less liquid water as: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_{15}(Q_{10,(T_i &lt; T_{crit})}) = f_{15}(Q_{10}) * 0.1 \]" src="form_1678.png"/>
</p>
<div class="image">
<img src="Q10_response_sm.png" alt="Q10_response_sm.png"/>
</div>
 <p>The soil detrital pools are explictly tracked per soil layer.</p>
<p>The response of heterotrophic respiration to soil moisture is formulated through soil matric potential ( <img class="formulaInl" alt="$\Psi$" src="form_48.png"/>; <img class="formulaInl" alt="$MPa$" src="form_787.png"/>). While soil matric potential values are usually negative, the formulation uses absolute values to allow its logarithm to be taken. Absolute values of soil matric potential are high when soil is dry and low when it is wet. The primary premise of soil moisture control on heterotrophic respiration is that heterotrophic respiration is constrained both when the soils are dry (due to reduced microbial activity) and when they are wet (due to impeded oxygen supply to microbes) with optimum conditions in-between. The exception is the respiration from the litter component of the first soil layer, which is assumed to be continually exposed to air, and thus never oxygen deprived, even when soil moisture content is high ( <img class="formulaInl" alt="$0.04 &gt; \vert \Psi \vert \geq \vert \Psi_{sat} \vert$" src="form_788.png"/>, where <img class="formulaInl" alt="$\Psi_{sat}$" src="form_88.png"/> is the soil matric potential at saturation). The soil moisture dependence for each soil layer thus varies between 0 and 1 with matric potential as follows:</p>
<p>for <img class="formulaInl" alt="$0.04 &gt; \vert\Psi_i\vert \geq \vert\Psi_{sat,i}\vert$" src="form_1679.png"/></p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi_i)_\mathrm{H,(D, i&gt;1)} = 1 - 0.5 \frac{\log(0.04)-\log\vert\Psi_i\vert} {\log(0.04)-\log\vert\Psi_{sat,i}\vert} \hspace{10pt}[Eqn 4]\]" src="form_1680.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[f(\Psi_i)_{D,i=1} = 1\nonumber; \hspace{10pt}[Eqn 5]\]" src="form_1681.png"/>
</p>
<p>for <img class="formulaInl" alt="$0.06 \geq \vert\Psi_i\vert \geq 0.04$" src="form_1682.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi_i)_{D,H} = 1; \hspace{10pt}[Eqn 6]\]" src="form_1683.png"/>
</p>
<p>for <img class="formulaInl" alt="$100.0 \geq \vert\Psi_i\vert &gt; 0.06$" src="form_1684.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi_i)_{D,H} = 1 - 0.8\frac{\log\vert\Psi_i\vert-\log(0.06)}{\log(100)-\log(0.06)}; \hspace{10pt}[Eqn 7]\]" src="form_1685.png"/>
</p>
<p>for <img class="formulaInl" alt="$\vert\Psi_i\vert &gt; 100.0$" src="form_1686.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi_i)_{D,H}=0.2. \hspace{10pt}[Eqn 8]\]" src="form_1687.png"/>
</p>
<p>Respiration also is reduced at depth in soil ( <img class="formulaInl" alt="$f(z)$" src="form_1688.png"/>) following Lawrence et al. (2015) <a class="el" href="citelist.html#CITEREF_Lawrence2015-tj">[51]</a>. This term is meant to represent unresolved depth dependent soil processes (such as oxygen availability, microbial community changes, etc.). The reduction in respiration with depth per soil layer is dependent upon the layer depth and a term, <img class="formulaInl" alt="$z_t$" src="form_1689.png"/>, which is given a value of 10.0 (see ctem_params.f90) as,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(z_i) =\exp (-z_i / z_t) \hspace{10pt}[Eqn 9]\]" src="form_1690.png"/>
</p>
<div class="image">
<img src="decr_resp_wit_depth_sm.png" alt="decr_resp_wit_depth_sm.png"/>
</div>
 <p>Heterotrophic respiration for bare ground is treated separately in CTEM. The carbon contributions to the bare ground litter and soil carbon pools come via processes such as creation of bare ground due to fire, competition between PFTs and land use change. The heterotrophic respiration is sensitive to temperature and moisture in the same manner as vegetated areas using Eqs. (2)&ndash;(8). The base respiration rates of <img class="formulaInl" alt="$\varsigma_{D,bare}$" src="form_797.png"/> and <img class="formulaInl" alt="$\varsigma_{H,bare}$" src="form_798.png"/> are set to <img class="formulaInl" alt="$0.5605$" src="form_799.png"/> and <img class="formulaInl" alt="$0.02258\,kg\,C\,(kg\,C)^{-1}\,yr^{-1}$" src="form_800.png"/>, respectively.</p>
<p>The amount of humidified litter, which is transferred from the litter to the soil carbon pool ( <img class="formulaInl" alt="$C_{\mathrm{D} \rightarrow \mathrm{H}}$" src="form_801.png"/>) is modelled as a fraction of litter respiration ( <img class="formulaInl" alt="$R_{h,D}$" src="form_767.png"/>) as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{cdtoh} C_{\mathrm{D} \rightarrow \mathrm{H}} = \chi\,R_{h,D} \hspace{10pt}[Eqn 10] \]" src="form_1691.png"/>
</p>
<p>where <img class="formulaInl" alt="$\chi$" src="form_29.png"/> (see also ctem_params.f90) is the PFT-dependent humification factor and varies between 0.4 and 0.5. For crops, <img class="formulaInl" alt="$\chi$" src="form_29.png"/> is set to 0.1 to account for reduced transfer of humidified litter to the soil carbon pool which leads to loss in soil carbon when natural vegetation is converted to croplands. Over the bare ground fraction <img class="formulaInl" alt="$\chi$" src="form_29.png"/> is set to 0.45.</p>
<p>With heterotrophic respiration known, net ecosystem productivity ( <img class="formulaInl" alt="$NEP$" src="form_803.png"/>) is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ NEP = G_{canopy} - R_\mathrm{m} - R_\mathrm{g} - R_\mathrm{h}. \hspace{10pt}[Eqn 11]\]" src="form_1692.png"/>
</p>
 </div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="file_acda778ec663493c0960bbfb419001741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_acda778ec663493c0960bbfb419001741">&#9670;&nbsp;</a></span>hetresg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public heterotrophic_respiration::hetresg </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>soilcmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>delzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>thpor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>psisat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>thice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>isand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(out)&#160;</td>
          <td class="paramname"><em>litres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(out)&#160;</td>
          <td class="paramname"><em>socres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Heterotrophic respiration subroutine for bare ground fraction. </p>
<dl class="section author"><dt>Author</dt><dd>Vivek Arora and Joe Melton</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">litrmass</td><td>litter mass for the 8 pfts + bare in <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">soilcmas</td><td>soil carbon mass for the 8 pfts + bare in <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbar</td><td>soil temperature, k</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thliq</td><td>liquid soil moisture content in 3 soil layers</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frac</td><td>fraction of bare ground (fg)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psisat</td><td>saturation matric potential</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>parameter b of clapp and hornberger</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thpor</td><td>porosity</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">litres</td><td>litter respiration over the given unvegetated sub-area in umol co2/m2.s</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">socres</td><td>soil c respiration over the given unvegetated sub-area in umol co2/m2.s </td></tr>
  </table>
  </dd>
</dl>
<p>Find moisture scalar for soil c decomposition this is modelled as function of logarithm of matric potential. we find values for all soil layers, and then find an average value based on fraction of carbon present in each layer.</p>
<p>Find moisture scalar for litter decomposition for top soil layer The difference between moisture scalar for litter and soil c is that the litter decomposition is not constrained by high soil moisture (assuming that litter is always exposed to air). In addition, we use moisture content of the top soil layer as a surrogate for litter moisture content. So we use only psi(i,1) calculated in loops 260 and 270 above.</p>
<p>Treat the lower litter layers like the soil C ones:</p>
<p>Use temperature of the litter and soil c pools, and their soil moisture scalars to find respiration rates from these pools</p>
<p>Reduce the respiration at depth due to unresolved depth dependent processes including soil microbial population dynamics, pore-scale oxygen availability, mineral sorption, priming effects, and other unrepresented processes. This is following Lawrence et al. Enviro Res Lett 2015 <a class="el" href="citelist.html#CITEREF_Lawrence2015-tj">[51]</a>. We apply this for all soils. </p>

</div>
</div>
<a id="file_ad32e36d597aea9e00671448d26095c34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ad32e36d597aea9e00671448d26095c34">&#9670;&nbsp;</a></span>hetresv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public heterotrophic_respiration::hetresv </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>fcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>fct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>soilcmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>delzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>thpor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>tbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>psisat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc), intent(in)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>isand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>thice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>ipeatland</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd), intent(out)&#160;</td>
          <td class="paramname"><em>ltresveg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd), intent(out)&#160;</td>
          <td class="paramname"><em>scresveg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Heterotrophic Respiration Subroutine For Vegetated Fraction. </p>
<dl class="section author"><dt>Author</dt><dd>Vivek Arora, Joe Melton, Yuanqiao Wu</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ilg</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">litrmass</td><td>litter mass for the 9 pfts + bare [ <img class="formulaInl" alt="$kg C/m^2$" src="form_551.png"/> ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">soilcmas</td><td>soil carbon mass for the 9 pfts + bare [ <img class="formulaInl" alt="$kg C/m^2$" src="form_551.png"/> ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thpor</td><td>Soil total porosity [ <img class="formulaInl" alt="$(cm^3 cm^{-3})$" src="form_531.png"/> ] - daily average</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbar</td><td>Soil temperature [ K ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psisat</td><td>Saturated soil matric potential [ m ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Clapp and Hornberger empirical “b” parameter [ ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thliq</td><td>liquid soil moisture content in soil layers [ <img class="formulaInl" alt="$(cm^3 cm^{-3})$" src="form_531.png"/> ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thice</td><td>frozen soil moisture content in 3 soil layers in canopy covered subarea [ <img class="formulaInl" alt="$(cm^3 cm^{-3})$" src="form_531.png"/> ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fct</td><td>Sum of all fcans [ ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcan</td><td>fractional coverage of ctem's 9 pfts [ ]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isand</td><td>flag for soil/bedrock/ice/glacier</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sort</td><td>index for correspondence between CTEM pfts and all values in the parameters vectors</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delzw</td><td>thickness of the permeable soil layers [ m ]</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ltresveg</td><td>litter respiration for the given vegetated sub-area [ <img class="formulaInl" alt="$u-mol co2/m2.sec$" src="form_555.png"/> ]</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scresveg</td><td>soil carbon respiration for the given vegetated sub-area [ <img class="formulaInl" alt="$u-mol co2/m2.sec$" src="form_555.png"/> ] </td></tr>
  </table>
  </dd>
</dl>
<p>Set the lower levels to have the same moisture sensitivity to soil C. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="heterotrophicRespiration_8f90.html">heterotrophicRespiration.f90</a></li>
    <li class="footer">Generated on Thu Apr 11 2019 11:13:44 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
