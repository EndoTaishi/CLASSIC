<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: src/TPREP.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('TPREP_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">TPREP.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Initialize subarea variables and calculate various parameters for surface energy budget calculations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7e4916d23e9c1a0300f168e58bbf7ae4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TPREP_8f.html#a7e4916d23e9c1a0300f168e58bbf7ae4">tprep</a> (THLIQC, THLIQG, THICEC, THICEG, TBARC, TBARG, TBARCS, TBARGS, HCPC, HCPG, TCTOPC, TCBOTC, TCTOPG, TCBOTG, HCPSCS, HCPSGS, TCSNOW, TSNOCS, TSNOGS, WSNOCS, WSNOGS, RHOSCS, RHOSGS, TCANO, TCANS, CEVAP, IEVAP, TBAR1P, WTABLE, ZERO, EVAPC, EVAPCG, EVAPG, EVAPCS, EVPCSG, EVAPGS, GSNOWC, GSNOWG, GZEROC, GZEROG, GZROCS, GZROGS, QMELTC, QMELTG, EVAP, GSNOW, TPONDC, TPONDG, TPNDCS, TPNDGS, QSENSC, QSENSG, QEVAPC, QEVAPG, TACCO, QACCO, TACCS, QACCS, ILMOX, UEX, HBLX, ILMO, UE, HBL, ST, SU, SV, SQ, SRH, CDH, CDM, QSENS, QEVAP, QLWAVG, FSGV, FSGS, FSGG, FLGV, FLGS, FLGG, HFSC, HFSS, HFSG, HEVC, HEVS, HEVG, HMFC, HMFN, QFCF, QFCL, EVPPOT, ACOND, DRAG, THLIQ, THICE, TBAR, ZPOND, TPOND, THPOR, THLMIN, THLRET, THFC, HCPS, TCS, TA, RHOSNO, TSNOW, ZSNOW, WSNOW, TCAN, FC, FCS, DELZ, DELZW, ZBOTW, ISAND, ILG, IL1, IL2, JL, IG, FVEG, TCSATU, TCSATF, FTEMP, FTEMPX, FVAP, FVAPX, RIB, RIBX)</td></tr>
<tr class="separator:a7e4916d23e9c1a0300f168e58bbf7ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Initialize subarea variables and calculate various parameters for surface energy budget calculations. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a7e4916d23e9c1a0300f168e58bbf7ae4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tprep </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THICEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THICEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCTOPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCBOTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCTOPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>TCBOTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>HCPSCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>HCPSGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TCSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TSNOGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WSNOGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TCANO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TCANS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>CEVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>IEVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TBAR1P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WTABLE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ZERO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>EVAPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>EVAPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVPCSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVAPGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GSNOWC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GSNOWG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZEROC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZEROG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZROCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GZROGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QMELTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QMELTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>EVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPONDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPONDG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPNDCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TPNDGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QSENSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QSENSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QEVAPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QEVAPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TACCO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>QACCO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TACCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>QACCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ILMOX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>UEX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HBLX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ILMO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>UE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>HBL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>ST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>SU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>SV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>SQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SRH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>CDH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>CDM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>QSENS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>QEVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QLWAVG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSGG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FLGG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HFSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HEVG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>QFCL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>EVPPOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ACOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>DRAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ig)&#160;</td>
          <td class="paramname"><em>TCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FVEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TCSATU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TCSATF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FTEMPX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FVAPX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>RIB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RIBX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tbarc</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbarg</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbarcs</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">tbargs</td><td>Subarea temperatures of soil layers [C]</td></tr>
    <tr><td class="paramname">thliqc</td><td>Liquid water content of soil layers under vegetation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thliqg</td><td>Liquid water content of soil layers in bare areas <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thicec</td><td>Frozen water content of soil layers under vegetation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thiceg</td><td>Frozen water content of soil layers in bare areas <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">hcpc</td><td>Heat capacity of soil layers under vegetation <img class="formulaInl" alt="$[J m^{-3} K^{-1}] (C_g)$" src="form_1192.png"/></td></tr>
    <tr><td class="paramname">hcpg</td><td>Heat capacity of soil layers in bare areas <img class="formulaInl" alt="$[J m^{-3} K^{1}] (Cg)$" src="form_1230.png"/></td></tr>
    <tr><td class="paramname">tctopc</td><td>Thermal conductivity of soil at top of layer in canopy-covered subareas <img class="formulaInl" alt="$[W m^{-1} K^{-1}] (\lambda)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">tcbotc</td><td>Thermal conductivity of soil at bottom of layer in canopy-covered subareas <img class="formulaInl" alt="$[W m^{-1} K^{-1}] (\lambda)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">tctopg</td><td>Thermal conductivity of soil at top of layer in bare ground subareas <img class="formulaInl" alt="$[W m^{-1} K^{-1}] (\lambda)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">tcbotg</td><td>Thermal conductivity of soil at bottom of layer in bare ground subareas <img class="formulaInl" alt="$[W m^{-1} K^{-1}] (\lambda)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">hcpscs</td><td>Heat capacity of snow pack under vegetation canopy <img class="formulaInl" alt="$[J m^{-3} K^1] (C_s)$" src="form_1231.png"/></td></tr>
    <tr><td class="paramname">hcpsgs</td><td>Heat capacity of snow pack in bare areas <img class="formulaInl" alt="$[J m^{-3} K^{1}] (C_s)$" src="form_1232.png"/></td></tr>
    <tr><td class="paramname">tcsnow</td><td>Thermal conductivity of snow <img class="formulaInl" alt="$[W m^{-1} K^{-1}]$" src="form_299.png"/></td></tr>
    <tr><td class="paramname">tsnogs</td><td>Temperature of snow pack in bare areas [K]</td></tr>
    <tr><td class="paramname">tsnocs</td><td>Temperature of snow pack under vegetation canopy [K]</td></tr>
    <tr><td class="paramname">wsnocs</td><td>Liquid water content of snow pack under vegetation <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">wsnogs</td><td>Liquid water content of snow pack in bare areas <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_130.png"/></td></tr>
    <tr><td class="paramname">rhoscs</td><td>Density of snow pack under vegetation canopy <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">rhosgs</td><td>Density of snow pack in bare areas <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_132.png"/></td></tr>
    <tr><td class="paramname">tcano</td><td>Temperature of canopy over ground [K]</td></tr>
    <tr><td class="paramname">tcans</td><td>Temperature of canopy over snow [K]</td></tr>
    <tr><td class="paramname">cevap</td><td>Soil evaporation efficiency coefficient <img class="formulaInl" alt="$[ ] (\beta)$" src="form_1233.png"/></td></tr>
    <tr><td class="paramname">tbar1p</td><td>Lumped temperature of ponded water and first soil layer [K]</td></tr>
    <tr><td class="paramname">wtable</td><td>Depth of water table in soil <img class="formulaInl" alt="$[m] (z_{wt})$" src="form_1234.png"/></td></tr>
    <tr><td class="paramname">zero</td><td>Dummy vector containing all zeros</td></tr>
    <tr><td class="paramname">tpondc</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpondg</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpndcs</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">tpndgs</td><td>Subarea temperature of surface ponded water [C]</td></tr>
    <tr><td class="paramname">ievap</td><td>Flag indicating whether soil evaporation is occurring or not</td></tr>
    <tr><td class="paramname">evapc</td><td>Evaporation from vegetation over ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapcg</td><td>Evaporation from ground under vegetation <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapg</td><td>Evaporation from bare ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapcs</td><td>Evaporation from vegetation over snow <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evpcsg</td><td>Evaporation from snow under vegetation <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">evapgs</td><td>Evaporation from snow on bare ground <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">gsnowc</td><td>Heat flux at top of snow pack under canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">gsnowg</td><td>Heat flux at top of snow pack over bare ground <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">gzeroc</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">gzerog</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">gzrocs</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">gzrogs</td><td>Subarea heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qmeltc</td><td>Heat to be used for melting snow under canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qmeltg</td><td>Heat to be used for melting snow on bare ground <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">evap</td><td>Diagnosed total surface water vapour flux over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">qsensc</td><td>Sensible heat flux from vegetation canopy over subarea <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qsensg</td><td>Sensible heat flux from ground over subarea <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qevapc</td><td>Latent heat flux from vegetation canopy over subarea <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qevapg</td><td>Latent heat flux from ground over subarea <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">tacco</td><td>Temperature of air within vegetation canopy space over bare ground [K]</td></tr>
    <tr><td class="paramname">qacco</td><td>Specific humidity of air within vegetation canopy space over bare ground <img class="formulaInl" alt="$[kg kg^{-1}]$" src="form_298.png"/></td></tr>
    <tr><td class="paramname">taccs</td><td>Temperature of air within vegetation canopy space over snow [K]</td></tr>
    <tr><td class="paramname">qaccs</td><td>Specific humidity of air within vegetation canopy space over snow <img class="formulaInl" alt="$[kg kg^{-1}]$" src="form_298.png"/></td></tr>
    <tr><td class="paramname">gsnow</td><td>Diagnostic heat flux at snow surface for use in CCCma black carbon deposition scheme <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">st</td><td>Diagnosed screen-level air temperature [K]</td></tr>
    <tr><td class="paramname">su</td><td>Diagnosed anemometer-level zonal wind <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">sv</td><td>Diagnosed anemometer-level meridional wind <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">sq</td><td>Diagnosed screen-level specific humidity <img class="formulaInl" alt="$[kg kg^{-1}]$" src="form_298.png"/></td></tr>
    <tr><td class="paramname">srh</td><td>Diagnosed screen-level relative humidity [%]</td></tr>
    <tr><td class="paramname">cdh</td><td>Surface drag coefficient for heat [ ]</td></tr>
    <tr><td class="paramname">cdm</td><td>Surface drag coefficient for momentum [ ]</td></tr>
    <tr><td class="paramname">qsens</td><td>Diagnosed total surface sensible heat flux over modelled area <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qevap</td><td>Diagnosed total surface latent heat flux over modelled area <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">qlwavg</td><td>Upwelling longwave radiation over modelled area <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">fsgv</td><td>Diagnosed net shortwave radiation on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">fsgs</td><td>Diagnosed net shortwave radiation at snow surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">fsgg</td><td>Diagnosed net shortwave radiation at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">flgv</td><td>Diagnosed net longwave radiation on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">flgs</td><td>Diagnosed net longwave radiation at snow surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">flgg</td><td>Diagnosed net longwave radiation at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hfsc</td><td>Diagnosed sensible heat flux on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hfss</td><td>Diagnosed sensible heat flux at snow surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hfsg</td><td>Diagnosed sensible heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hevc</td><td>Diagnosed latent heat flux on vegetation canopy <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hevs</td><td>Diagnosed latent heat flux at snow surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hevg</td><td>Diagnosed latent heat flux at soil surface <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hmfc</td><td>Diagnosed energy associated with phase change of water on vegetation <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">hmfn</td><td>Diagnosed energy associated with phase change of water in snow pack <img class="formulaInl" alt="$[W m^{-2}]$" src="form_246.png"/></td></tr>
    <tr><td class="paramname">evppot</td><td>Diagnosed potential evapotranspiration <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">acond</td><td>Diagnosed product of drag coefficient and wind speed over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">drag</td><td>Surface drag coefficient under neutral stability [ ]</td></tr>
    <tr><td class="paramname">ilmo</td><td>Surface drag coefficient under neutral stability [ ]</td></tr>
    <tr><td class="paramname">ue</td><td>Friction velocity of air <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">hbl</td><td>Height of the atmospheric boundary layer [m]</td></tr>
    <tr><td class="paramname">ilmox</td><td>Inverse of Monin-Obukhov roughness length over each subarea <img class="formulaInl" alt="$[m^{-1}]$" src="form_1235.png"/></td></tr>
    <tr><td class="paramname">uex</td><td>Friction velocity of air over each subarea <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">hblx</td><td>Height of the atmospheric boundary layer over each subarea [m]</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_l)$" src="form_421.png"/></td></tr>
    <tr><td class="paramname">thice</td><td>Volumetric frozen water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_i)$" src="form_742.png"/></td></tr>
    <tr><td class="paramname">tbar</td><td>Temperature of soil layers [K]</td></tr>
    <tr><td class="paramname">zpond</td><td>Depth of ponded water on surface [m]</td></tr>
    <tr><td class="paramname">tpond</td><td>Temperature of ponded water [K]</td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height [K]</td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow <img class="formulaInl" alt="$[kg m^{-3}] (\rho_s)$" src="form_248.png"/></td></tr>
    <tr><td class="paramname">tsnow</td><td>Snowpack temperature [K]</td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack <img class="formulaInl" alt="$[m] (z_s)$" src="form_245.png"/></td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2}] (w_s)$" src="form_1131.png"/></td></tr>
    <tr><td class="paramname">tcan</td><td>Vegetation canopy temperature [K]</td></tr>
    <tr><td class="paramname">fc</td><td>Fractional coverage of canopy over bare ground for modelled area [ ]</td></tr>
    <tr><td class="paramname">fcs</td><td>Fractional coverage of canopy over snow for modelled area [ ]</td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_p)$" src="form_744.png"/></td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_221.png"/></td></tr>
    <tr><td class="paramname">thlret</td><td>Liquid water retention capacity for organic soil <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_{ret})$" src="form_1236.png"/></td></tr>
    <tr><td class="paramname">thfc</td><td>Field capacity <img class="formulaInl" alt="$[m^3 m^{-3}] (theta_{fc})$" src="form_1237.png"/></td></tr>
    <tr><td class="paramname">hcps</td><td>Heat capacity of soil material <img class="formulaInl" alt="$[J m^{-3} K^{-1}] (C_m)$" src="form_1196.png"/></td></tr>
    <tr><td class="paramname">tcs</td><td>Thermal conductivity of soil particles <img class="formulaInl" alt="$[W m^{-1} K^{-1}] (\theta_s)$" src="form_1238.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable thickness of soil layer <img class="formulaInl" alt="$[m] (\Delta z_w)$" src="form_1239.png"/></td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth to permeable bottom of soil layer <img class="formulaInl" alt="$[m] (z_{b,w})$" src="form_1240.png"/></td></tr>
    <tr><td class="paramname">delz</td><td>Overall thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag </td></tr>
  </table>
  </dd>
</dl>
<p>In the first two loops, various subarea arrays and internal CLASST variables are initialized. The initial temperatures of the vegetation canopy above snow and above bare ground (TCANS and TCANO) are set to the temperature of the vegetation over the whole modelled area (TCAN) if TCAN is not effectively 0 K (the value it is assigned if vegetation is not present). Otherwise, the canopy temperatures are initialized to the air temperature TA.</p>
<p>In loop 200 the soil surface evaporation flag IEVAP and the evaporation efficiency coefficient CEVAP are assigned. If the liquid water content of the first soil layer is effectively equal to the minimum water content THLMIN, IEVAP and CEVAP are set to zero. If the liquid water content of the first soil layer is greater than the field capacity THFC, IEVAP and CEVAP are set to unity. Otherwise, IEVAP is set to 1 and CEVAP (or <img class="formulaInl" alt="$\beta$" src="form_497.png"/> as it is typically symbolized in the literature) is calculated using a relation presented by Lee and Pielke (1992):</p>
<p><img class="formulaInl" alt="$\beta = 0.25 [1 – cos(\theta_l \pi / \theta_{fc})]^2$" src="form_1241.png"/></p>
<p>where <img class="formulaInl" alt="$\theta_l$" src="form_226.png"/> is the liquid water content of the first soil layer and <img class="formulaInl" alt="$\theta_{fc}$" src="form_287.png"/> is its field capacity.</p>
<p>In loop 300 the volumetric heat capacities Cg of the soil layers under a bare surface (HCPG) and under vegetation (HCPC) are calculated, from their respective liquid and frozen water contents <img class="formulaInl" alt="$\theta_l$" src="form_226.png"/> and <img class="formulaInl" alt="$\theta_i$" src="form_769.png"/>:</p>
<p><img class="formulaInl" alt="$C_g = C_w \theta_l + C_i \theta_i + C_m(1 - \theta_p)$" src="form_1242.png"/></p>
<p>where <img class="formulaInl" alt="$C_m$" src="form_1243.png"/> is the heat capacity of the soil matter and <img class="formulaInl" alt="$\theta_p$" src="form_90.png"/> is the pore volume. (The heat capacity of air is neglected.)</p>
<p>In loop 400, the thermal properties of the snow pack under the vegetation canopy and over bare soil are assigned on the basis of the properties of the snow pack over the whole modelled area. The heat capacity of the snow pack Cs is calculated from the volume fractions of snow particles and liquid water in the pack. The former is obtained from the ratio of the densities of the snow pack and ice, and the latter from the ratio of the liquid water content, normalized by the snow depth, and the density of water:</p>
<p><img class="formulaInl" alt="$C_s = C_i [\rho_s /\rho_i ] + C_w w_s /[\rho_w z_s]$" src="form_1244.png"/></p>
<p>The thermal conductivity of snow <img class="formulaInl" alt="$\lambda_s$" src="form_1245.png"/> is obtained from the snow density using an empirical relationship derived by Sturm et al. (1997):</p>
<p><img class="formulaInl" alt="$\lambda_s = 3.233 x 10^{-6} \rho_s^2 – 1.01 x 10^{-3} \rho_s + 0.138 \rho_s \geq 156.0 $" src="form_1246.png"/> = 0.234 x 10^{-3}  + 0.023  &lt; 156.0</p>
<p>In loop 500, the thermal conductivities of the soil layers are assigned. If the ISAND flag for the first soil layer is -4 (indicating glacier or ice sheet), or if the ISAND flag is -3 (indicating rock), then literature values for glacier ice or sand particles respectively are assigned. If the ISAND flag is equal to -2, indicating organic soil, the depth of the water table <img class="formulaInl" alt="$z_{wt}$" src="form_943.png"/> is first calculated. This is taken to lie within the first layer, counting from the bottom of the soil profile, in which the soil water content is larger than the retention capacity <img class="formulaInl" alt="$\theta_{ret}$" src="form_282.png"/>. The water table depth is deduced by assuming that the soil is saturated below the water table, and that the water content is at the retention capacity above it. Thus, if <img class="formulaInl" alt="$\theta_l + \theta_i = \theta_p$" src="form_1247.png"/> for the soil layer, the water table is located at the top of the soil layer; if <img class="formulaInl" alt="$\theta_l + \theta_i = \theta_{ret}$" src="form_1248.png"/>, it is located at the permeable bottom of the soil layer; and if <img class="formulaInl" alt="$\theta_l + \theta_i$" src="form_1249.png"/> is between these two values, its location is given by:</p>
<p><img class="formulaInl" alt="$z_{wt} = z_{b,w} - \Delta z_w [(\theta_l + \theta_i - \theta_{ret})/(\theta_p - \theta_{ret})]$" src="form_1250.png"/></p>
<p>where <img class="formulaInl" alt="$\Delta z_w$" src="form_1251.png"/> is the permeable thickness of the soil layer.</p>
<p>The thermal conductivities of organic and mineral soils are calculated following the analysis of Côté and Konrad (2005). They model the soil thermal conductivity <img class="formulaInl" alt="$\lambda$" src="form_1214.png"/> using the concept of a relative thermal conductivity <img class="formulaInl" alt="$\lambda_r$" src="form_1252.png"/> which has a value of 0 for dry soils and 1 at saturation:</p>
<p><img class="formulaInl" alt="$\lambda = [ \lambda_{sat} – \lambda_{dry} ] \lambda_r + \lambda_{dry}$" src="form_1253.png"/></p>
<p>The relative thermal conductivity is obtained from the degree of saturation (the water content divided by the pore volume) <img class="formulaInl" alt="$S_r$" src="form_1254.png"/>, using the following generalized relationship:</p>
<p><img class="formulaInl" alt="$\lambda_r = \kappa S_r/[1 + (\kappa-1) S_r ]$" src="form_1255.png"/></p>
<p>The empirical coefficient kappa takes the following values:</p>
<p>Unfrozen coarse mineral soils: <img class="formulaInl" alt="$\kappa = 4.0$" src="form_1256.png"/> <br />
Frozen coarse mineral soils: <img class="formulaInl" alt="$\kappa = 1.2$" src="form_1257.png"/> <br />
Unfrozen fine mineral soils: <img class="formulaInl" alt="$\kappa = 1.9$" src="form_1258.png"/> <br />
Frozen fine mineral soils: <img class="formulaInl" alt="$\kappa = 0.85$" src="form_1259.png"/> <br />
Unfrozen organic soils: <img class="formulaInl" alt="$\kappa = 0.6$" src="form_1260.png"/> <br />
Frozen organic soils: <img class="formulaInl" alt="$\kappa = 0.25$" src="form_1261.png"/></p>
<p>The dry thermal conductivity <img class="formulaInl" alt="$lambda_{dry}$" src="form_1262.png"/> is calculated using an empirical relationship based on the pore volume <img class="formulaInl" alt="$\theta_p$" src="form_90.png"/>, with different coefficients for mineral and organic soils:</p>
<p><img class="formulaInl" alt="$\lambda_{dry} = 0.75 exp(-2.76 \theta_p) (mineral)$" src="form_1263.png"/> <img class="formulaInl" alt="$\lambda_{dry} = 0.30 exp(-2.0 \theta_p) (organic)$" src="form_1264.png"/></p>
<p>The saturated thermal conductivity <img class="formulaInl" alt="$\lambda_{sat}$" src="form_1265.png"/> is calculated by Cote and Konrad (2005) <b>[Cote2005-ew]</b> as a geometric mean of the conductivities of the soil components. However, other researchers (e.g. Zhang et al., 2008) have found the linear averaging used by de Vries (1963) <b>[Vries1963-ti]</b> to be more generally accurate:</p>
<p><img class="formulaInl" alt="$lambda_{sat} = lambda_w \theta_p + \lambda_s (1 - \theta_p) (unfrozen)$" src="form_1266.png"/> <img class="formulaInl" alt="$lambda_{sat} = lambda_i \theta_p + \lambda_s (1 - \theta_p) (frozen)$" src="form_1267.png"/></p>
<p>where <img class="formulaInl" alt="$\lambda_w$" src="form_1268.png"/> is the thermal conductivity of water, <img class="formulaInl" alt="$\lambda_i$" src="form_830.png"/> is that of ice and <img class="formulaInl" alt="$\lambda_s$" src="form_1245.png"/> is that of the soil particles.</p>
<p>In the 500 loop, thermal conductivities are calculated for the top and bottom of each soil layer. The degree of saturation SATRAT is calculated as the sum of liquid and frozen water contents, <img class="formulaInl" alt="$\theta_w$" src="form_1269.png"/> and <img class="formulaInl" alt="$\theta_i$" src="form_769.png"/>, divided by the pore volume. In organic soils, if the liquid water content of the soil layer is above the retention capacity <img class="formulaInl" alt="$\theta_{ret}$" src="form_282.png"/>, <img class="formulaInl" alt="$\theta_w$" src="form_1269.png"/> at the top of the soil layer is assumed to be equal to <img class="formulaInl" alt="$\theta_{re}$" src="form_1270.png"/> and <img class="formulaInl" alt="$S_r$" src="form_1254.png"/> at the bottom of the layer is assumed to be 1. The relative liquid and frozen water contents, THLSAT and THISAT, are calculated from <img class="formulaInl" alt="$\theta_w$" src="form_1269.png"/> and <img class="formulaInl" alt="$\theta_i$" src="form_769.png"/> normalized by <img class="formulaInl" alt="$\theta_w + \theta_i$" src="form_1271.png"/>. The dry thermal conductivity, and the saturated thermal conductivity for unfrozen and frozen conditions, are evaluated using the equations above. The unfrozen and frozen relative thermal conductivity, TCRATU and TCRATF, are obtained from SATRAT and the appropriate values of the empirical coefficient <img class="formulaInl" alt="$\kappa$" src="form_26.png"/>. For mineral soils, <img class="formulaInl" alt="$\kappa$" src="form_26.png"/> is obtained as a weighted average over the percent sand content (ISAND converted to a real value) and the percentage of fine material (assumed to be 100-ISAND). The unfrozen and frozen soil thermal conductivities, TCSOLU and TCSOLF, are then calculated from TCRATU, TCRATF, and the dry and saturated thermal conductivities; and the actual thermal conductivity of the soil, TCSOIL, is determined as the average of TCSOLU and TCSOLF, weighted according to the relative liquid and frozen water contents THLSAT and THISAT. If the permeable thickness of the layer, DELZW, is greater than zero, the thermal conductivity at the top of the layer is set to TCSOIL; otherwise it is set to the rock value, TCSAND. If DELZW is less than the thermal thickness of the layer DELZ, the thermal conductivity at the bottom of the layer is set to TCSAND; otherwise it is set to TCSOIL. (In the case of organic soils in the latter branch, if <img class="formulaInl" alt="$\theta_w$" src="form_1269.png"/> was greater than <img class="formulaInl" alt="$\theta_{ret}$" src="form_282.png"/>, the thermal conductivity at the bottom of the layer is set to the average of the saturated unfrozen and frozen values, weighted by THLSAT and THISAT.) Finally, if there is ponded water present on the soil surface, the thermal conductivity at the top of the first soil layer is treated as varying linearly from the calculated soil thermal conductivity if the pond depth ZPOND is zero, to the thermal conductivity of water if ZPOND <img class="formulaInl" alt="$\geq 10^{-2} m$" src="form_1272.png"/>.</p>
<p>Finally, in loop 600, a variable TBAR1P is evaluated, representing the weighted average value of the first layer soil temperature and the ponded water, if any. (The heat capacity of the soil is determined as the weighted average of HCPG over the permeable thickness DELZW, and the heat capacity of rock, HCPSND, over the impermeable thickness, DELZ-DELZW.)</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="TPREP_8f.html">TPREP.f</a></li>
    <li class="footer">Generated on Tue Oct 24 2017 15:13:14 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
