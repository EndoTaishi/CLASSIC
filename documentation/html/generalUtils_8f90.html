<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/generalUtils.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('generalUtils_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">generalUtils.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Central module for all general utilities.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a6f0d5c05665ea3d3ce31ecb4ae0dc2ee"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a6f0d5c05665ea3d3ce31ecb4ae0dc2ee">generalutils::finddaylength</a> (solday, radl)</td></tr>
<tr class="memdesc:a6f0d5c05665ea3d3ce31ecb4ae0dc2ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the daylength based on the latitude and day of year.  <a href="generalUtils_8f90.html#a6f0d5c05665ea3d3ce31ecb4ae0dc2ee">More...</a><br /></td></tr>
<tr class="separator:a6f0d5c05665ea3d3ce31ecb4ae0dc2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ee05ca8645b48915d04a6fc76c51390"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a3ee05ca8645b48915d04a6fc76c51390">generalutils::findleapyears</a> (iyear, leapnow, lastDOY)</td></tr>
<tr class="memdesc:a3ee05ca8645b48915d04a6fc76c51390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if this year is a leap year.  <a href="generalUtils_8f90.html#a3ee05ca8645b48915d04a6fc76c51390">More...</a><br /></td></tr>
<tr class="separator:a3ee05ca8645b48915d04a6fc76c51390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4585c55b6ccd89df3f105a725fc03e79"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a4585c55b6ccd89df3f105a725fc03e79">generalutils::findcloudiness</a> (nltest, imin, ihour, iday, lastDOY)</td></tr>
<tr class="memdesc:a4585c55b6ccd89df3f105a725fc03e79"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cosine of the solar zenith angle COSZ is calculated from the day of the year, the hour, the minute and the latitude using basic radiation geometry, and (avoiding vanishingly small numbers) is assigned to CSZROW. The fractional cloud cover FCLOROW is commonly not available so a rough estimate is obtained by setting it to 1 when precipitation is occurring, and to the fraction of incoming diffuse radiation XDIFFUS otherwise (assumed to be 1 when the sun is at the horizon, and 0.10 when it is at the zenith).  <a href="generalUtils_8f90.html#a4585c55b6ccd89df3f105a725fc03e79">More...</a><br /></td></tr>
<tr class="separator:a4585c55b6ccd89df3f105a725fc03e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c06112b9b31ccffe032bbf463403b6"><td class="memItemLeft" align="right" valign="top">real function, dimension(5), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#ae8c06112b9b31ccffe032bbf463403b6">generalutils::parsetimestamp</a> (timeStamp)</td></tr>
<tr class="memdesc:ae8c06112b9b31ccffe032bbf463403b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses a time stamp in the expected form "day as %Y%m%d.%f" Returns an array with 1) year, 2) month, 3) day, 4) fraction of day 5) day of year.  <a href="generalUtils_8f90.html#ae8c06112b9b31ccffe032bbf463403b6">More...</a><br /></td></tr>
<tr class="separator:ae8c06112b9b31ccffe032bbf463403b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e82d2683b95d2a1b07367835692e02"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a12e82d2683b95d2a1b07367835692e02">generalutils::findpermafrostvars</a> (nltest, nmtest, iday)</td></tr>
<tr class="memdesc:a12e82d2683b95d2a1b07367835692e02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the active layer depth and depth to the frozen water table.  <a href="generalUtils_8f90.html#a12e82d2683b95d2a1b07367835692e02">More...</a><br /></td></tr>
<tr class="separator:a12e82d2683b95d2a1b07367835692e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4476b8a9d08db5d4c498d3f6c3d57364"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a4476b8a9d08db5d4c498d3f6c3d57364">generalutils::closeenough</a> (num1, num2, error)</td></tr>
<tr class="memdesc:a4476b8a9d08db5d4c498d3f6c3d57364"><td class="mdescLeft">&#160;</td><td class="mdescRight">As real numbers are not precise, this is a simple way to compare two reals.  <a href="generalUtils_8f90.html#a4476b8a9d08db5d4c498d3f6c3d57364">More...</a><br /></td></tr>
<tr class="separator:a4476b8a9d08db5d4c498d3f6c3d57364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:afa44642b1117d4309ceee18d8984f0c0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#afa44642b1117d4309ceee18d8984f0c0">generalutils::abandoncell</a> (errmsg)</td></tr>
<tr class="memdesc:afa44642b1117d4309ceee18d8984f0c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to stop running a model grid cell. For errors that need to be caught early in a run, the fortran intrinsic 'stop' is preferred but for errors later in a run or simple fails on single grid cells, abandonCell is best since it allows the netcdf files to continue to written to and won't disrupt the MPI processes (as stop does)  <a href="generalUtils_8f90.html#afa44642b1117d4309ceee18d8984f0c0">More...</a><br /></td></tr>
<tr class="separator:afa44642b1117d4309ceee18d8984f0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82602d42e107240e96ffd441c0dcdb90"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#a82602d42e107240e96ffd441c0dcdb90">generalutils::initrandomseed</a> ()</td></tr>
<tr class="memdesc:a82602d42e107240e96ffd441c0dcdb90"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine sets a repeatable seed for the random number generator.  <a href="generalUtils_8f90.html#a82602d42e107240e96ffd441c0dcdb90">More...</a><br /></td></tr>
<tr class="separator:a82602d42e107240e96ffd441c0dcdb90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae570b209b33a4e6370bc54146e21b1a0"><td class="memItemLeft" align="right" valign="top"><a id="ae570b209b33a4e6370bc54146e21b1a0"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="generalUtils_8f90.html#ae570b209b33a4e6370bc54146e21b1a0">generalutils::run_model</a></td></tr>
<tr class="memdesc:ae570b209b33a4e6370bc54146e21b1a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple logical switch to either keep run going or finish. <br /></td></tr>
<tr class="separator:ae570b209b33a4e6370bc54146e21b1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Central module for all general utilities. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="file_afa44642b1117d4309ceee18d8984f0c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_afa44642b1117d4309ceee18d8984f0c0">&#9670;&nbsp;</a></span>abandoncell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public generalutils::abandoncell </td>
          <td>(</td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>errmsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to stop running a model grid cell. For errors that need to be caught early in a run, the fortran intrinsic 'stop' is preferred but for errors later in a run or simple fails on single grid cells, abandonCell is best since it allows the netcdf files to continue to written to and won't disrupt the MPI processes (as stop does) </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton and Ed Wisernig </dd></dl>

</div>
</div>
<a id="file_a4476b8a9d08db5d4c498d3f6c3d57364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a4476b8a9d08db5d4c498d3f6c3d57364">&#9670;&nbsp;</a></span>closeenough()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public generalutils::closeenough </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>num1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>num2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>As real numbers are not precise, this is a simple way to compare two reals. </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton </dd></dl>

</div>
</div>
<a id="file_a4585c55b6ccd89df3f105a725fc03e79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a4585c55b6ccd89df3f105a725fc03e79">&#9670;&nbsp;</a></span>findcloudiness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public generalutils::findcloudiness </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nltest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ihour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lastDOY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The cosine of the solar zenith angle COSZ is calculated from the day of the year, the hour, the minute and the latitude using basic radiation geometry, and (avoiding vanishingly small numbers) is assigned to CSZROW. The fractional cloud cover FCLOROW is commonly not available so a rough estimate is obtained by setting it to 1 when precipitation is occurring, and to the fraction of incoming diffuse radiation XDIFFUS otherwise (assumed to be 1 when the sun is at the horizon, and 0.10 when it is at the zenith). </p>
<dl class="section author"><dt>Author</dt><dd>Diana Verseghy </dd></dl>

</div>
</div>
<a id="file_a6f0d5c05665ea3d3ce31ecb4ae0dc2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a6f0d5c05665ea3d3ce31ecb4ae0dc2ee">&#9670;&nbsp;</a></span>finddaylength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public generalutils::finddaylength </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>solday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>radl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the daylength based on the latitude and day of year. </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton </dd></dl>

</div>
</div>
<a id="file_a3ee05ca8645b48915d04a6fc76c51390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a3ee05ca8645b48915d04a6fc76c51390">&#9670;&nbsp;</a></span>findleapyears()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public generalutils::findleapyears </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iyear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>lastDOY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if this year is a leap year. </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdoy</td><td>days in each month</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdoy</td><td>calender day at end of each month</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdoy</td><td>mid-month day </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="file_a12e82d2683b95d2a1b07367835692e02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a12e82d2683b95d2a1b07367835692e02">&#9670;&nbsp;</a></span>findpermafrostvars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public generalutils::findpermafrostvars </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nltest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nmtest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the active layer depth and depth to the frozen water table. </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton </dd></dl>

</div>
</div>
<a id="file_a82602d42e107240e96ffd441c0dcdb90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a82602d42e107240e96ffd441c0dcdb90">&#9670;&nbsp;</a></span>initrandomseed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public generalutils::initrandomseed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine sets a repeatable seed for the random number generator. </p>
<dl class="section author"><dt>Author</dt><dd>J. Melton </dd></dl>

</div>
</div>
<a id="file_ae8c06112b9b31ccffe032bbf463403b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_ae8c06112b9b31ccffe032bbf463403b6">&#9670;&nbsp;</a></span>parsetimestamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, dimension(5), public generalutils::parsetimestamp </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>timeStamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses a time stamp in the expected form "day as %Y%m%d.%f" Returns an array with 1) year, 2) month, 3) day, 4) fraction of day 5) day of year. </p>
<dl class="section author"><dt>Author</dt><dd>Joe Melton, Ed Wisernig </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="generalUtils_8f90.html">generalUtils.f90</a></li>
    <li class="footer">Generated on Thu Jul 4 2019 12:03:55 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
