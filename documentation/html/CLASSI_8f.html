<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/CLASSI.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('CLASSI_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSI.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Evaluates atmospheric variables and rainfall/snowfall rates over modelled area.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4e0212f4e58542e09cc303c2a0054949"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSI_8f.html#a4e0212f4e58542e09cc303c2a0054949">classi</a> (VPD, TADP, PADRY, RHOAIR, RHOSNI, RPCP, TRPCP, SPCP, TSPCP, TA, QA, PCPR, RRATE, SRATE, PRESSG, IPCP, NL, IL1, IL2)</td></tr>
<tr class="separator:a4e0212f4e58542e09cc303c2a0054949"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Evaluates atmospheric variables and rainfall/snowfall rates over modelled area. </p>
<dl class="section author"><dt>Author</dt><dd>D. Verseghy, M. Lazare, R. Brown, S. Fassnacht, P. Bartlett </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4e0212f4e58542e09cc303c2a0054949"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0212f4e58542e09cc303c2a0054949">&#9670;&nbsp;</a></span>classi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classi </td>
          <td>(</td>
          <td class="paramtype">real, dimension   (nl)&#160;</td>
          <td class="paramname"><em>VPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>TADP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>PADRY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>RHOAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>RPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>TRPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>SPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>TSPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl)&#160;</td>
          <td class="paramname"><em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>PCPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>RRATE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>SRATE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>PRESSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vpd</td><td>Vapour pressure deficit of air <img class="formulaInl" alt="$[mb] (e_d)$" src="form_281.png"/></td></tr>
    <tr><td class="paramname">tadp</td><td>Dew point temperature of air [K]</td></tr>
    <tr><td class="paramname">padry</td><td>Partial pressure of dry air <img class="formulaInl" alt="$[Pa] (p_{dry})$" src="form_282.png"/></td></tr>
    <tr><td class="paramname">rhoair</td><td>Density of air <img class="formulaInl" alt="$[kg m^{-3}] (\rho_a)$" src="form_283.png"/></td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow <img class="formulaInl" alt="$[kg m^{-3}] (\rho_{s,i})$" src="form_284.png"/></td></tr>
    <tr><td class="paramname">rpcp</td><td>Calculated rainfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">trpcp</td><td>Rainfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">spcp</td><td>Calculated snowfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_122.png"/></td></tr>
    <tr><td class="paramname">tspcp</td><td>Snowfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height <img class="formulaInl" alt="$[K] (T_a)$" src="form_285.png"/></td></tr>
    <tr><td class="paramname">qa</td><td>Specific humidity at reference height <img class="formulaInl" alt="$[kg kg^{-1}] (q_a)$" src="form_286.png"/></td></tr>
    <tr><td class="paramname">pressg</td><td>Surface atmospheric pressure <img class="formulaInl" alt="$[Pa] (p)$" src="form_287.png"/></td></tr>
    <tr><td class="paramname">pcpr</td><td>Precipitation rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">rrate</td><td>Input rainfall rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/></td></tr>
    <tr><td class="paramname">srate</td><td>Input snowfall rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_128.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>In the first section, the air vapour pressure deficit, dry air pressure, air density and dew point temperature are calculated. The vapour pressure deficit <img class="formulaInl" alt="$e_d$" src="form_288.png"/> (in units of mb) is obtained from the saturated and actual vapour pressures of the air, <img class="formulaInl" alt="$e_a$" src="form_289.png"/> and <img class="formulaInl" alt="$e_{a,sat}$" src="form_290.png"/> respectively (in units of Pa), as <img class="formulaInl" alt="$e_d = [e_{a,sat} - e_a] /100.0$" src="form_291.png"/></p>
<p>The air vapour pressure is obtained from the specific humidity <img class="formulaInl" alt="$q_a$" src="form_292.png"/> using the formula</p>
<p><img class="formulaInl" alt="$e_a = q_a p /[0.622 + 0.378 q_a ]$" src="form_293.png"/></p>
<p>where p is the surface atmospheric pressure. For the saturated vapour pressure, a standard empirical equation is utilized relating <img class="formulaInl" alt="$e_{a,sat}$" src="form_290.png"/> to the temperature <img class="formulaInl" alt="$T_a$" src="form_192.png"/> and the freezing point <img class="formulaInl" alt="$T_f$" src="form_294.png"/>:</p>
<p><img class="formulaInl" alt="$e_{a,sat} = 611.0 exp[17.269*(T_a – T_f)/(T_a – 35.86)]$" src="form_295.png"/> <img class="formulaInl" alt="$T_a \geq T_f$" src="form_296.png"/></p>
<p><img class="formulaInl" alt="$e_{a,sat} = 611.0 exp[21.874 (T_a – T_f)/(T_a – 7.66)]$" src="form_297.png"/> <img class="formulaInl" alt="$T_a &lt; T_f$" src="form_298.png"/></p>
<p>The partial pressure of dry air, <img class="formulaInl" alt="$p_{dry}$" src="form_299.png"/>, is obtained by subtracting <img class="formulaInl" alt="$e_a$" src="form_289.png"/> from p, and the density of the air is calculated as the sum of the densities of the dry air and the water vapour: <img class="formulaInl" alt="$\rho_a = p_{dry} / R_d T_a + e_a / R_v T_a$" src="form_300.png"/></p>
<p>where <img class="formulaInl" alt="$R_d$" src="form_301.png"/> and <img class="formulaInl" alt="$R_v$" src="form_302.png"/> are the gas constants for dry air and water vapour respectively. The dew point temperature of the air is evaluated by substituting <img class="formulaInl" alt="$e_a$" src="form_289.png"/> for <img class="formulaInl" alt="$e_{a,sat}$" src="form_290.png"/> on the left-hand side of the appropriate equation above, and solving for <img class="formulaInl" alt="$T_a$" src="form_192.png"/>.</p>
<p>Finally, if IPCP = 4, this indicates that the partitioning between rainfall and snowfall has been done outside of CLASS. The rainfall and snowfall rates RRATE and SRATE that have been passed into the subroutine are therefore simply assigned to RPCP and SPCP.</p>
<p>In the next section, the density of fresh snow <img class="formulaInl" alt="$\rho_{s,i}$" src="form_1648.png"/> is determined as an empirical function of the air temperature. For temperatures below 0 C, an equation presented by Hedstrom and Pomeroy (1998) is used. For temperatures &gt;= 0 C, a relation following Pomeroy and Gray (1995) is used, with an upper limit of 200 kg m-3:</p>
<p><img class="formulaInl" alt="$\rho_{s,i} = 67.92 + 51.25 exp[(T_a – T_f)/2.59]$" src="form_1649.png"/> <img class="formulaInl" alt="$T_a &lt; T_f$" src="form_298.png"/> <img class="formulaInl" alt="$\rho_{s,i} = 119.17 + 20.0 (T_a – T_f)$" src="form_1650.png"/> <img class="formulaInl" alt="$T_a \geq T_f$" src="form_296.png"/></p>
<p>In the last section, the partitioning of precipitation between rainfall RPCP and snowfall SPCP is addressed. Four options for doing so are provided; the user’s selection is indicated by the flag IPCP. In each case the rainfall and snowfall rates are converted to units of <img class="formulaInl" alt="$ m s^{-1}$" src="form_1651.png"/>, by dividing by the density of water in the case of rain and by <img class="formulaInl" alt="$\rho_{s,i}$" src="form_1648.png"/> in the case of snow. The rainfall temperature is set to the maximum of 0 C and <img class="formulaInl" alt="$T_a$" src="form_192.png"/>, and the snowfall temperature to the minimum of 0 C and <img class="formulaInl" alt="$T_a$" src="form_192.png"/>. If IPCP = 1, the precipitation is simply diagnosed as rain if the air temperature is greater than 0 C, and as snow otherwise. If IPCP = 2, an empirical relation developed by Brown (2001) is used, where the precipitation is entirely snowfall when <img class="formulaInl" alt="$T_a \leq 0 C$" src="form_1652.png"/>, and entirely rainfall when <img class="formulaInl" alt="$T_a \geq 2.0 C$" src="form_1653.png"/>, and varies linearly between the two, with an equal mix of rain and snow at <img class="formulaInl" alt="$T_a = 1.0 C$" src="form_1654.png"/>. If IPCP = 3, the precipitation is assumed to be entirely snowfall when <img class="formulaInl" alt="$T_a \leq 0 C$" src="form_1652.png"/>, and entirely rainfall when <img class="formulaInl" alt="$T_a \geq 6.0 C$" src="form_1655.png"/>, and between the two a polynomial function presented by Auer (1974) <a class="el" href="citelist.html#CITEREF_Auer1974-fd">[13]</a> is used, relating the fraction of the precipitation that is snowfall, <img class="formulaInl" alt="$X_{sf}$" src="form_1656.png"/>, to <img class="formulaInl" alt="$T_a$" src="form_192.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ X_{sf} = [0.0202 T_a^6 – 0.3660 T_a^5 + 2.0399 T_a^4 – 1.5089 T_a^3 – 15.038 T_a^2 + 4.6664 T_a + 100.0]/100.0 \]" src="form_1657.png"/>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="CLASSI_8f.html">CLASSI.f</a></li>
    <li class="footer">Generated on Fri Jan 25 2019 10:41:41 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
