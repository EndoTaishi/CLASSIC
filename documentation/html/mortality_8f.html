<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/mortality.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mortality_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mortality.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates the litter generated from leaves, stem, and root components after vegetation dies due to reduced growth efficiency or due to aging (the intrinsic mortality)  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1b68a3039e6520fdacceefa188640158"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mortality_8f.html#a1b68a3039e6520fdacceefa188640158">mortalty</a> (stemmass, rootmass, ailcg, gleafmas, bleafmas, il1, il2, leapnow, iday, sort, fcancmx, lystmmas, lyrotmas, tymaxlai, grwtheff, stemltrm, rootltrm, glealtrm, geremort, intrmort)</td></tr>
<tr class="separator:a1b68a3039e6520fdacceefa188640158"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates the litter generated from leaves, stem, and root components after vegetation dies due to reduced growth efficiency or due to aging (the intrinsic mortality) </p>
<dl class="section author"><dt>Author</dt><dd>Vivek Arora, Joe Melton</dd></dl>
<p>Mortality</p>
<p>The PFT-dependent mortality rate ( <img class="formulaInl" alt="$day^{-1}$" src="form_437.png"/>),</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{mortality} m_{\alpha} = m_{intr,\alpha} + m_{ge,\alpha} + m_{bioclim,\alpha} + m_{dist,\alpha}, \]" src="form_863.png"/>
</p>
<p> reflects the net effect of four different processes: (1) intrinsic- or age-related mortality, <img class="formulaInl" alt="$m_{intr}$" src="form_864.png"/>, (2) growth or stress-related mortality, <img class="formulaInl" alt="$m_{ge}$" src="form_865.png"/>, (3) mortality associated with bioclimatic criteria, <img class="formulaInl" alt="$m_{bioclim}$" src="form_505.png"/> and (4) mortality associated with disturbances, <img class="formulaInl" alt="$m_{dist}$" src="form_700.png"/>.</p>
<p>Intrinsic- or age-related mortality uses a PFT-specific maximum age, <img class="formulaInl" alt="$A_{max}$" src="form_866.png"/> (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>), to calculate an annual mortality rate such that only <img class="formulaInl" alt="$1\,{\%}$" src="form_867.png"/> of tree PFTs exceed <img class="formulaInl" alt="$A_{max},\alpha$" src="form_868.png"/>. Intrinsic mortality accounts for processes, whose effect is not explicitly captured in the model including insect damage, hail, wind throw, etc.,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{intrmort} m_{intr,\alpha} = 1 - \exp(-4.605/A_{max,\alpha}). \]" src="form_869.png"/>
</p>
<p>Grasses and crops have <img class="formulaInl" alt="$m_{intr} = 0$" src="form_870.png"/>. The annual growth-related mortality <img class="formulaInl" alt="$m_{ge}$" src="form_865.png"/> is calculated using growth efficiency of a PFT over the course of the previous year following <a class="el" href="citelist.html#CITEREF_Prentice1993-xn">[22]</a> and <a class="el" href="citelist.html#CITEREF_Sitch2003-847">[78]</a> as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{mgrow} m_{ge,\alpha} = \frac{m_{{ge},max,\alpha}}{1 + k_{m} g_{\mathrm{e},\alpha}}, \]" src="form_871.png"/>
</p>
<p>where <img class="formulaInl" alt="$m_{{ge},max}$" src="form_872.png"/> represents the PFT-specific maximum mortality rate when no growth occurs (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a>). <img class="formulaInl" alt="$k_{m}$" src="form_873.png"/> is a parameter set to <img class="formulaInl" alt="$0.3\,m^{2}\,(g\,C)^{-1}$" src="form_874.png"/>. <img class="formulaInl" alt="$g_\mathrm{e}$" src="form_875.png"/> is the growth efficiency of the PFT ( <img class="formulaInl" alt="$g\,C\,m^{-2}$" src="form_678.png"/>) calculated based on the maximum LAI ( <img class="formulaInl" alt="$L_{\alpha,max}$" src="form_876.png"/>; <img class="formulaInl" alt="$m^{2}\,m^{-2}$" src="form_877.png"/>) and the increment in stem and root mass over the course of the previous year ( <img class="formulaInl" alt="$\Delta C_\mathrm{S}$" src="form_878.png"/> and <img class="formulaInl" alt="$\Delta C_\mathrm{R}$" src="form_879.png"/>; <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_492.png"/>, respectively) <a class="el" href="citelist.html#CITEREF_Waring1983-wc">[89]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\mathrm{e},\alpha} = 1000\frac{\max(0,(\Delta C_{\mathrm{S},\alpha}+\Delta C_{\mathrm{R},\alpha}))}{L_{\alpha,max}}. \]" src="form_880.png"/>
</p>
<p>Mortality associated with bioclimatic criteria, <img class="formulaInl" alt="$m_{bioclim}$" src="form_505.png"/> ( <img class="formulaInl" alt="$0.25\,yr^{-1}$" src="form_881.png"/>), is applied when climatic conditions in a grid cell become unfavourable for a PFT to exist and ensures that PFTs do not exist outside their bioclimatic envelopes, as explained in the next section.</p>
<p>The annual mortality rates for <img class="formulaInl" alt="$m_{intr}$" src="form_864.png"/>, <img class="formulaInl" alt="$m_{ge}$" src="form_865.png"/> and <img class="formulaInl" alt="$m_{bioclim}$" src="form_505.png"/> are converted to daily rates and applied at the daily time step of the model, while <img class="formulaInl" alt="$m_{dist}$" src="form_700.png"/> is calculated by the fire module of the model based on daily area burned for each PFT as summarized in Appendix fire}. In practice, the <img class="formulaInl" alt="$\frac{\mathrm{d}f_\alpha}{\mathrm{d}t}=-m_{dist,\alpha}f_\alpha$" src="form_882.png"/> term of Eq. (compact}) is implemented right after area burnt is calculated. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a1b68a3039e6520fdacceefa188640158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b68a3039e6520fdacceefa188640158">&#9670;&nbsp;</a></span>mortalty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mortalty </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>ailcg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>lystmmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>lyrotmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>tymaxlai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>grwtheff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemltrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootltrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>glealtrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>geremort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>intrmort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramname">iday</td><td>day of the year</td></tr>
    <tr><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramname">sort</td><td>index for correspondence between ctem 9 pfts and size 12 of parameters vectors</td></tr>
    <tr><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramname">gleafmas</td><td>green leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramname">ailcg</td><td>green or live lai</td></tr>
    <tr><td class="paramname">grwtheff</td><td>growth efficiency. change in biomass per year per unit max. lai (g c/m2)/(m2/m2)</td></tr>
    <tr><td class="paramname">lystmmas</td><td>stem mass at the end of last year</td></tr>
    <tr><td class="paramname">lyrotmas</td><td>root mass at the end of last year</td></tr>
    <tr><td class="paramname">tymaxlai</td><td>this year's maximum lai</td></tr>
    <tr><td class="paramname">bleafmas</td><td>brown leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_535.png"/></td></tr>
    <tr><td class="paramname">stemltrm</td><td>stem litter generated due to mortality <img class="formulaInl" alt="$(kg c/m^2)$" src="form_1526.png"/></td></tr>
    <tr><td class="paramname">rootltrm</td><td>root litter generated due to mortality <img class="formulaInl" alt="$(kg c/m^2)$" src="form_1526.png"/></td></tr>
    <tr><td class="paramname">glealtrm</td><td>green leaf litter generated due to mortality <img class="formulaInl" alt="$(kg c/m^2)$" src="form_1526.png"/></td></tr>
    <tr><td class="paramname">geremort</td><td>growth efficiency related mortality (1/day)</td></tr>
    <tr><td class="paramname">intrmort</td><td>intrinsic mortality (1/day) </td></tr>
  </table>
  </dd>
</dl>
<hr/>
 <h2>Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a> </h2>
<p>initialize required arrays to zero</p>
<p>initialization ends </p><hr/>
<p>at the end of every year, i.e. when iday equals 365, we calculate growth related mortality. rather than using this number to kill plants at the end of every year, this mortality rate is applied gradually over the next year.</p>
<p>calculate growth related mortality using last year's growth efficiency or the new growth efficiency if day is 365 and growth efficiency estimate has been updated above.</p>
<p>convert (1/year) rate into (1/day) rate</p>
<p>calculate intrinsic mortality rate due to aging which implicity includes effects of frost, hail, wind throw etc. it is assumed that only 1% of the plants exceed maximum age (which is a pft-dependent parameter). to achieve this some fraction of the plants need to be killed every year.</p>
<p>convert (1/year) rate into (1/day) rate</p>
<p>now that we have both growth related and intrinsic mortality rates, lets combine these rates for every pft and estimate litter generated</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="mortality_8f.html">mortality.f</a></li>
    <li class="footer">Generated on Tue Aug 14 2018 13:19:30 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
