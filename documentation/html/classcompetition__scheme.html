<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>CLASSIC: competition_scheme Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classcompetition__scheme.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="modulecompetition__scheme-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">competition_scheme Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Performs competition between PFTs for space.  
 <a href="classcompetition__scheme.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a8976936d6f76c8619f6602153b8355f9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcompetition__scheme.html#a8976936d6f76c8619f6602153b8355f9">bioclim</a> (iday, ta, precip, netrad, il1, il2, nilg, leapnow, tcurm, srpcuryr, dftcuryr, inibioclim, tmonth, anpcpcur, anpecur, gdd5cur, surmncur, defmncur, srplscur, defctcur, twarmm, tcoldm, gdd5, aridity, srplsmon, defctmon, anndefct, annsrpls, annpcp, dry_season_length)</td></tr>
<tr class="memdesc:a8976936d6f76c8619f6602153b8355f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates bioclimatic parameters required to determine existance of PFTs.  <a href="#a8976936d6f76c8619f6602153b8355f9">More...</a><br /></td></tr>
<tr class="separator:a8976936d6f76c8619f6602153b8355f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a4345a1807f52b8da4f0cdd9f0f71f91f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcompetition__scheme.html#a4345a1807f52b8da4f0cdd9f0f71f91f">existence</a> (iday, il1, il2, nilg, sort, nol2pfts, twarmm, tcoldm, gdd5, aridity, srplsmon, defctmon, anndefct, annsrpls, annpcp, pftexist, dry_season_length)</td></tr>
<tr class="memdesc:a4345a1807f52b8da4f0cdd9f0f71f91f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a PFT can exist in a grid cell based on climatic conditions.  <a href="#a4345a1807f52b8da4f0cdd9f0f71f91f">More...</a><br /></td></tr>
<tr class="separator:a4345a1807f52b8da4f0cdd9f0f71f91f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a008cbfcefd33aaccb8f2b81cf8326451"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcompetition__scheme.html#a008cbfcefd33aaccb8f2b81cf8326451">competition</a> (iday, il1, il2, nilg, nol2pfts, nppveg, dofire, leapnow, pftexist, geremort, intrmort, gleafmas, bleafmas, stemmass, rootmass, litrmass, soilcmas, grclarea, lambda, burnvegf, sort, pstemmass, pgleafmass, fcancmx, fcanmx, vgbiomas, gavgltms, gavgscms, bmasveg, add2allo, colrate, mortrate)</td></tr>
<tr class="memdesc:a008cbfcefd33aaccb8f2b81cf8326451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the competition between PFTs based on Lotka-Volterra eqns. ot its modified forms. either option may be used.  <a href="#a008cbfcefd33aaccb8f2b81cf8326451">More...</a><br /></td></tr>
<tr class="separator:a008cbfcefd33aaccb8f2b81cf8326451"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Performs competition between PFTs for space. </p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a8976936d6f76c8619f6602153b8355f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public competition_scheme::bioclim </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>precip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>netrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>tcurm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>srpcuryr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>dftcuryr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>inibioclim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(12,nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>tmonth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>anpcpcur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>anpecur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>gdd5cur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>surmncur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>defmncur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>srplscur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>defctcur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>twarmm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>tcoldm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>gdd5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>aridity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>srplsmon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>defctmon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>anndefct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>annsrpls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>annpcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>dry_season_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates bioclimatic parameters required to determine existance of PFTs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nilg</td><td>day of the year</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nilg</td><td>no. of grid cells in latitude circle (this is passed in as either ilg or nlat depending on mos/comp)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il2</td><td>il2=nilg</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ta</td><td>mean daily temperature, k</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precip</td><td>daily precipitation (mm/day)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">netrad</td><td>daily net radiation (w/m2)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inibioclim</td><td>switch telling if bioclimatic parameters are being initialized from scratch (false) or being initialized from some spun up values(true).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcurm</td><td>temperature of the current month (c)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srpcuryr</td><td>water surplus for the current year</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dftcuryr</td><td>water deficit for the current year</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tmonth</td><td>monthly temperatures</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">anpcpcur</td><td>annual precipitation for current year (mm)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">anpecur</td><td>annual potential evaporation for current year (mm)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gdd5cur</td><td>growing degree days above 5 c for current year</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">surmncur</td><td>number of months with surplus water for current year</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">defmncur</td><td>number of months with water deficit for current year</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srplscur</td><td>water surplus for the current month</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">defctcur</td><td>water deficit for the current month</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">twarmm</td><td>temperature of the warmest month (c)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcoldm</td><td>temperature of the coldest month (c)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gdd5</td><td>growing degree days above 5 c</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aridity</td><td>aridity index, ratio of potential evaporation to precipitation</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srplsmon</td><td>number of months in a year with surplus water i.e. precipitation more than potential evaporation</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">defctmon</td><td>number of months in a year with water deficit i.e. precipitation less than potential evaporation</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">anndefct</td><td>annual water deficit (mm)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">annsrpls</td><td>annual water surplus (mm)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">annpcp</td><td>annual precipitation (mm)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dry_season_length</td><td>annual maximum dry month length (months) </td></tr>
  </table>
  </dd>
</dl>
<p>Find current month</p>
<p>Find if we are at end of month or not</p>
<p>Update monthly temperature for the current month, and other variables. at the end of the month we will have average of all daily temperatures for the current month.</p>
<p>If its the end of the month then store the monthly temperature and set tcurm equal to zero. also check if this month had water deficit or surplus</p>
<p>this loop doubles up the size of the "wet_dry_mon_index" matrix</p>
<p>If its the end of year, then find the temperature of the warmest and the coldest month</p>
<p>Update long term moving average of bioclimatic parameters in an e-folding sense </p>

</div>
</div>
<a class="anchor" id="a008cbfcefd33aaccb8f2b81cf8326451"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public competition_scheme::competition </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican), intent(in)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>nppveg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>dofire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>pftexist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>geremort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>intrmort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,iccp1), intent(inout)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,iccp1), intent(inout)&#160;</td>
          <td class="paramname"><em>soilcmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>grclarea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>burnvegf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc), intent(in)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>pstemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(in)&#160;</td>
          <td class="paramname"><em>pgleafmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,ican), intent(inout)&#160;</td>
          <td class="paramname"><em>fcanmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>vgbiomas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>gavgltms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(inout)&#160;</td>
          <td class="paramname"><em>gavgscms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(inout)&#160;</td>
          <td class="paramname"><em>bmasveg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(out)&#160;</td>
          <td class="paramname"><em>add2allo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(out)&#160;</td>
          <td class="paramname"><em>colrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg,icc), intent(out)&#160;</td>
          <td class="paramname"><em>mortrate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the competition between PFTs based on Lotka-Volterra eqns. ot its modified forms. either option may be used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iday</td><td>day of the year</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nilg</td><td>no. of grid cells in latitude circle (this is passed in as either ilg or nlat depending on mos/comp)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il2</td><td>il2=nilg</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dofire</td><td>if true then we have disturbance on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grclarea</td><td>grid cell area, km^2</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sort</td><td>index for correspondence between 9 ctem pfts and size 12 of parameter vectors</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pftexist</td><td>indicating pfts exist (T) or not (F)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">geremort</td><td>growth related mortality (1/day)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intrmort</td><td>intrinsic (age related) mortality (1/day)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lambda</td><td>fraction of npp that is used for spatial expansion</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">burnvegf</td><td>fractional areas burned, for 9 ctem pfts</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pstemmass</td><td>stem mass from previous timestep, is value before fire. used by burntobare subroutine</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pgleafmass</td><td>root mass from previous timestep, is value before fire. used by burntobare subroutine</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nppveg</td><td>npp for each pft type /m2 of vegetated area u-mol co2-c/m2.sec</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bmasveg</td><td>total (gleaf + stem + root) biomass for each ctem pft, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gleafmas</td><td>green leaf mass for each of the 9 ctem pfts, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bleafmas</td><td>brown leaf mass for each of the 9 ctem pfts, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">litrmass</td><td>litter mass for each of the 9 ctem pfts + bare, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">soilcmas</td><td>soil carbon mass for each of the 9 ctem pfts + bare, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fcancmx</td><td>fractional coverage of ctem's 9 pfts</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fcanmx</td><td>fractional coverage of class' 4 pfts</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vgbiomas</td><td>grid averaged vegetation biomass, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gavgltms</td><td>grid averaged litter mass, kg c/m2</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gavgscms</td><td>grid averaged soil c mass, kg c/m2</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">add2allo</td><td>npp kg c/m2.day that is used for expansion and subsequently allocated to leaves, stem, and root via the allocation part of the model.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">colrate</td><td>colonization rate (1/day)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mortrate</td><td>mortality rate </td></tr>
  </table>
  </dd>
</dl>
<p>set competition parameters according to the model chosen</p>
<p>First, let's adjust the fractions if fire is turned on.</p>
<p>Since the biomass pools could have changed, update bmasveg.</p>
<p>Do our usual initialization</p>
<p>initial rank/superiority order for simulating competition. since crops are not in competition their rank doesn't matter and therefore we only have icc-2 ranks corresponding to the remaining pfts. the first icc-4 are tree pfts and the last two are the c3 and c4 grasses.</p>
<p>Estimate colonization and mortality rate for each pft, except for crops whose fractional coverage is prescribed.</p>
<p>colonization rate (1/day). the factor (deltat/963.62) converts npp from u-mol co2-c/m2.sec -&gt; kg c/m2.day</p>
<p>mortality rate is the sum of growth related mortality, intrinsic mortality, and an additional mortality that kicks in when long term averaged bioclimatic conditions become unfavourable for a pft. this last term is based on the binary array pftexist.</p>
<p>&mdash;&gt; from here on we assume that we only have icc-numcrops pfts &lt;-&mdash; since crops are not part of the competition.</p>
<p>based on npp for each pft find the competition ranks / superiority order for simulating competition. note that crops are not in competition, so the competition is between the remaining pfts. in addition pfts which shouldn't exist in the grid cell because of unfavourable values of long-term climatic conditions are considered inferior.</p>
<p>bubble sort according to colonization rates NOTE - this only works if no tree species are indexed at positions &gt; numtreepfts, i.e. the trees must be a contiguous unit at the start of the indexes. JM Jun 2014</p>
<p>the rank of c3 and c4 grass is also determined on the basis of their npp but grasses are always assumed to be inferior to tree pfts</p>
<p>with the ranks of all pfts in all grid cells we can now simulate competition between them. for lotka-volterra eqns we need a minimum seeding fraction otherwise the pfts will not expand at all.</p>
<p>arrange colonization and mortality rates, and fractions, according to superiority ranks</p>
<p>update fractions and check if all fractions are +ve</p>
<p>with the minimum seeding fraction prescription, especially for lotka volterra eqns the total veg fraction may exceed 1. to prevent this we need to adjust fractional coverage of all non-crop pfts that do not have the minimum fraction.</p>
<p>check again that total veg frac doesn't exceed 1.</p>
<p>map delfrac to chngfrac so that we get change in fraction corresponding to the actual number of pfts</p>
<p>&mdash;&gt; from here on we get back to our usual icc pfts &lt;-&mdash;</p>
<p>get bare fraction</p>
<p>check if a pft's fractional cover is increasing or decreasing</p>
<p>check if bare fraction increases or decreases</p>
<p>now that we know the change in fraction for every pft we use its npp for spatial expansion and litter generation. we also spread vegetation biomass uniformly over the new fractions, and generate additional litter from mortality if the fractions decrease.</p>
<p>three things can happen here</p>
<ol type="1">
<li>fraciord = 0, which means all npp that was used for expansion becomes litter, due to self/expansion thinning and mortality.</li>
<li>fraciord = 1, which means a part of or full npp is used for expansion but some litter may also be generated. the part of npp that is used for expansion needs to be allocated to leaves, stem, and root. rather than doing this here we will let the allocation part handle this. so allocation module will allocate not only the npp that is used for pure vertical expansion but also this npp. but we will do our part here and spread the vegetation biomass over the new increased fraction.</li>
<li>fraciord = -1, which means all of the npp is to be used for litter generation but in addition some more litter will be generated from mortality of the standing biomass.</li>
</ol>
<p>All npp used for expansion becomes litter plus there is additional mortality of the standing biomass. the npp that becomes litter is now spread over the whole grid cell. all biomass from fraction that dies due to mortality is also distributed over the litter pool of whole grid cell.</p>
<p>if bare fraction decreases then chop off the litter and soil c from the decreased fraction and add it to grsumlit &amp; grsumsoc for spreading over the whole grid cell. if bare fraction increases then spread its litter and soil c uniformly over the increased fraction.</p>
<p>if a pft is not supposed to exist as indicated by pftexist and its fractional coverage is really small then get rid of the pft all together and spread its live and dead biomass over the grid cell.</p>
<p>adjust litter and soil c mass densities for increase in barefrac over the bare fraction.</p>
<p>spread litter and soil c over all pfts and the barefrac</p>
<p>get fcanmxs for use by class based on the new fcancmxs</p>
<p>update grid averaged vegetation biomass, and litter and soil c densities</p>
<p>and finally we check the c balance. we were supposed to use a fraction of npp for competition. some of it is used for expansion (this is what we save for allocation), and the rest becomes litter. so for each pft the total c mass in vegetation and litter pools must all add up to the same value as before competition.</p>
<p>check balance over the bare fraction </p>

</div>
</div>
<a class="anchor" id="a4345a1807f52b8da4f0cdd9f0f71f91f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public competition_scheme::existence </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc), intent(in)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican), intent(in)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>twarmm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>tcoldm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>gdd5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>aridity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>srplsmon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>defctmon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>anndefct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>annsrpls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>annpcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nilg,icc), intent(out)&#160;</td>
          <td class="paramname"><em>pftexist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nilg), intent(in)&#160;</td>
          <td class="paramname"><em>dry_season_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if a PFT can exist in a grid cell based on climatic conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iday</td><td>day of the year</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nilg</td><td>no. of grid cells in latitude circle (this is passed in as either ilg or nlat depending on mos/comp)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">il2</td><td>il2=nilg</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sort</td><td>index for correspondence between 9 ctem pfts and size 12 of parameter vectors</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">twarmm</td><td>temperature of the warmest month (c)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tcoldm</td><td>temperature of the coldest month (c)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gdd5</td><td>growing degree days above 5 c</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aridity</td><td>aridity index, ratio of potential evaporation to precipitation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">srplsmon</td><td>number of months in a year with surplus water i.e. precipitation more than potential evaporation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">defctmon</td><td>number of months in a year with water deficit i.e. precipitation less than potential evaporation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anndefct</td><td>annual water deficit (mm)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">annsrpls</td><td>annual water surplus (mm)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">annpcp</td><td>annual precipitation (mm)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dry_season_length</td><td>length of dry season (months)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pftexist</td><td>binary array indicating pfts exist (=1) or not (=0) </td></tr>
  </table>
  </dd>
</dl>
<hr/>
 <h2>Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters. ">ctem_params.f90</a> </h2>
<p>go through all grid cells and based on bioclimatic parameters decide if a given pft should exist or not.</p>
<p>needleleaf evergreen</p>
<p>needleleaf deciduous</p>
<p>broadleaf evergreen</p>
<p>broadleaf deciduous cold (see note below pft 5 too)</p>
<p>broadleaf deciduous dry</p>
<p>We don't want both broadleaf species co-existing so if it has PFT 5 remove PFT 4.</p>
<p>c3 and c4 crops</p>
<p>c3 grass</p>
<p>if(tcoldm(i).le.tcoldmax(sort(j)))then</p>
<p>else pftexist(i,j)=.false. endif</p>
<p>c4 grass</p>
<p>if(tcoldm(i).ge.tcoldmin(sort(j)))then</p>
<p>else pftexist(i,j)=.false. endif </p>

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li>src/competition_mod.f90</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classcompetition__scheme.html">competition_scheme</a></li>
    <li class="footer">Generated on Wed Dec 6 2017 17:10:34 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
