<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASSIC: src/PHTSYN3.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
   <div id="projectbrief">Canadian Land Surface Scheme including Biogeochemical Cycles</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('PHTSYN3_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">PHTSYN3.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b>Photosynthesis and canopy conductance</b>  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8dd455fd876b64b3effdeb9d98027471"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="PHTSYN3_8f.html#a8dd455fd876b64b3effdeb9d98027471">phtsyn3</a> (AILCG, FCANC, TCAN, CO2CONC, PRESSG, FC, CFLUX, QA, QSWV, IC, THLIQ, ISAND, TA, RMAT, COSZS, XDIFFUS, ILG, IL1, IL2, IG, ICC, ISNOW, SLAI, THFC, THLW, FCANCMX, L2MAX, NOL2PFTS, RC, CO2I1, CO2I2, AN_VEG, RML_VEG, DAYL, DAYL_MAX)</td></tr>
<tr class="separator:a8dd455fd876b64b3effdeb9d98027471"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b>Photosynthesis and canopy conductance</b> </p>
<p><b>Net photosynthesis</b></p>
<p>All biogeochemical processes in CLASSIC are simulated at a daily time step except gross photosynthetic uptake and associated calculation of canopy conductance, which are simulated on a half hour time step with CLASS (physics). The photosynthesis module of CLASSIC calculates the net canopy photosynthesis rate, which, together with atmospheric <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> concentration and vapour pressure or relative humidity, is used to calculate canopy conductance. This canopy conductance is then used by CLASSIC in its energy and water balance calculations.</p>
<p>The photosynthesis parametrization is based upon the approach of Farquhar et al. (1980) <a class="el" href="citelist.html#CITEREF_Farquhar1980-96e">[32]</a> and Collatz et al. (1991,1992) <a class="el" href="citelist.html#CITEREF_Collatz1991-5bc">[21]</a> <a class="el" href="citelist.html#CITEREF_Collatz1992-jf">[22]</a> as implemented in SiB2 (Sellers et al. 1996) <a class="el" href="citelist.html#CITEREF_Sellers1996-bh">[75]</a> and MOSES (Cox et al. 1999) <a class="el" href="citelist.html#CITEREF_Cox1999-ia">[25]</a> with some minor modifications as described in Arora (2003 )<a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a>. Arora (2003) <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a> outlines four possible configurations for the model based on choice of a <img class="formulaInl" alt="$\textit{big-leaf}$" src="form_1014.png"/> or <img class="formulaInl" alt="$\textit{two-leaf}$" src="form_1015.png"/> (sunlight and shaded leaves) mode and stomatal conductance formulations based on either Ball et a. (1987) <a class="el" href="citelist.html#CITEREF_Ball1987-ou">[13]</a> or Leuning (1995) <a class="el" href="citelist.html#CITEREF_Leuning1995-ab">[53]</a>. The Ball et al. (1987) <a class="el" href="citelist.html#CITEREF_Ball1987-ou">[13]</a> formulation uses relative humidity while Leuning (1995) <a class="el" href="citelist.html#CITEREF_Leuning1995-ab">[53]</a> uses vapour pressure deficit in calculation of canopy conductance. While the model remains capable of all four possible configurations, in practice, the model is usually run using the big-leaf parametrization with the stomatal conductance formulation of <a class="el" href="citelist.html#CITEREF_Leuning1995-ab">[53]</a>, which is the configuration described here. The original description of the CLASSIC photosynthesis parametrization in Arora (2003) <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a> did not include discussion of all the PFTs simulated by CLASSIC, which we expand upon here.</p>
<p>The gross leaf photosynthesis rate, <img class="formulaInl" alt="$G_\mathrm{o}$" src="form_1016.png"/>, depends upon the maximum assimilation rate allowed by the light ( <img class="formulaInl" alt="$J_\mathrm{e}$" src="form_1061.png"/>), Rubisco ( <img class="formulaInl" alt="$J_\mathrm{c}$" src="form_1017.png"/>) and transport capacity ( <img class="formulaInl" alt="$J_\mathrm{s}$" src="form_1018.png"/>). The limitation placed on <img class="formulaInl" alt="$G_\mathrm{o}$" src="form_1016.png"/> by the amount of available light is calculated as ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_766.png"/>)</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ J_\mathrm{e} = \varepsilon\,(1-{\nu})I \left[\frac{c_{i} - \Gamma}{c_{i} + 2\Gamma}\right], \quad C_3 plants \qquad (Eqn 1) \]" src="form_1639.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ J_\mathrm{e} = \varepsilon\,(1-{\nu})I,\quad C_4 plants,\qquad (Eqn 1) \]" src="form_1640.png"/>
</p>
<p>where <img class="formulaInl" alt="$I$" src="form_1020.png"/> is the incident photosynthetically active radiation ( <img class="formulaInl" alt="$PAR$" src="form_1021.png"/>; <img class="formulaInl" alt="$mol\,photons\,m^{-2}\,s^{-1}$" src="form_1022.png"/>), <img class="formulaInl" alt="${\nu}$" src="form_1023.png"/> is the leaf scattering coefficient, with values of 0.15 and 0.17 for <img class="formulaInl" alt="$C_3$" src="form_506.png"/> and <img class="formulaInl" alt="$C_4$" src="form_507.png"/> plants, respectively, and <img class="formulaInl" alt="$\varepsilon$" src="form_1024.png"/> is the quantum efficiency ( <img class="formulaInl" alt="$mol\,{CO_2}\,(mol\,photons)^{-1}$" src="form_1025.png"/>; values of 0.08 and 0.04 are used for <img class="formulaInl" alt="$C_3$" src="form_506.png"/> and <img class="formulaInl" alt="$C_4$" src="form_507.png"/> plants, respectively). <img class="formulaInl" alt="$c_\mathrm{i}$" src="form_1026.png"/> is the partial pressure of <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> in the leaf interior ( <img class="formulaInl" alt="$Pa$" src="form_1027.png"/>) and <img class="formulaInl" alt="$\Gamma$" src="form_1028.png"/> is the <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> compensation point ( <img class="formulaInl" alt="$Pa$" src="form_1027.png"/>) (described below).</p>
<p>The Rubisco enzyme limited photosynthesis rate, <img class="formulaInl" alt="$J_\mathrm{c}$" src="form_1017.png"/>, is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{J_c} J_\mathrm{c} = V_\mathrm{m} \left[\frac{c_\mathrm{i} - \Gamma}{c_\mathrm{i} + K_\mathrm{c}(1 + O_\mathrm{a}/K_\mathrm{o})}\right],\quad C_3 plants\qquad (Eqn 2) \]" src="form_1641.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ J_\mathrm{c} = V_\mathrm{m}, C_4 plants, \qquad (Eqn 2) \]" src="form_1642.png"/>
</p>
<p>where <img class="formulaInl" alt="$V_\mathrm{m}$" src="form_840.png"/> is the maximum catalytic capacity of Rubisco ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_766.png"/>), adjusted </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8dd455fd876b64b3effdeb9d98027471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dd455fd876b64b3effdeb9d98027471">&#9670;&nbsp;</a></span>phtsyn3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine phtsyn3 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>AILCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>FCANC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CO2CONC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PRESSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CFLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QSWV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ig)&#160;</td>
          <td class="paramname"><em>RMAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>COSZS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>XDIFFUS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ISNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>SLAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>FCANCMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>L2MAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ic)&#160;</td>
          <td class="paramname"><em>NOL2PFTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>CO2I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>CO2I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>AN_VEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>RML_VEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>DAYL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>DAYL_MAX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ilg</td><td>NO. OF GRID CELLS IN LATITUDE CIRCLE</td></tr>
    <tr><td class="paramname">ic</td><td>NO. OF CLASS VEGETATION TYPES, 4</td></tr>
    <tr><td class="paramname">il1</td><td>IL1=1</td></tr>
    <tr><td class="paramname">il2</td><td>IL2=ILG</td></tr>
    <tr><td class="paramname">ig</td><td>NO. OF SOIL LAYERS, 3</td></tr>
    <tr><td class="paramname">icc</td><td>NO. OF CTEM's PFTs, CURRENTLY 9</td></tr>
    <tr><td class="paramname">isnow</td><td>INTEGER (0 or 1) TELLING IF PHTSYN IS TO BE RUN OVER CANOPY OVER SNOW OR CANOPY OVER GROUND SUBAREA</td></tr>
    <tr><td class="paramname">l2max</td><td>MAX. NUMBER OF LEVEL 2 PFTs</td></tr>
    <tr><td class="paramname">fcanc</td><td>FRACTIONAL COVERAGE OF CTEM's 9 PFTs</td></tr>
    <tr><td class="paramname">ailcg</td><td>GREEN LEAF AREA INDEX FOR USE BY PHOTOSYNTHESIS, <img class="formulaInl" alt="$M^2/M^2$" src="form_1100.png"/></td></tr>
    <tr><td class="paramname">tcan</td><td>CANOPY TEMPERATURE, KELVIN</td></tr>
    <tr><td class="paramname">fc</td><td>SUM OF ALL FCANC OVER A GIVEN SUB-AREA</td></tr>
    <tr><td class="paramname">cflux</td><td>AERODYNAMIC CONDUCTANCE, M/S</td></tr>
    <tr><td class="paramname">slai</td><td>SCREEN LEVEL HUMIDITY IN KG/KG - STORAGE LAI. THIS LAI IS USED FOR PHTSYN EVEN IF ACTUAL LAI IS ZERO. ESTIMATE OF NET PHOTOSYNTHESIS BASED ON SLAI IS USED FOR INITIATING LEAF ONSET. SEE PHENOLGY SUBROUTINE FOR MORE DETAILS.</td></tr>
    <tr><td class="paramname">co2conc</td><td>ATMOS. <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> IN PPM, AND THEN CONVERT IT TO PARTIAL PRESSURE, PASCALS, CO2A, FOR USE IN THIS SUBROUTINE</td></tr>
    <tr><td class="paramname">pressg</td><td>ATMOS. PRESSURE, PASCALS</td></tr>
    <tr><td class="paramname">rml_veg</td><td>LEAF RESPIRATION RATE, ( <img class="formulaInl" alt="$\mu mol CO_2 m^{-2} s^{-1}$" src="form_1671.png"/>) FOR EACH PFT</td></tr>
    <tr><td class="paramname">an_veg</td><td>NET PHOTOSYNTHESIS RATE, ( <img class="formulaInl" alt="$\mu mol CO_2 m^{-2} s^{-1}$" src="form_1671.png"/>) FOR EACH PFT</td></tr>
    <tr><td class="paramname">qswv</td><td>ABSORBED VISIBLE PART OF SHORTWAVE RADIATION, <img class="formulaInl" alt="$W/M^2$" src="form_1101.png"/></td></tr>
    <tr><td class="paramname">ta</td><td>AIR TEMPERATURE IN KELVINS</td></tr>
    <tr><td class="paramname">rmat</td><td>FRACTION OF ROOTS IN EACH LAYER (grid cell, vegetation, layer)</td></tr>
    <tr><td class="paramname">co2i1</td><td>INTERCELLULAR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONCENTRATION FROM THE PREVIOUS TIME STEP WHICH GETS UPDATED FOR THE SINGLE LEAF OR THE SUNLIT PART OF THE TWO LEAF MODEL</td></tr>
    <tr><td class="paramname">co2i2</td><td>INTERCELLULAR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONCENTRATION FOR THE SHADED PART OF THE TWO LEAF MODEL FROM THE PREVIOUS TIME STEP</td></tr>
    <tr><td class="paramname">thliq</td><td>LIQUID MOIS. CONTENT OF 3 SOIL LAYERS</td></tr>
    <tr><td class="paramname">thfc</td><td>SOIL FIELD CAPACITY.</td></tr>
    <tr><td class="paramname">thlw</td><td>SOIL WILT CAPACITY.</td></tr>
    <tr><td class="paramname">fcancmx</td><td>MAX. FRACTIONAL COVERAGES OF CTEM's 8 PFTs. THIS IS DIFFERENT FROM FCANC AND FCANCS (WHICH MAY VARY WITH SNOW DEPTH). FCANCMX DOESN'T CHANGE, UNLESS OF COURSE ITS CHANGED BY LAND USE CHANGE OR DYNAMIC VEGETATION.</td></tr>
    <tr><td class="paramname">rc</td><td>GRID-AVERAGED STOMATAL RESISTANCE, S/M</td></tr>
    <tr><td class="paramname">coszs</td><td>COS OF ZENITH ANGLE</td></tr>
    <tr><td class="paramname">xdiffus</td><td>FRACTION OF DIFFUSED PAR</td></tr>
    <tr><td class="paramname">isand</td><td>SAND INDEX.</td></tr>
    <tr><td class="paramname">dayl_max</td><td>MAXIMUM DAYLENGTH FOR THAT LOCATION</td></tr>
    <tr><td class="paramname">dayl</td><td>DAYLENGTH FOR THAT LOCATION </td></tr>
  </table>
  </dd>
</dl>
<p>IF LAI IS LESS THAN SLAI THAN WE USE STORAGE LAI TO PHOTOSYNTHESIZE. HOWEVER, WE DO NOT USE THE STOMATAL RESISTANCE ESTIMATED IN THIS CASE, BECAUSE STORAGE LAI IS AN IMAGINARY LAI, AND WE SET STOMATAL RESISTANCE TO ITS MAX. NOTE THAT THE CONCEPT OF STORAGE/IMAGINARY LAI IS USED FOR PHENOLOGY PURPOSES AND THIS IMAGINARY LAI ACTS AS MODEL SEEDS.</p>
<p>SET MIN. AND MAX. VALUES FOR STOMATAL CONDUCTANCE. WE MAKE SURE THAT MAX. STOMATAL RESISTANCE IS AROUND 5000 S/M AND MIN. STOMATAL RESISTANCE IS 51 S/M.</p>
<p>IF WE ARE USING LEUNING TYPE PHOTOSYNTHESIS-STOMATAL CONDUCTANCE COUPLING WE NEED VAPOR PRESSURE DEFICIT AS WELL. CALCULATE THIS FROM THE RH AND AIR TEMPERATURE WE HAVE. WE FIND E_SAT, E, AND VPD IN PASCALS.</p>
<p>ESTIMATE PARTIAL PRESSURE OF <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> AND IPAR</p>
<p>CONVERT CO2CONC FROM PPM TO PASCALS</p>
<p>CHANGE PAR FROM W/M^2 TO MOL/M^2.S</p>
<p>SUNLIT PART GETS BOTH DIRECT AND DIFFUSED, WHILE THE SHADED PART GETS ONLY DIFFUSED</p>
<p>FOR TWO-LEAF MODEL FIND Kb AS A FUNCTION OF COSZS AND LEAF ANGLE DISTRIBUTION (VEGETATION DEPENDENT)</p>
<p>MAKE SURE -0.4 &lt; CHI &lt; 0.6</p>
<p>MAKE VALUES CLOSE TO ZERO EQUAL TO 0.01</p>
<p>ALSO FIND SUNLIT AND SHADED LAI</p>
<p>FOLLOWING FEW LINES TO MAKE SURE THAT ALL LEAVES ARE SHADED WHEN XDIFFUS EQUALS 1. NOT DOING SO GIVES ERRATIC RESULTS WHEN TWO LEAF OPTION IS USED</p>
<p>FIND FPAR - FACTOR FOR SCALING PHOTOSYNTHESIS TO CANOPY BASED ON ASSUMPTION THAT NITROGEN IS OPTIMALLY DISTRIBUTED. THE TWO-LEAF MODEL IS NOT THAT DIFFERENT FROM THE SINGLE-LEAF MODEL. ALL WE DO IS USE TWO SCALING FACTORS (I.E. SCALING FROM LEAF TO CANOPY) INSTEAD OF ONE, AND THUS PERFORM CALCULATIONS TWICE, AND IN THE END ADD CONDUCTANCE AND NET PHOTOSYNTHESIS FROM THE TWO LEAVES TO GET THE TOTAL.</p>
<p>IF ALL RADIATION IS DIFFUSED, THEN ALL LEAVES ARE SHADED, AND WE ADJUST FPARs ACCORDINGLY. WITHOUT THIS THE TWO LEAF MODELS MAY BEHAVE ERRATICALLY</p>
<p>FIND Vmax,canopy, THAT IS Vmax SCALED BY LAI FOR THE SINGLE LEAF MODEL</p>
<p>-&mdash;&mdash;&mdash;&mdash; Changing Vcmax seasonally &ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>
<p>Based on <a class="el" href="citelist.html#CITEREF_Bauerle2012-c29">[16]</a> and <a class="el" href="citelist.html#CITEREF_Alton2017-pd">[3]</a> there is good evidence for the Vcmax varying throughout the season for deciduous tree species. We are adopting a parameterization based upon their paper with some differences. We don't apply it to evergreens like they suggest. Their paper had only one evergreen species and other papers (<a class="el" href="citelist.html#CITEREF_Miyazawa2006-so">[64]</a>) don't seem to back that up. Grasses and crops are also not affected by the dayl. <a class="el" href="citelist.html#CITEREF_Alton2017-pd">[3]</a> seems to indicate that all PFTs except BDL-EVG tropical should vary intra-annually (see their figure 8).</p>
<p>The two leaf is assumed to be affect by the insolation seasonal cycle the same for each sun/shade leaf</p>
<p>-&mdash;&mdash;&mdash;&mdash; Changing Vcmax seasonally &ndash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;///</p>
<p>FIND Vm,unstressed (DUE TO WATER) BUT STRESSED DUE TO TEMPERATURE</p>
<p>ASSUMING THAT SUNLIT AND SHADED TEMPERATURES ARE SAME</p>
<p>CALCULATE SOIL MOIS STRESS TO ACCOUNT FOR REDUCTION IN PHOTOSYN DUE TO LOW SOIL MOISTURE, THREE STEPS HERE -&gt; 1. FIND WILTING POINT AND FIELD CAPACITY SOIL MOIS. CONTENT FOR ALL THREE LAYERS.</p><ol type="1">
<li>USING THESE FIND THE SOIL MOISTURE STRESS TERM FOR ALL THREE LAYERS, AND 3. AVERAGE THIS SOIL MOISTURE STRESS TERM OVER THE 3 LAYERS USING FRACTION OF ROOTS PRESENT IN EACH LAYER FOR EACH PFT. NOTE THAT WHILE SOIL MOISTURE IS UNIFORM OVER AN ENTIRE GCM GRID CELL, THE SOIL MOISTURE STRESS FOR EACH PFT IS NOT BECAUSE OF DIFFERENCES IN ROOT DISTRIBUTION.</li>
</ol>
<p>WILTING POINT CORRESPONDS TO MATRIC POTENTIAL OF 150 M FIELD CAPACITY CORRESPONDS TO HYDARULIC CONDUCTIVITY OF 0.10 MM/DAY -&gt; 1.157x1E-09 M/S</p>
<p>USE SOIL MOISTURE FUNCTION TO MAKE Vm,unstressed -&gt; Vm STRESSED</p>
<p>FIND TEMPERATURE DEPENDENT PARAMETER VALUES</p>
<p>FIND RUBISCO SPECIFICITY FOR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> RELATIVE TO <img class="formulaInl" alt="$O_2$" src="form_1032.png"/> - SIGMA</p>
<p>FIND <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> COMPENSATION POINT USING RUBISCO SPECIFICITY - TGAMMA. KEEP IN MIND THAT <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> COMPENSATION POINT FOR C4 PLANTS IS ZERO, SO THE FOLLOWING VALUE IS RELEVANT FOR C3 PLANTS ONLY</p>
<p>ESTIMATE MICHELIS-MENTON CONSTANTS FOR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> (Kc) and <img class="formulaInl" alt="$O_2$" src="form_1032.png"/> (Ko) TO BE USED LATER FOR ESTIMATING RUBISCO LIMITED PHOTOSYNTHETIC RATE</p>
<p>CHOOSE A VALUE OF INTERCELLULAR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONCENTRATION <img class="formulaInl" alt="$(CO_2i)$" src="form_1102.png"/> IF STARTING FOR THE FIRST TIME, OR USE VALUE FROM THE PREVIOUS TIME STEP</p>
<p>ESTIMATE RUBISCO LIMITED PHOTOSYNTHETIC RATE</p>
<p>ESTIMATE PHOTOSYNTHETIC RATE LIMITED BY AVAILABLE LIGHT</p>
<p>ESTIMATE PHOTOSYNTHETIC RATE LIMITED BY TRANSPORT CAPACITY</p>
<p>INCLUDE NUTRIENT LIMITATION EFFECT BY DOWN-REGULATING PHOTOSYNTHESIS N_EFFECT DECREASES FROM 1.0 AS <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> INCREASES ABOVE 288 PPM.</p>
<p>LIMIT N_EFFECT TO MAX OF 1.0 SO THAT NO UP-REGULATION OCCURS</p>
<p>FIND THE SMOOTHED AVERAGE OF THREE PHOTOSYNTHETIC RATES JC, JE, AND JS USING COLLATZ'S TWO QUADRATIC EQUATIONS, OR FIND THE MIN. OF THIS TWO RATES OR FIND MIN. OF JC AND JE.</p>
<p>DOWN-REGULATE PHOTOSYNTHESIS FOR C3 PLANTS</p>
<p>ESTIMATE LEAF MAINTENANCE RESPIRATION RATES AND NET PHOTOSYNTHETIC RATE. THIS NET PHOSYNTHETIC RATE IS /M^2 OF VEGETATED LAND.</p>
<p>RECENT STUDIES SHOW RmL IS LESS TEMPERATURE SENSITIVE THAN PHOTOSYNTHESIS DURING DAY, THAT'S WHY A SMALL Q10 VALUE IS USED DURING DAY.</p>
<p>FIND <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONCENTRATION AT LEAF SURFACE FOR ALL VEGETATION TYPES. ALTHOUGH WE ARE FINDING <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONC AT THE LEAF SURFACE SEPARATELY FOR ALL VEGETATION TYPES, THE BIG ASSUMPTION HERE IS THAT THE AERODYNAMIC CONDUCTANCE IS SAME OVER ALL VEGETATION TYPES. CLASS FINDS AERODYNAMIC RESISTANCE OVER ALL THE 4 SUB-AREAS, BUT NOT FOR DIFFERENT VEGETATION TYPES WITHIN A SUB-AREA. ALSO CHANGE AERODYNAMIC CONDUCTANCE, CFLUX, FROM M/S TO <img class="formulaInl" alt="$MOL/M^2/S$" src="form_1103.png"/></p>
<p>FIND STOMATAL CONDUCTANCE AS PER BALL-WOODROW-BERRY FORMULATION USED BY COLLATZ ET AL. OR USE THE LEUNING TYPE FORMULATION WHICH USES VPD INSTEAD OF RH</p>
<p>IF LIGHT IS TOO LESS MAKE PARAMETER BB VERY SMALL</p>
<p>FIND THE INTERCELLULAR <img class="formulaInl" alt="$CO_2$" src="form_545.png"/> CONCENTRATION BASED ON ESTIMATED VALUE OF GC</p>
<p>SEE IF WE HAVE PERFORMED THE REQUIRED NO. OF ITERATIONS, IF NOT THEN WE GO BACK AND DO ANOTHER ITERATION</p>
<p>WHEN REQUIRED NO. OF ITERATIONS HAVE BEEN PERFORMED THEN FIND STOMATAL CONDUCTANCES FOR ALL VEGETATION TYPES IN M/S AND THEN USE CONDUCTANCES TO FIND RESISTANCES. GCTU IMPLIES GC IN TRADITIONAL UNITS OF M/S</p>
<p>DON'T WANT TO REDUCE RESISTANCE AT NIGHT TO LESS THAN OUR MAX. VALUE OF AROUND 5000 S/M</p>
<p>IF USING STORAGE LAI THEN WE SET STOMATAL RESISTANCE TO ITS MAXIMUM VALUE.</p>
<p>AND FINALLY TAKE WEIGHTED AVERAGE OF RC_VEG BASED ON FRACTIONAL COVERAGE OF OUR 4 VEGETATION TYPES</p>
<p>CONVERT AN_VEG AND RML_VEG TO u-MOL CO2/M2.SEC</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="PHTSYN3_8f.html">PHTSYN3.f</a></li>
    <li class="footer">Generated on Thu Jul 4 2019 12:03:55 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
