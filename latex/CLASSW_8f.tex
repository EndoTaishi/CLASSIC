\hypertarget{CLASSW_8f}{}\section{C\+L\+A\+S\+S\+W.\+f File Reference}
\label{CLASSW_8f}\index{C\+L\+A\+S\+S\+W.\+f@{C\+L\+A\+S\+S\+W.\+f}}


Purpose\+: Call subroutines to perform surface water budget calculations.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{CLASSW_8f_aac1827011ed2ca61bd0274e83d1f80ad}{classw} (T\+H\+L\+I\+Q, T\+H\+I\+C\+E, T\+B\+A\+R, T\+C\+A\+N, R\+C\+A\+N, S\+N\+C\+A\+N, R\+U\+N\+O\+F\+F, T\+R\+U\+N\+O\+F, S\+N\+O, T\+S\+N\+O\+W, R\+H\+O\+S\+N\+O, A\+L\+B\+S\+N\+O, W\+S\+N\+O\+W, Z\+P\+O\+N\+D, T\+P\+O\+N\+D, G\+R\+O\+W\+T\+H, T\+B\+A\+S\+E, G\+F\+L\+U\+X, P\+C\+F\+C, P\+C\+L\+C, P\+C\+P\+N, P\+C\+P\+G, Q\+F\+C\+F, Q\+F\+C\+L, Q\+F\+N, Q\+F\+G, Q\+F\+C, H\+M\+F\+C, H\+M\+F\+G, H\+M\+F\+N, H\+T\+C\+C, H\+T\+C\+S, H\+T\+C, R\+O\+F\+C, R\+O\+F\+N, R\+O\+V\+G, W\+T\+R\+S, W\+T\+R\+G, O\+V\+R\+F\+L\+W, S\+U\+B\+F\+L\+W, B\+A\+S\+F\+L\+W, T\+O\+V\+R\+F\+L, T\+S\+U\+B\+F\+L, T\+B\+A\+S\+F\+L, E\+V\+A\+P, Q\+F\+L\+U\+X, R\+H\+O\+A\+I\+R, T\+B\+A\+R\+C, T\+B\+A\+R\+G, T\+B\+A\+R\+C\+S, T\+B\+A\+R\+G\+S, T\+H\+L\+I\+Q\+C, T\+H\+L\+I\+Q\+G, T\+H\+I\+C\+E\+C, T\+H\+I\+C\+E\+G, H\+C\+P\+C, H\+C\+P\+G, R\+P\+C\+P, T\+R\+P\+C\+P, S\+P\+C\+P, T\+S\+P\+C\+P, P\+C\+P\+R, T\+A, R\+H\+O\+S\+N\+I, G\+G\+E\+O, F\+C, F\+G, F\+C\+S, F\+G\+S, T\+P\+O\+N\+D\+C, T\+P\+O\+N\+D\+G, T\+P\+N\+D\+C\+S, T\+P\+N\+D\+G\+S, E\+V\+A\+P\+C, E\+V\+A\+P\+C\+G, E\+V\+A\+P\+G, E\+V\+A\+P\+C\+S, E\+V\+P\+C\+S\+G, E\+V\+A\+P\+G\+S, Q\+F\+R\+E\+Z\+C, Q\+F\+R\+E\+Z\+G, Q\+M\+E\+L\+T\+C, Q\+M\+E\+L\+T\+G, R\+A\+I\+C\+A\+N, S\+N\+O\+C\+A\+N, R\+A\+I\+C\+N\+S, S\+N\+O\+C\+N\+S, F\+S\+V\+F, F\+S\+V\+F\+S, C\+W\+L\+C\+A\+P, C\+W\+F\+C\+A\+P, C\+W\+L\+C\+P\+S, C\+W\+F\+C\+P\+S, T\+C\+A\+N\+O, T\+C\+A\+N\+S, C\+H\+C\+A\+P, C\+H\+C\+A\+P\+S, C\+M\+A\+S\+S\+C, C\+M\+A\+S\+C\+S, Z\+S\+N\+O\+W, G\+Z\+E\+R\+O\+C, G\+Z\+E\+R\+O\+G, G\+Z\+R\+O\+C\+S, G\+Z\+R\+O\+G\+S, G12\+C, G12\+G, G12\+C\+S, G12\+G\+S, G23\+C, G23\+G, G23\+C\+S, G23\+G\+S, T\+S\+N\+O\+C\+S, T\+S\+N\+O\+G\+S, W\+S\+N\+O\+C\+S, W\+S\+N\+O\+G\+S, R\+H\+O\+S\+C\+S, R\+H\+O\+S\+G\+S, Z\+P\+L\+I\+M\+C, Z\+P\+L\+I\+M\+G, Z\+P\+L\+M\+C\+S, Z\+P\+L\+M\+G\+S, T\+S\+F\+S\+A\+V, T\+C\+T\+O\+P\+C, T\+C\+B\+O\+T\+C, T\+C\+T\+O\+P\+G, T\+C\+B\+O\+T\+G, F\+R\+O\+O\+T, F\+R\+O\+O\+T\+S, T\+H\+P\+O\+R, T\+H\+L\+R\+E\+T, T\+H\+L\+M\+I\+N, B\+I, P\+S\+I\+S\+A\+T, G\+R\+K\+S\+A\+T, T\+H\+L\+R\+A\+T, T\+H\+F\+C, X\+D\+R\+A\+I\+N, H\+C\+P\+S, D\+E\+L\+Z, D\+E\+L\+Z\+W, Z\+B\+O\+T\+W, X\+S\+L\+O\+P\+E, G\+R\+K\+F\+A\+C, W\+F\+S\+U\+R\+F, W\+F\+C\+I\+N\+T, I\+S\+A\+N\+D, I\+G\+D\+R, I\+W\+F, I\+L\+G, I\+L1, I\+L2, N, J\+L, I\+C, I\+G, I\+G\+P1, I\+G\+P2, N\+L\+A\+N\+D\+C\+S, N\+L\+A\+N\+D\+G\+S, N\+L\+A\+N\+D\+C, N\+L\+A\+N\+D\+G, N\+L\+A\+N\+D\+I)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Purpose\+: Call subroutines to perform surface water budget calculations. 



\subsection{Function/\+Subroutine Documentation}
\hypertarget{CLASSW_8f_aac1827011ed2ca61bd0274e83d1f80ad}{}\index{C\+L\+A\+S\+S\+W.\+f@{C\+L\+A\+S\+S\+W.\+f}!classw@{classw}}
\index{classw@{classw}!C\+L\+A\+S\+S\+W.\+f@{C\+L\+A\+S\+S\+W.\+f}}
\subsubsection[{classw}]{\setlength{\rightskip}{0pt plus 5cm}subroutine classw (
\begin{DoxyParamCaption}
\item[{real, dimension (ilg,ig)}]{T\+H\+L\+I\+Q, }
\item[{real, dimension (ilg,ig)}]{T\+H\+I\+C\+E, }
\item[{real, dimension  (ilg,ig)}]{T\+B\+A\+R, }
\item[{real, dimension  (ilg)}]{T\+C\+A\+N, }
\item[{real, dimension  (ilg)}]{R\+C\+A\+N, }
\item[{real, dimension (ilg)}]{S\+N\+C\+A\+N, }
\item[{real, dimension(ilg)}]{R\+U\+N\+O\+F\+F, }
\item[{real, dimension(ilg)}]{T\+R\+U\+N\+O\+F, }
\item[{real, dimension   (ilg)}]{S\+N\+O, }
\item[{real, dimension (ilg)}]{T\+S\+N\+O\+W, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+N\+O, }
\item[{real, dimension(ilg)}]{A\+L\+B\+S\+N\+O, }
\item[{real, dimension (ilg)}]{W\+S\+N\+O\+W, }
\item[{real, dimension (ilg)}]{Z\+P\+O\+N\+D, }
\item[{real, dimension (ilg)}]{T\+P\+O\+N\+D, }
\item[{real, dimension(ilg)}]{G\+R\+O\+W\+T\+H, }
\item[{real, dimension (ilg)}]{T\+B\+A\+S\+E, }
\item[{real, dimension (ilg,ig)}]{G\+F\+L\+U\+X, }
\item[{real, dimension  (ilg)}]{P\+C\+F\+C, }
\item[{real, dimension  (ilg)}]{P\+C\+L\+C, }
\item[{real, dimension  (ilg)}]{P\+C\+P\+N, }
\item[{real, dimension  (ilg)}]{P\+C\+P\+G, }
\item[{real, dimension  (ilg)}]{Q\+F\+C\+F, }
\item[{real, dimension  (ilg)}]{Q\+F\+C\+L, }
\item[{real, dimension   (ilg)}]{Q\+F\+N, }
\item[{real, dimension   (ilg)}]{Q\+F\+G, }
\item[{real, dimension  (ilg,ig)}]{Q\+F\+C, }
\item[{real, dimension  (ilg)}]{H\+M\+F\+C, }
\item[{real, dimension (ilg,ig)}]{H\+M\+F\+G, }
\item[{real, dimension  (ilg)}]{H\+M\+F\+N, }
\item[{real, dimension  (ilg)}]{H\+T\+C\+C, }
\item[{real, dimension  (ilg)}]{H\+T\+C\+S, }
\item[{real, dimension  (ilg,ig)}]{H\+T\+C, }
\item[{real, dimension  (ilg)}]{R\+O\+F\+C, }
\item[{real, dimension  (ilg)}]{R\+O\+F\+N, }
\item[{real, dimension  (ilg)}]{R\+O\+V\+G, }
\item[{real, dimension  (ilg)}]{W\+T\+R\+S, }
\item[{real, dimension  (ilg)}]{W\+T\+R\+G, }
\item[{real, dimension(ilg)}]{O\+V\+R\+F\+L\+W, }
\item[{real, dimension(ilg)}]{S\+U\+B\+F\+L\+W, }
\item[{real, dimension(ilg)}]{B\+A\+S\+F\+L\+W, }
\item[{real, dimension(ilg)}]{T\+O\+V\+R\+F\+L, }
\item[{real, dimension(ilg)}]{T\+S\+U\+B\+F\+L, }
\item[{real, dimension(ilg)}]{T\+B\+A\+S\+F\+L, }
\item[{real, dimension  (ilg)}]{E\+V\+A\+P, }
\item[{real, dimension (ilg)}]{Q\+F\+L\+U\+X, }
\item[{real, dimension (ilg)}]{R\+H\+O\+A\+I\+R, }
\item[{real, dimension(ilg,ig)}]{T\+B\+A\+R\+C, }
\item[{real, dimension(ilg,ig)}]{T\+B\+A\+R\+G, }
\item[{real, dimension(ilg,ig)}]{T\+B\+A\+R\+C\+S, }
\item[{real, dimension(ilg,ig)}]{T\+B\+A\+R\+G\+S, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+I\+Q\+C, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+I\+Q\+G, }
\item[{real, dimension(ilg,ig)}]{T\+H\+I\+C\+E\+C, }
\item[{real, dimension(ilg,ig)}]{T\+H\+I\+C\+E\+G, }
\item[{real, dimension  (ilg,ig)}]{H\+C\+P\+C, }
\item[{real, dimension  (ilg,ig)}]{H\+C\+P\+G, }
\item[{real, dimension  (ilg)}]{R\+P\+C\+P, }
\item[{real, dimension (ilg)}]{T\+R\+P\+C\+P, }
\item[{real, dimension  (ilg)}]{S\+P\+C\+P, }
\item[{real, dimension (ilg)}]{T\+S\+P\+C\+P, }
\item[{real, dimension  (ilg)}]{P\+C\+P\+R, }
\item[{real, dimension    (ilg)}]{T\+A, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+N\+I, }
\item[{real, dimension  (ilg)}]{G\+G\+E\+O, }
\item[{real, dimension    (ilg)}]{F\+C, }
\item[{real, dimension    (ilg)}]{F\+G, }
\item[{real, dimension   (ilg)}]{F\+C\+S, }
\item[{real, dimension   (ilg)}]{F\+G\+S, }
\item[{real, dimension(ilg)}]{T\+P\+O\+N\+D\+C, }
\item[{real, dimension(ilg)}]{T\+P\+O\+N\+D\+G, }
\item[{real, dimension(ilg)}]{T\+P\+N\+D\+C\+S, }
\item[{real, dimension(ilg)}]{T\+P\+N\+D\+G\+S, }
\item[{real, dimension (ilg)}]{E\+V\+A\+P\+C, }
\item[{real, dimension(ilg)}]{E\+V\+A\+P\+C\+G, }
\item[{real, dimension (ilg)}]{E\+V\+A\+P\+G, }
\item[{real, dimension(ilg)}]{E\+V\+A\+P\+C\+S, }
\item[{real, dimension(ilg)}]{E\+V\+P\+C\+S\+G, }
\item[{real, dimension(ilg)}]{E\+V\+A\+P\+G\+S, }
\item[{real, dimension(ilg)}]{Q\+F\+R\+E\+Z\+C, }
\item[{real, dimension(ilg)}]{Q\+F\+R\+E\+Z\+G, }
\item[{real, dimension(ilg)}]{Q\+M\+E\+L\+T\+C, }
\item[{real, dimension(ilg)}]{Q\+M\+E\+L\+T\+G, }
\item[{real, dimension(ilg)}]{R\+A\+I\+C\+A\+N, }
\item[{real, dimension(ilg)}]{S\+N\+O\+C\+A\+N, }
\item[{real, dimension(ilg)}]{R\+A\+I\+C\+N\+S, }
\item[{real, dimension(ilg)}]{S\+N\+O\+C\+N\+S, }
\item[{real, dimension  (ilg)}]{F\+S\+V\+F, }
\item[{real, dimension (ilg)}]{F\+S\+V\+F\+S, }
\item[{real, dimension(ilg)}]{C\+W\+L\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+W\+F\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+W\+L\+C\+P\+S, }
\item[{real, dimension(ilg)}]{C\+W\+F\+C\+P\+S, }
\item[{real, dimension (ilg)}]{T\+C\+A\+N\+O, }
\item[{real, dimension (ilg)}]{T\+C\+A\+N\+S, }
\item[{real, dimension (ilg)}]{C\+H\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+H\+C\+A\+P\+S, }
\item[{real, dimension(ilg)}]{C\+M\+A\+S\+S\+C, }
\item[{real, dimension(ilg)}]{C\+M\+A\+S\+C\+S, }
\item[{real, dimension (ilg)}]{Z\+S\+N\+O\+W, }
\item[{real, dimension(ilg)}]{G\+Z\+E\+R\+O\+C, }
\item[{real, dimension(ilg)}]{G\+Z\+E\+R\+O\+G, }
\item[{real, dimension(ilg)}]{G\+Z\+R\+O\+C\+S, }
\item[{real, dimension(ilg)}]{G\+Z\+R\+O\+G\+S, }
\item[{real, dimension  (ilg)}]{G12\+C, }
\item[{real, dimension  (ilg)}]{G12\+G, }
\item[{real, dimension (ilg)}]{G12\+C\+S, }
\item[{real, dimension (ilg)}]{G12\+G\+S, }
\item[{real, dimension  (ilg)}]{G23\+C, }
\item[{real, dimension  (ilg)}]{G23\+G, }
\item[{real, dimension (ilg)}]{G23\+C\+S, }
\item[{real, dimension (ilg)}]{G23\+G\+S, }
\item[{real, dimension(ilg)}]{T\+S\+N\+O\+C\+S, }
\item[{real, dimension(ilg)}]{T\+S\+N\+O\+G\+S, }
\item[{real, dimension(ilg)}]{W\+S\+N\+O\+C\+S, }
\item[{real, dimension(ilg)}]{W\+S\+N\+O\+G\+S, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+C\+S, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+G\+S, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+I\+M\+C, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+I\+M\+G, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+C\+S, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+G\+S, }
\item[{real, dimension(ilg,4)}]{T\+S\+F\+S\+A\+V, }
\item[{real, dimension(ilg,ig)}]{T\+C\+T\+O\+P\+C, }
\item[{real, dimension(ilg,ig)}]{T\+C\+B\+O\+T\+C, }
\item[{real, dimension(ilg,ig)}]{T\+C\+T\+O\+P\+G, }
\item[{real, dimension(ilg,ig)}]{T\+C\+B\+O\+T\+G, }
\item[{real, dimension (ilg,ig)}]{F\+R\+O\+O\+T, }
\item[{real, dimension (ilg,ig)}]{F\+R\+O\+O\+T\+S, }
\item[{real, dimension (ilg,ig)}]{T\+H\+P\+O\+R, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+R\+E\+T, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+M\+I\+N, }
\item[{real, dimension    (ilg,ig)}]{B\+I, }
\item[{real, dimension(ilg,ig)}]{P\+S\+I\+S\+A\+T, }
\item[{real, dimension(ilg,ig)}]{G\+R\+K\+S\+A\+T, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+R\+A\+T, }
\item[{real, dimension  (ilg,ig)}]{T\+H\+F\+C, }
\item[{real, dimension(ilg)}]{X\+D\+R\+A\+I\+N, }
\item[{real, dimension  (ilg,ig)}]{H\+C\+P\+S, }
\item[{real, dimension  (ig)}]{D\+E\+L\+Z, }
\item[{real, dimension (ilg,ig)}]{D\+E\+L\+Z\+W, }
\item[{real, dimension (ilg,ig)}]{Z\+B\+O\+T\+W, }
\item[{real, dimension(ilg)}]{X\+S\+L\+O\+P\+E, }
\item[{real, dimension(ilg)}]{G\+R\+K\+F\+A\+C, }
\item[{real, dimension(ilg)}]{W\+F\+S\+U\+R\+F, }
\item[{real, dimension(ilg)}]{W\+F\+C\+I\+N\+T, }
\item[{integer, dimension(ilg,ig)}]{I\+S\+A\+N\+D, }
\item[{integer, dimension  (ilg)}]{I\+G\+D\+R, }
\item[{integer}]{I\+W\+F, }
\item[{integer}]{I\+L\+G, }
\item[{integer}]{I\+L1, }
\item[{integer}]{I\+L2, }
\item[{integer}]{N, }
\item[{integer}]{J\+L, }
\item[{integer}]{I\+C, }
\item[{integer}]{I\+G, }
\item[{integer}]{I\+G\+P1, }
\item[{integer}]{I\+G\+P2, }
\item[{integer}]{N\+L\+A\+N\+D\+C\+S, }
\item[{integer}]{N\+L\+A\+N\+D\+G\+S, }
\item[{integer}]{N\+L\+A\+N\+D\+C, }
\item[{integer}]{N\+L\+A\+N\+D\+G, }
\item[{integer}]{N\+L\+A\+N\+D\+I}
\end{DoxyParamCaption}
)}\label{CLASSW_8f_aac1827011ed2ca61bd0274e83d1f80ad}

\begin{DoxyParams}{Parameters}
{\em iwf} & Flag governing lateral soil water flow calculations\\
\hline
{\em nlandcs} & Number of modelled areas that contain subareas of canopy over snow\\
\hline
{\em nlandgs} & Number of modelled areas that contain subareas of snow\\
\hline
{\em nlandc} & Number of modelled areas that contain subareas of canopy over bare ground\\
\hline
{\em nlandg} & Number of modelled areas that contain subareas of bare ground\\
\hline
{\em nlandi} & Number of modelled areas that are ice sheets \mbox{[} \mbox{]}\\
\hline
{\em thliq} & Volumetric liquid water content of soil layers $[m^3 m^{-3}]$\\
\hline
{\em thice} & Volumetric frozen water content of soil layers $[m^3 m^{-3}]$\\
\hline
{\em tbar} & Temperature of soil layers \mbox{[}K\mbox{]}\\
\hline
{\em gflux} & Heat flux at interfaces between soil layers $[W m^{-2}]$\\
\hline
{\em tcan} & Vegetation canopy temperature \mbox{[}K\mbox{]}\\
\hline
{\em rcan} & Intercepted liquid water stored on canopy $[kg m^{-2}]$\\
\hline
{\em sncan} & Intercepted frozen water stored on canopy $[kg m^{-2}]$\\
\hline
{\em runoff} & Total runoff from soil $[m or kg m^{-2} s^{-1}]$\\
\hline
{\em sno} & Mass of snow pack $[kg m^{-2}]$\\
\hline
{\em tsnow} & Snowpack temperature \mbox{[}K\mbox{]}\\
\hline
{\em rhosno} & Density of snow $[kg m^{-3}]$\\
\hline
{\em albsno} & Snow albedo \mbox{[} \mbox{]}\\
\hline
{\em zpond} & Depth of ponded water on surface \mbox{[}m\mbox{]}\\
\hline
{\em tpond} & Temperature of ponded water \mbox{[}K\mbox{]}\\
\hline
{\em growth} & Vegetation growth index \mbox{[} \mbox{]}\\
\hline
{\em tbase} & Temperature of bedrock in third soil layer \mbox{[}K\mbox{]}\\
\hline
{\em trunof} & Temperature of total runoff \mbox{[}K\mbox{]}\\
\hline
{\em wsnow} & Liquid water content of snow pack $[kg m^{-2}]$\\
\hline
{\em pcfc} & Frozen precipitation intercepted by vegetation $[kg m^{-2} s^{-1}]$\\
\hline
{\em pclc} & Liquid precipitation intercepted by vegetation $[kg m^{-2} s^{-1}]$\\
\hline
{\em pcpn} & Precipitation incident on snow pack $[kg m^{-2} s^{-1}]$\\
\hline
{\em pcpg} & Precipitation incident on ground $[kg m^{-2} s^{-1}]$\\
\hline
{\em qfcf} & Sublimation from frozen water on vegetation $[kg m^{-2} s^{-1}]$\\
\hline
{\em qfcl} & Evaporation from liquid water on vegetation $[kg m^{-2} s^{-1}]$\\
\hline
{\em qfn} & Sublimation from snow pack $[kg m^{-2} s^{-1}]$\\
\hline
{\em qfg} & Evaporation from ground $[kg m^{-2} s^{-1}]$\\
\hline
{\em hmfc} & Diagnosed energy associated with phase change of water on vegetation $[W m^{-2}]$\\
\hline
{\em hmfn} & Diagnosed energy associated with phase change of water in snow pack $[W m^{-2}]$\\
\hline
{\em htcc} & Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em htcs} & Diagnosed internal energy change of snow pack due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em rofc} & Liquid/frozen water runoff from vegetation $[kg m^{-2} s^{-1}]$\\
\hline
{\em rofn} & Liquid water runoff from snow pack $[kg m^{-2} s^{-1}]$\\
\hline
{\em rovg} & Liquid/frozen water runoff from vegetation to ground surface $[kg m^{-2} s^{-1}]$\\
\hline
{\em wtrs} & Diagnosed residual water transferred into or out of the snow pack $[kg m^{-2} s^{-1}]$\\
\hline
{\em wtrg} & Diagnosed residual water transferred into or out of the soil $[kg m^{-2} s^{-1}]$\\
\hline
{\em ovrflw} & Overland flow from top of soil column\\
\hline
{\em subflw} & Interflow from sides of soil column $[kg m^{-2} s^{-1}]$\\
\hline
{\em basflw} & Base flow from bottom of soil column $[m or kg m^{-2} s^{-1}]$\\
\hline
{\em tovrfl} & Temperature of overland flow from top of soil column \mbox{[}K\mbox{]}\\
\hline
{\em tsubfl} & Temperature of interflow from sides of soil column \mbox{[}K\mbox{]}\\
\hline
{\em tbasfl} & Temperature of base flow from bottom of soil column \mbox{[}K\mbox{]}\\
\hline
{\em evap} & Diagnosed total surface water vapour flux over modelled area $[kg m^{-2} s^{-1}]$\\
\hline
{\em qflux} & Product of surface drag coefficient, wind speed and surface-\/air specific humidity difference $[m s^{-1}]$\\
\hline
{\em rhoair} & Density of air $[kg m^{-3}]$\\
\hline
{\em qfc} & Water removed from soil layers by transpiration $[kg m^{-2} s^{-1}]$\\
\hline
{\em hmfg} & Diagnosed energy associated with phase change of water in soil layers $[W m^{-2}]$\\
\hline
{\em htc} & Diagnosed internal energy change of soil layer due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em rpcp} & Rainfall rate over modelled area $[m s^{-1}]$\\
\hline
{\em trpcp} & Rainfall temperature over modelled area \mbox{[}C\mbox{]}\\
\hline
{\em spcp} & Snowfall rate over modelled area $[m s^{-1}]$\\
\hline
{\em tspcp} & Snowfall temperature over modelled area \mbox{[}C\mbox{]}\\
\hline
{\em pcpr} & Surface precipitation rate $[kg m^{-2} s^{-1}]$\\
\hline
{\em ta} & Air temperature at reference height \mbox{[}K\mbox{]}\\
\hline
{\em tbarc} & Subarea temperatures of soil layers \mbox{[}C\mbox{]}\\
\hline
{\em tbarg} & Subarea temperatures of soil layers \mbox{[}C\mbox{]}\\
\hline
{\em tbarcs} & Subarea temperatures of soil layers \mbox{[}C\mbox{]}\\
\hline
{\em tbargs} & Subarea temperatures of soil layers \mbox{[}C\mbox{]}\\
\hline
{\em thliqc} & Liquid water content of soil layers under vegetation $[m^3 m^{-3}]$\\
\hline
{\em thliqg} & Liquid water content of soil layers in bare areas $[m^3 m^{-3}]$\\
\hline
{\em thicec} & Frozen water content of soil layers under vegetation $[m^3 m^{-3}]$\\
\hline
{\em thiceg} & Frozen water content of soil layers in bare areas $[m^3 m^{-3}]$\\
\hline
{\em hcpc} & Heat capacity of soil layers under vegetation $[J m^{-3} K^{-1}]$\\
\hline
{\em hcpg} & Heat capacity of soil layers in bare areas $[J m^{-3} K^{-1}]$\\
\hline
{\em tctopc} & Thermal conductivity of soil at top of layer (vegetation over ground) $[W m^{-1} K^{-1}]$\\
\hline
{\em tcbotc} & Thermal conductivity of soil at bottom of layer (vegetation over ground) $[W m^{-1} K^{-1}]$\\
\hline
{\em tctopg} & Thermal conductivity of soil at top of layer (bare ground) $[W m^{-1} K^{-1}]$\\
\hline
{\em tcbotg} & Thermal conductivity of soil at bottom of layer (bare ground) $[W m^{-1} K^{-1}]$\\
\hline
{\em froot} & Fraction of total transpiration contributed by soil layer over snow-\/free subarea \mbox{[} \mbox{]}\\
\hline
{\em froots} & Fraction of total transpiration contributed by soil layer over snow-\/covered subarea \mbox{[} \mbox{]}\\
\hline
{\em tsfsav} & Ground surface temperature over subarea \mbox{[}K\mbox{]}\\
\hline
{\em fc} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fg} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fcs} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fgs} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em tpondc} & Subarea temperature of surface ponded water \mbox{[}C\mbox{]}\\
\hline
{\em tpondg} & Subarea temperature of surface ponded water \mbox{[}C\mbox{]}\\
\hline
{\em tpndcs} & Subarea temperature of surface ponded water \mbox{[}C\mbox{]}\\
\hline
{\em tpndgs} & Subarea temperature of surface ponded water \mbox{[}C\mbox{]}\\
\hline
{\em evapc} & Evaporation from vegetation over ground $[m s^{-1}]$\\
\hline
{\em evapcg} & Evaporation from ground under vegetation $[m s^{-1}]$\\
\hline
{\em evapg} & Evaporation from bare ground $[m s^{-1}]$\\
\hline
{\em evapcs} & Evaporation from vegetation over snow $[m s^{-1}]$\\
\hline
{\em evpcsg} & Evaporation from snow under vegetation $[m s^{-1}]$\\
\hline
{\em evapgs} & Evaporation from snow on bare ground $[m s^{-1}]$\\
\hline
{\em qfrezc} & Heat sink to be used for freezing water on ground under canopy $[W m^{-2}]$\\
\hline
{\em qfrezg} & Heat sink to be used for freezing water on bare ground $[W m^{-2}]$\\
\hline
{\em qmeltc} & Heat to be used for melting snow under canopy $[W m^{-2}]$\\
\hline
{\em qmeltg} & Heat to be used for melting snow on bare ground $[W m^{-2}]$\\
\hline
{\em raican} & Intercepted liquid water stored on canopy over ground $[kg m^{-2}]$\\
\hline
{\em snocan} & Intercepted frozen water stored on canopy over ground $[kg m^{-2}]$\\
\hline
{\em raicns} & Intercepted liquid water stored on canopy over snow $[kg m^{-2}]$\\
\hline
{\em snocns} & Intercepted frozen water stored on canopy over snow $[kg m^{-2}]$\\
\hline
{\em fsvf} & Sky view factor of ground under vegetation canopy \mbox{[} \mbox{]}\\
\hline
{\em fsvfs} & Sky view factor of snow under vegetation canopy \mbox{[} \mbox{]}\\
\hline
{\em cwlcap} & Storage capacity of canopy over bare ground for liquid water $[kg m^{-2}]$\\
\hline
{\em cwfcap} & Storage capacity of canopy over bare ground for frozen water $[kg m^{-2}]$\\
\hline
{\em cwlcps} & Storage capacity of canopy over snow for liquid water $[kg m^{-2}]$\\
\hline
{\em cwfcps} & Storage capacity of canopy over snow for frozen water $[kg m^{-2}]$\\
\hline
{\em tcano} & Temperature of canopy over ground \mbox{[}K\mbox{]}\\
\hline
{\em tcans} & Temperature of canopy over snow \mbox{[}K\mbox{]}\\
\hline
{\em chcap} & Heat capacity of canopy over bare ground $[J m^{-2} K^{-1}] $\\
\hline
{\em chcaps} & Heat capacity of canopy over snow $[J m^{-2} K^{-1}] $\\
\hline
{\em cmassc} & Mass of canopy over bare ground $[kg m^{-2}]$\\
\hline
{\em cmascs} & Mass of canopy over snow $[kg m^{-2}]$\\
\hline
{\em zsnow} & Depth of snow pack \mbox{[}m\mbox{]}\\
\hline
{\em rhosni} & Density of fresh snow $[kg m^{-3}]$\\
\hline
{\em gzeroc} & Subarea heat flux at soil surface $[W m^{-2}]$\\
\hline
{\em gzerog} & Subarea heat flux at soil surface $[W m^{-2}]$\\
\hline
{\em gzrocs} & Subarea heat flux at soil surface $[W m^{-2}]$\\
\hline
{\em gzrogs} & Subarea heat flux at soil surface $[W m^{-2}]$\\
\hline
{\em g12c} & Subarea heat flux between first and second soil layers $[W m^{-2}]$\\
\hline
{\em g12g} & Subarea heat flux between first and second soil layers $[W m^{-2}]$\\
\hline
{\em g12cs} & Subarea heat flux between first and second soil layers $[W m^{-2}]$\\
\hline
{\em g12gs} & Subarea heat flux between first and second soil layers $[W m^{-2}]$\\
\hline
{\em g23c} & Subarea heat flux between second and third soil layers $[W m^{-2}]$\\
\hline
{\em g23g} & Subarea heat flux between second and third soil layers $[W m^{-2}]$\\
\hline
{\em g23cs} & Subarea heat flux between second and third soil layers $[W m^{-2}]$\\
\hline
{\em g23gs} & Subarea heat flux between second and third soil layers $[W m^{-2}]$\\
\hline
{\em tsnocs} & Temperature of snow pack under vegetation \mbox{[}K\mbox{]}\\
\hline
{\em tsnogs} & Temperature of snow pack in bare areas \mbox{[}K\mbox{]}\\
\hline
{\em wsnocs} & Liquid water content of snow pack under vegetation $[kg m^{-2}]$\\
\hline
{\em wsnogs} & Liquid water content of snow pack in bare areas $[kg m^{-2}]$\\
\hline
{\em rhoscs} & Density of snow under vegetation $[kg m^{-3}]$\\
\hline
{\em rhosgs} & Density of snow in bare areas $[kg m^{-3}]$\\
\hline
{\em zplimc} & Subarea maximum ponding depth \mbox{[}m\mbox{]}\\
\hline
{\em zplimg} & Subarea maximum ponding depth \mbox{[}m\mbox{]}\\
\hline
{\em zplmcs} & Subarea maximum ponding depth \mbox{[}m\mbox{]}\\
\hline
{\em zplmgs} & Subarea maximum ponding depth \mbox{[}m\mbox{]}\\
\hline
{\em ggeo} & Geothermal heat flux at bottom of soil profile $[W m^{-2}]$\\
\hline
{\em thpor} & Pore volume in soil layer $[m^3 m^{-3}]$\\
\hline
{\em thlret} & Liquid water retention capacity for organic soil \mbox{[}m3 m-\/3 \mbox{]}\\
\hline
{\em thlmin} & Residual soil liquid water content remaining after freezing or evaporation $[m^3 m^{-3}]$\\
\hline
{\em bi} & Clapp and Hornberger empirical \char`\"{}b\char`\"{} parameter \mbox{[} \mbox{]}\\
\hline
{\em grksat} & Saturated hydraulic conductivity of soil layer $[m s^{-1}]$\\
\hline
{\em psisat} & Soil moisture suction at saturation \mbox{[}m\mbox{]}\\
\hline
{\em thlrat} & Fractional saturation of soil behind the wetting front \mbox{[} \mbox{]}\\
\hline
{\em thfc} & Field capacity $[m^3 m^{-3}]$\\
\hline
{\em hcps} & Heat capacity of soil material $[J m^{-3} K^{-1}]$\\
\hline
{\em delzw} & Overall thickness of soil layer \mbox{[}m\mbox{]}\\
\hline
{\em zbotw} & Depth to permeable bottom of soil layer \mbox{[}m\mbox{]}\\
\hline
{\em xdrain} & Drainage index at bottom of soil profile \mbox{[} \mbox{]}\\
\hline
{\em xslope} & Surface slope (used when running M\+E\+S\+H code) \mbox{[}degrees\mbox{]}\\
\hline
{\em grkfac} & W\+A\+T\+R\+O\+F parameter used when running M\+E\+S\+H code \mbox{[} \mbox{]}\\
\hline
{\em wfsurf} & W\+A\+T\+R\+O\+F parameter used when running M\+E\+S\+H code \mbox{[} \mbox{]}\\
\hline
{\em wfcint} & W\+A\+T\+R\+O\+F parameter used when running M\+E\+S\+H code \mbox{[} \mbox{]}\\
\hline
{\em delz} & Overall thickness of soil layer \mbox{[}m\mbox{]}\\
\hline
{\em isand} & Sand content flag\\
\hline
{\em igdr} & Index of soil layer in which bedrock is encountered \\
\hline
\end{DoxyParams}
First, subroutine W\+P\+R\+E\+P is called to initialize various arrays and produce parameters for the four subareas of canopy over snow (C\+S), snow on ground (G\+S), canopy over ground (C) and bare ground (G). Then, for each of the four subareas, if the number of modelled areas containing that subarea is greater than zero, a series of subroutines is called. The subroutines associated with each subarea are listed in the table below.

\[ \begin{tabular} { | l | l | c | } \hline CANVAP & Evaporation/sublimation of water from vegetation canopy & CS,C \\ \hline CANADD & Addition of rainfall/snowfall to canopy; throughfall and drip & CS,C \\ \hline CWCALC & Freezing/thawing of liquid/frozen water on canopy & CS,C \\ \hline SUBCAN & Precipitaiton and condensation under canopy & CS,C \\ \hline TWCALC & Freezing/thawing of liquid/frozen water in soil & CS,GS,C,G \\ \hline SNOVAP & Sublimaiton from snow pack & CS,GS,C,G \\ \hline TFREEZ & Freezing of ponded water on soil & CS,GS,C,G \\ \hline TMELT & Melting of snow pack & CS,GS \\ \hline SNOADD & Accumulation of snow on ground & CS,GS,C,G \\ \hline SNINFL & Infiltration of rain into snow pack & CS,GS \\ \hline ICEBAL & Energy and water budget of ice sheets & GS,G \\ \hline GRINFL & Infiltraiton of water into soil & CS,GS,C,G \\ \hline GRDRAN & Soil water movement in response to gravity and suction forces & CS,GS,C,G \\ \hline TMCALC & Step ahead soil layer temperatures, check for freezing/thawing & CS,GS,C,G \\ \hline CHKWAT & Check subarea moisture balances for closure & CS,GS,C,G \\ \hline SNOALBW & Temporal variation of snow albedo and density & CS,GS \\ \hline \end{tabular} \]

After these calls have been done, average values of the main prognostic variables over the modelled area are determined by performing weighted averages over the four subareas, and checks are carried out to identify and remove vanishingly small values. First the bedrock temperature in the third soil layer, the total runoff and the runoff temperature are calculated. Then the total runoff and the overland flow, interflow and baseflow are converted from units of m to $kg m^{-2} s^{-1}$. The total surface water vapour flux over the modelled area is updated to account for the residual amounts of evaporative demand over the four subareas that could not be supplied by surface stores (W\+L\+S\+T\+C\+S, W\+L\+S\+T\+G\+S, W\+L\+O\+S\+T\+C and W\+L\+O\+S\+T\+G, variables that are defined internally in this subroutine), and the diagnostic variable Q\+F\+L\+U\+X is evaluated.

The temperature of the vegetation canopy T\+C\+A\+N and the amount of intercepted liquid water R\+C\+A\+N are calculated as weighted averages over the two canopy subareas. A flag is set to trigger a call to abort if T\+C\+A\+N is less than -\/100 C or greater than 100 C. If R\+C\+A\+N is vanishingly small, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic arrays R\+O\+F\+C, R\+O\+V\+G, P\+C\+P\+G and H\+T\+C\+C are updated, and R\+C\+A\+N is set to zero. The amount of intercepted snow S\+N\+C\+A\+N is likewise calculated as a weighted average over the two canopy subareas. If S\+N\+C\+A\+N is vanishingly small, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic arrays R\+O\+F\+C, R\+O\+V\+G, P\+C\+P\+G and H\+T\+C\+C are updated, and S\+N\+C\+A\+N is set to zero. If there is no canopy present, T\+C\+A\+N is set to zero.

At the end of the 600 loop, the depth of ponded water Z\+P\+O\+N\+D and its temperature T\+P\+O\+N\+D over the modelled area are calculated as weighted averages over the four subareas. If Z\+P\+O\+N\+D is vanishingly small, then as in the case of intercepted water, it is added to the overland flow and to the total runoff, and their respective temperatures are recalculated. The diagnostic array H\+T\+C is updated, Z\+P\+O\+N\+D is set to zero and T\+P\+O\+N\+D is set to 0 $^o$C.

In the 650 loop, values of the snow prognostic variables are calculated as weighted averages over the four subareas. The weightings for the subareas include the four internally-\/defined C\+L\+A\+S\+S\+W variables X\+S\+N\+O\+C\+S, X\+S\+N\+O\+G\+S, X\+S\+N\+O\+W\+C and X\+S\+N\+O\+W\+G, which are set in subroutine C\+H\+K\+W\+A\+T to 1 if the subarea snow depth is greater than zero, and to zero otherwise. If the snow depth over the C\+S and G\+S subareas is greater than zero (meaning that there was a pre-\/existing snow cover at the beginning of the time step), the average snow albedo A\+L\+B\+S\+N\+O is preferentially set to the average over these two subareas. Otherwise A\+L\+B\+S\+N\+O is set to the average over the C and G subareas (where snow has just been added in the current time step). The snow temperature T\+S\+N\+O\+W and density R\+H\+O\+S\+N\+O are set to weighted averages over the four subareas, using the internally-\/defined subarea volumetric heat capacities H\+C\+P\+S\+C\+S/\+G\+S/\+C/\+G and R\+H\+O\+S\+C\+S/\+G\+S/\+C/\+G. Finally the snow depth Z\+S\+N\+O\+W is calculated from the subarea depths; the liquid water content of the snow pack W\+S\+N\+O\+W is obtained as a weighted average over the C\+S and G\+S subareas (assuming that freshly fallen snow does not yet contain liquid water); and the snow mass is determined from Z\+S\+N\+O\+W and R\+H\+O\+S\+N\+O. Upper and lower limits apply to the snow pack. If the snow depth exceeds 10 m, the excess snow and its associated liquid water content are added to the overland flow and the total runoff, the respective temperatures of the latter are recalculated and the diagnostic arrays R\+O\+F\+N, P\+C\+P\+G and H\+T\+C\+S are updated. As in the case of intercepted and ponded water, if the snow mass is vanishingly small it and its liquid water content are added to the overland flow and to the total runoff, and their respective temperatures are recalculated, the diagnostic arrays R\+O\+F\+N, P\+C\+P\+G and H\+T\+C\+S are updated, and T\+S\+N\+O\+W, R\+H\+O\+S\+N\+O, S\+N\+O and W\+S\+N\+O\+W are set to zero. Flags are set to trigger calls to abort if T\+S\+N\+O\+W is less than 0 K or greater than 0.\+001 C. Finally, the three abort flags set thus far are checked, and calls to abort are performed if they are greater than zero.

In the 700 loop, the temperature of each soil layer is calculated as a weighted average over the four subareas. In the case of the third soil layer., if the standard three-\/layer configuration is being modelled (with a very thick third soil layer of 3.\+75 m), the subarea layer temperatures T\+B\+A\+R\+C\+S/\+G\+S/\+C/\+G and the layer heat capacities H\+C\+P\+C\+S/\+G\+S/\+C/\+G apply to the permeable depth D\+E\+L\+Z\+W of the layer, and the bedrock temperature T\+B\+A\+S\+E and the rock heat capacity H\+C\+P\+S\+N\+D to the remainder, D\+E\+L\+Z-\/\+D\+E\+L\+Z\+W. The averaging is carried out accordingly. In all other soil layers, the layer temperature applies to the whole thickness, whose heat capacity is a weighted average of H\+C\+P\+C\+S/\+G\+S/\+C/\+G over D\+E\+L\+Z\+W and H\+C\+P\+S\+N\+D over D\+E\+L\+Z-\/\+D\+E\+L\+Z\+W. The volumetric liquid water content T\+H\+L\+I\+Q, the volumetric frozen water content T\+H\+I\+C\+E, and the heat flux at the soil layer interfaces G\+F\+L\+U\+X are calculated as simple weighted averages over the subareas. A flag is set to trigger a call to abort if the soil layer temperature is less than -\/100 C or greater than 100 C, and after the end of the loop, a call to abort is performed if the flag is greater than zero.

Finally, subroutine C\+G\+R\+O\+W is called to update the vegetation growth index.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{CLASSW_8f_aac1827011ed2ca61bd0274e83d1f80ad_cgraph}
\end{center}
\end{figure}


