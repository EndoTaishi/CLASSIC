\hypertarget{CLASSA_8f}{}\section{C\+L\+A\+S\+S\+A.\+f File Reference}
\label{CLASSA_8f}\index{C\+L\+A\+S\+S\+A.\+f@{C\+L\+A\+S\+S\+A.\+f}}


Purpose\+: Organize calculation of radiation-\/related and other surface parameters.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{CLASSA_8f_a4ba5845339f63dd223722f0e0593c72e}{classa} (F\+C, F\+G, F\+C\+S, F\+G\+S, A\+L\+V\+S\+C\+N, A\+L\+I\+R\+C\+N, A\+L\+V\+S\+G, A\+L\+I\+R\+G, A\+L\+V\+S\+C\+S, A\+L\+I\+R\+C\+S, A\+L\+V\+S\+S\+N, A\+L\+I\+R\+S\+N, A\+L\+V\+S\+G\+C, A\+L\+I\+R\+G\+C, A\+L\+V\+S\+S\+C, A\+L\+I\+R\+S\+C, T\+R\+V\+S\+C\+N, T\+R\+I\+R\+C\+N, T\+R\+V\+S\+C\+S, T\+R\+I\+R\+C\+S, F\+S\+V\+F, F\+S\+V\+F\+S, R\+A\+I\+C\+A\+N, R\+A\+I\+C\+N\+S, S\+N\+O\+C\+A\+N, S\+N\+O\+C\+N\+S, F\+R\+A\+I\+N\+C, F\+S\+N\+O\+W\+C, F\+R\+A\+I\+C\+S, F\+S\+N\+O\+C\+S, D\+I\+S\+P, D\+I\+S\+P\+S, Z\+O\+M\+L\+N\+C, Z\+O\+M\+L\+C\+S, Z\+O\+E\+L\+N\+C, Z\+O\+E\+L\+C\+S, Z\+O\+M\+L\+N\+G, Z\+O\+M\+L\+N\+S, Z\+O\+E\+L\+N\+G, Z\+O\+E\+L\+N\+S, C\+H\+C\+A\+P, C\+H\+C\+A\+P\+S, C\+M\+A\+S\+S\+C, C\+M\+A\+S\+C\+S, C\+W\+L\+C\+A\+P, C\+W\+F\+C\+A\+P, C\+W\+L\+C\+P\+S, C\+W\+F\+C\+P\+S, R\+C, R\+C\+S, R\+B\+C\+O\+E\+F, F\+R\+O\+O\+T, F\+R\+O\+O\+T\+S, Z\+P\+L\+I\+M\+C, Z\+P\+L\+I\+M\+G, Z\+P\+L\+M\+C\+S, Z\+P\+L\+M\+G\+S, Z\+S\+N\+O\+W, W\+S\+N\+O\+W, A\+L\+V\+S, A\+L\+I\+R, H\+T\+C\+C, H\+T\+C\+S, H\+T\+C, A\+L\+T\+G, A\+L\+S\+N\+O, T\+R\+S\+N\+O\+W\+C, T\+R\+S\+N\+O\+W\+G, W\+T\+R\+C, W\+T\+R\+S, W\+T\+R\+G, C\+M\+A\+I, F\+S\+N\+O\+W, F\+C\+A\+N\+M\+X, Z\+O\+L\+N, A\+L\+V\+S\+C, A\+L\+I\+R\+C, P\+A\+I\+M\+A\+X, P\+A\+I\+M\+I\+N, C\+W\+G\+T\+M\+X, Z\+R\+T\+M\+A\+X, R\+S\+M\+I\+N, Q\+A50, V\+P\+D\+A, V\+P\+D\+B, P\+S\+I\+G\+A, P\+S\+I\+G\+B, P\+A\+I\+D\+A\+T, H\+G\+T\+D\+A\+T, A\+C\+V\+D\+A\+T, A\+C\+I\+D\+A\+T, A\+S\+V\+D\+A\+T, A\+S\+I\+D\+A\+T, A\+G\+V\+D\+A\+T, A\+G\+I\+D\+A\+T, A\+L\+G\+W\+V, A\+L\+G\+W\+N, A\+L\+G\+D\+V, A\+L\+G\+D\+N, T\+H\+L\+I\+Q, T\+H\+I\+C\+E, T\+B\+A\+R, R\+C\+A\+N, S\+N\+C\+A\+N, T\+C\+A\+N, G\+R\+O\+W\+T\+H, S\+N\+O, T\+S\+N\+O\+W, R\+H\+O\+S\+N\+O, A\+L\+B\+S\+N\+O, Z\+B\+L\+E\+N\+D, Z0\+O\+R\+O, S\+N\+O\+L\+I\+M, Z\+P\+L\+M\+G0, Z\+P\+L\+M\+S0, F\+C\+L\+O\+U\+D, T\+A, V\+P\+D, R\+H\+O\+A\+I\+R, C\+O\+S\+Z\+S, F\+S\+D\+B, F\+S\+F\+B, R\+E\+F\+S\+N\+O, B\+C\+S\+N\+O, Q\+S\+W\+I\+N\+V, R\+A\+D\+J, D\+L\+O\+N, R\+H\+O\+S\+N\+I, D\+E\+L\+Z, D\+E\+L\+Z\+W, Z\+B\+O\+T\+W, T\+H\+P\+O\+R, T\+H\+L\+M\+I\+N, P\+S\+I\+S\+A\+T, B\+I, P\+S\+I\+W\+L\+T, H\+C\+P\+S, I\+S\+A\+N\+D, F\+C\+A\+N\+C\+M\+X, I\+C\+T\+E\+M, ctem\+\_\+on, R\+M\+A\+T\+C, Z\+O\+L\+N\+C, C\+M\+A\+S\+V\+E\+G\+C, A\+I\+L\+C, P\+A\+I\+C, L2\+M\+A\+X, N\+O\+L2\+P\+F\+T\+S, S\+L\+A\+I\+C, A\+I\+L\+C\+G, A\+I\+L\+C\+G\+S, F\+C\+A\+N\+C, F\+C\+A\+N\+C\+S, I\+D\+A\+Y, I\+L\+G, I\+L1, I\+L2, N\+B\+S, J\+L, N, I\+C, I\+C\+P1, I\+G, I\+D\+I\+S\+P, I\+Z\+R\+E\+F, I\+W\+F, I\+P\+A\+I, I\+H\+G\+T, I\+A\+L\+C, I\+A\+L\+S, I\+A\+L\+G, I\+S\+N\+O\+A\+L\+B, A\+L\+V\+S\+C\+T\+M, A\+L\+I\+R\+C\+T\+M, ipeatland)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Purpose\+: Organize calculation of radiation-\/related and other surface parameters. 



\subsection{Function/\+Subroutine Documentation}
\hypertarget{CLASSA_8f_a4ba5845339f63dd223722f0e0593c72e}{}\index{C\+L\+A\+S\+S\+A.\+f@{C\+L\+A\+S\+S\+A.\+f}!classa@{classa}}
\index{classa@{classa}!C\+L\+A\+S\+S\+A.\+f@{C\+L\+A\+S\+S\+A.\+f}}
\subsubsection[{classa}]{\setlength{\rightskip}{0pt plus 5cm}subroutine classa (
\begin{DoxyParamCaption}
\item[{real, dimension    (ilg)}]{F\+C, }
\item[{real, dimension    (ilg)}]{F\+G, }
\item[{real, dimension   (ilg)}]{F\+C\+S, }
\item[{real, dimension   (ilg)}]{F\+G\+S, }
\item[{real, dimension(ilg)}]{A\+L\+V\+S\+C\+N, }
\item[{real, dimension(ilg)}]{A\+L\+I\+R\+C\+N, }
\item[{real, dimension (ilg)}]{A\+L\+V\+S\+G, }
\item[{real, dimension (ilg)}]{A\+L\+I\+R\+G, }
\item[{real, dimension(ilg)}]{A\+L\+V\+S\+C\+S, }
\item[{real, dimension(ilg)}]{A\+L\+I\+R\+C\+S, }
\item[{real, dimension(ilg)}]{A\+L\+V\+S\+S\+N, }
\item[{real, dimension(ilg)}]{A\+L\+I\+R\+S\+N, }
\item[{real, dimension(ilg)}]{A\+L\+V\+S\+G\+C, }
\item[{real, dimension(ilg)}]{A\+L\+I\+R\+G\+C, }
\item[{real, dimension(ilg)}]{A\+L\+V\+S\+S\+C, }
\item[{real, dimension(ilg)}]{A\+L\+I\+R\+S\+C, }
\item[{real, dimension(ilg)}]{T\+R\+V\+S\+C\+N, }
\item[{real, dimension(ilg)}]{T\+R\+I\+R\+C\+N, }
\item[{real, dimension(ilg)}]{T\+R\+V\+S\+C\+S, }
\item[{real, dimension(ilg)}]{T\+R\+I\+R\+C\+S, }
\item[{real, dimension  (ilg)}]{F\+S\+V\+F, }
\item[{real, dimension (ilg)}]{F\+S\+V\+F\+S, }
\item[{real, dimension(ilg)}]{R\+A\+I\+C\+A\+N, }
\item[{real, dimension(ilg)}]{R\+A\+I\+C\+N\+S, }
\item[{real, dimension(ilg)}]{S\+N\+O\+C\+A\+N, }
\item[{real, dimension(ilg)}]{S\+N\+O\+C\+N\+S, }
\item[{real, dimension(ilg)}]{F\+R\+A\+I\+N\+C, }
\item[{real, dimension(ilg)}]{F\+S\+N\+O\+W\+C, }
\item[{real, dimension(ilg)}]{F\+R\+A\+I\+C\+S, }
\item[{real, dimension(ilg)}]{F\+S\+N\+O\+C\+S, }
\item[{real, dimension  (ilg)}]{D\+I\+S\+P, }
\item[{real, dimension (ilg)}]{D\+I\+S\+P\+S, }
\item[{real, dimension(ilg)}]{Z\+O\+M\+L\+N\+C, }
\item[{real, dimension(ilg)}]{Z\+O\+M\+L\+C\+S, }
\item[{real, dimension(ilg)}]{Z\+O\+E\+L\+N\+C, }
\item[{real, dimension(ilg)}]{Z\+O\+E\+L\+C\+S, }
\item[{real, dimension(ilg)}]{Z\+O\+M\+L\+N\+G, }
\item[{real, dimension(ilg)}]{Z\+O\+M\+L\+N\+S, }
\item[{real, dimension(ilg)}]{Z\+O\+E\+L\+N\+G, }
\item[{real, dimension(ilg)}]{Z\+O\+E\+L\+N\+S, }
\item[{real, dimension (ilg)}]{C\+H\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+H\+C\+A\+P\+S, }
\item[{real, dimension(ilg)}]{C\+M\+A\+S\+S\+C, }
\item[{real, dimension(ilg)}]{C\+M\+A\+S\+C\+S, }
\item[{real, dimension(ilg)}]{C\+W\+L\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+W\+F\+C\+A\+P, }
\item[{real, dimension(ilg)}]{C\+W\+L\+C\+P\+S, }
\item[{real, dimension(ilg)}]{C\+W\+F\+C\+P\+S, }
\item[{real, dimension    (ilg)}]{R\+C, }
\item[{real, dimension   (ilg)}]{R\+C\+S, }
\item[{real, dimension(ilg)}]{R\+B\+C\+O\+E\+F, }
\item[{real, dimension (ilg,ig)}]{F\+R\+O\+O\+T, }
\item[{real, dimension(ilg,ig)}]{F\+R\+O\+O\+T\+S, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+I\+M\+C, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+I\+M\+G, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+C\+S, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+G\+S, }
\item[{real, dimension (ilg)}]{Z\+S\+N\+O\+W, }
\item[{real, dimension (ilg)}]{W\+S\+N\+O\+W, }
\item[{real, dimension  (ilg)}]{A\+L\+V\+S, }
\item[{real, dimension  (ilg)}]{A\+L\+I\+R, }
\item[{real, dimension  (ilg)}]{H\+T\+C\+C, }
\item[{real, dimension  (ilg)}]{H\+T\+C\+S, }
\item[{real, dimension   (ilg,ig)}]{H\+T\+C, }
\item[{real, dimension(ilg,nbs)}]{A\+L\+T\+G, }
\item[{real, dimension(ilg,nbs)}]{A\+L\+S\+N\+O, }
\item[{real, dimension(ilg)}]{T\+R\+S\+N\+O\+W\+C, }
\item[{real, dimension(ilg,nbs)}]{T\+R\+S\+N\+O\+W\+G, }
\item[{real, dimension  (ilg)}]{W\+T\+R\+C, }
\item[{real, dimension  (ilg)}]{W\+T\+R\+S, }
\item[{real, dimension  (ilg)}]{W\+T\+R\+G, }
\item[{real, dimension  (ilg)}]{C\+M\+A\+I, }
\item[{real, dimension (ilg)}]{F\+S\+N\+O\+W, }
\item[{real, dimension(ilg,icp1)}]{F\+C\+A\+N\+M\+X, }
\item[{real, dimension  (ilg,icp1)}]{Z\+O\+L\+N, }
\item[{real, dimension (ilg,icp1)}]{A\+L\+V\+S\+C, }
\item[{real, dimension (ilg,icp1)}]{A\+L\+I\+R\+C, }
\item[{real, dimension(ilg,ic)}]{P\+A\+I\+M\+A\+X, }
\item[{real, dimension(ilg,ic)}]{P\+A\+I\+M\+I\+N, }
\item[{real, dimension(ilg,ic)}]{C\+W\+G\+T\+M\+X, }
\item[{real, dimension(ilg,ic)}]{Z\+R\+T\+M\+A\+X, }
\item[{real, dimension (ilg,ic)}]{R\+S\+M\+I\+N, }
\item[{real, dimension  (ilg,ic)}]{Q\+A50, }
\item[{real, dimension  (ilg,ic)}]{V\+P\+D\+A, }
\item[{real, dimension  (ilg,ic)}]{V\+P\+D\+B, }
\item[{real, dimension (ilg,ic)}]{P\+S\+I\+G\+A, }
\item[{real, dimension (ilg,ic)}]{P\+S\+I\+G\+B, }
\item[{real, dimension(ilg,ic)}]{P\+A\+I\+D\+A\+T, }
\item[{real, dimension(ilg,ic)}]{H\+G\+T\+D\+A\+T, }
\item[{real, dimension(ilg,ic)}]{A\+C\+V\+D\+A\+T, }
\item[{real, dimension(ilg,ic)}]{A\+C\+I\+D\+A\+T, }
\item[{real, dimension(ilg)}]{A\+S\+V\+D\+A\+T, }
\item[{real, dimension(ilg)}]{A\+S\+I\+D\+A\+T, }
\item[{real, dimension(ilg)}]{A\+G\+V\+D\+A\+T, }
\item[{real, dimension(ilg)}]{A\+G\+I\+D\+A\+T, }
\item[{real, dimension(ilg)}]{A\+L\+G\+W\+V, }
\item[{real, dimension(ilg)}]{A\+L\+G\+W\+N, }
\item[{real, dimension(ilg)}]{A\+L\+G\+D\+V, }
\item[{real, dimension(ilg)}]{A\+L\+G\+D\+N, }
\item[{real, dimension (ilg,ig)}]{T\+H\+L\+I\+Q, }
\item[{real, dimension (ilg,ig)}]{T\+H\+I\+C\+E, }
\item[{real, dimension  (ilg,ig)}]{T\+B\+A\+R, }
\item[{real, dimension  (ilg)}]{R\+C\+A\+N, }
\item[{real, dimension (ilg)}]{S\+N\+C\+A\+N, }
\item[{real, dimension  (ilg)}]{T\+C\+A\+N, }
\item[{real, dimension(ilg)}]{G\+R\+O\+W\+T\+H, }
\item[{real, dimension   (ilg)}]{S\+N\+O, }
\item[{real, dimension (ilg)}]{T\+S\+N\+O\+W, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+N\+O, }
\item[{real, dimension(ilg)}]{A\+L\+B\+S\+N\+O, }
\item[{real, dimension(ilg)}]{Z\+B\+L\+E\+N\+D, }
\item[{real, dimension (ilg)}]{Z0\+O\+R\+O, }
\item[{real, dimension(ilg)}]{S\+N\+O\+L\+I\+M, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+G0, }
\item[{real, dimension(ilg)}]{Z\+P\+L\+M\+S0, }
\item[{real, dimension(ilg)}]{F\+C\+L\+O\+U\+D, }
\item[{real, dimension    (ilg)}]{T\+A, }
\item[{real, dimension   (ilg)}]{V\+P\+D, }
\item[{real, dimension(ilg)}]{R\+H\+O\+A\+I\+R, }
\item[{real, dimension (ilg)}]{C\+O\+S\+Z\+S, }
\item[{real, dimension(ilg,nbs)}]{F\+S\+D\+B, }
\item[{real, dimension(ilg,nbs)}]{F\+S\+F\+B, }
\item[{real, dimension(ilg)}]{R\+E\+F\+S\+N\+O, }
\item[{real, dimension(ilg)}]{B\+C\+S\+N\+O, }
\item[{real, dimension(ilg)}]{Q\+S\+W\+I\+N\+V, }
\item[{real, dimension  (ilg)}]{R\+A\+D\+J, }
\item[{real, dimension  (ilg)}]{D\+L\+O\+N, }
\item[{real, dimension(ilg)}]{R\+H\+O\+S\+N\+I, }
\item[{real, dimension  (ig)}]{D\+E\+L\+Z, }
\item[{real, dimension (ilg,ig)}]{D\+E\+L\+Z\+W, }
\item[{real, dimension (ilg,ig)}]{Z\+B\+O\+T\+W, }
\item[{real, dimension (ilg,ig)}]{T\+H\+P\+O\+R, }
\item[{real, dimension(ilg,ig)}]{T\+H\+L\+M\+I\+N, }
\item[{real, dimension(ilg,ig)}]{P\+S\+I\+S\+A\+T, }
\item[{real, dimension    (ilg,ig)}]{B\+I, }
\item[{real, dimension(ilg,ig)}]{P\+S\+I\+W\+L\+T, }
\item[{real, dimension  (ilg,ig)}]{H\+C\+P\+S, }
\item[{integer, dimension (ilg,ig)}]{I\+S\+A\+N\+D, }
\item[{real, dimension(ilg,ictem)}]{F\+C\+A\+N\+C\+M\+X, }
\item[{integer}]{I\+C\+T\+E\+M, }
\item[{logical}]{ctem\+\_\+on, }
\item[{real, dimension(ilg,ic,ig)}]{R\+M\+A\+T\+C, }
\item[{real, dimension(ilg,ic)}]{Z\+O\+L\+N\+C, }
\item[{real, dimension(ilg,ic)}]{C\+M\+A\+S\+V\+E\+G\+C, }
\item[{real, dimension  (ilg,ic)}]{A\+I\+L\+C, }
\item[{real, dimension (ilg,ic)}]{P\+A\+I\+C, }
\item[{integer}]{L2\+M\+A\+X, }
\item[{integer, dimension(ic)}]{N\+O\+L2\+P\+F\+T\+S, }
\item[{real, dimension(ilg,ic)}]{S\+L\+A\+I\+C, }
\item[{real, dimension (ilg,ictem)}]{A\+I\+L\+C\+G, }
\item[{real, dimension(ilg,ictem)}]{A\+I\+L\+C\+G\+S, }
\item[{real, dimension(ilg,ictem)}]{F\+C\+A\+N\+C, }
\item[{real, dimension(ilg,ictem)}]{F\+C\+A\+N\+C\+S, }
\item[{integer}]{I\+D\+A\+Y, }
\item[{integer}]{I\+L\+G, }
\item[{integer}]{I\+L1, }
\item[{integer}]{I\+L2, }
\item[{integer}]{N\+B\+S, }
\item[{integer}]{J\+L, }
\item[{integer}]{N, }
\item[{integer}]{I\+C, }
\item[{integer}]{I\+C\+P1, }
\item[{integer}]{I\+G, }
\item[{integer}]{I\+D\+I\+S\+P, }
\item[{integer}]{I\+Z\+R\+E\+F, }
\item[{integer}]{I\+W\+F, }
\item[{integer}]{I\+P\+A\+I, }
\item[{integer}]{I\+H\+G\+T, }
\item[{integer}]{I\+A\+L\+C, }
\item[{integer}]{I\+A\+L\+S, }
\item[{integer}]{I\+A\+L\+G, }
\item[{integer}]{I\+S\+N\+O\+A\+L\+B, }
\item[{real, dimension(ilg,ic)}]{A\+L\+V\+S\+C\+T\+M, }
\item[{real, dimension(ilg,ic)}]{A\+L\+I\+R\+C\+T\+M, }
\item[{integer, dimension(ilg)}]{ipeatland}
\end{DoxyParamCaption}
)}\label{CLASSA_8f_a4ba5845339f63dd223722f0e0593c72e}

\begin{DoxyParams}{Parameters}
{\em isnoalb} & Switch to model snow albedo in two or more wavelength bands\\
\hline
{\em fc} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fg} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fcs} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em fgs} & Subarea fractional coverage of modelled area \mbox{[} \mbox{]}\\
\hline
{\em alvscn} & Visible albedo of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em alircn} & Near-\/\+I\+R albedo of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em alvsg} & Visible albedo of open bare ground \mbox{[} \mbox{]}\\
\hline
{\em alirg} & Near-\/\+I\+R albedo of open bare ground \mbox{[} \mbox{]}\\
\hline
{\em alvscs} & Visible albedo of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em alircs} & Near-\/\+I\+R albedo of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em alvssn} & Visible albedo of open snow cover \mbox{[} \mbox{]}\\
\hline
{\em alirsn} & Near-\/\+I\+R albedo of open snow cover \mbox{[} \mbox{]}\\
\hline
{\em alvsgc} & Visible albedo of bare ground under vegetation \mbox{[} \mbox{]}\\
\hline
{\em alirgc} & Near-\/\+I\+R albedo of bare ground under vegetation \mbox{[} \mbox{]}\\
\hline
{\em alvssc} & Visible albedo of snow under vegetation \mbox{[} \mbox{]}\\
\hline
{\em alirsc} & Near-\/\+I\+R albedo of snow under vegetation \mbox{[} \mbox{]}\\
\hline
{\em trvscn} & Visible transmissivity of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em trircn} & Near-\/\+I\+R transmissivity of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em trvscs} & Visible transmissivity of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em trircs} & Near-\/\+I\+R transmissivity of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em fsvf} & Sky view factor for bare ground under canopy \mbox{[} \mbox{]}\\
\hline
{\em fsvfs} & Sky view factor for snow under canopy \mbox{[} \mbox{]}\\
\hline
{\em raican} & Intercepted liquid water stored on canopy over bare ground $[kg m^{-2}]$\\
\hline
{\em raicns} & Intercepted liquid water stored on canopy over snow $[kg m^{-2}]$\\
\hline
{\em snocan} & Intercepted frozen water stored on canopy over bare soil $[kg m^{-2}]$\\
\hline
{\em snocns} & Intercepted frozen water stored on canopy over snow $[kg m^{-2}]$\\
\hline
{\em frainc} & Fractional coverage of canopy by liquid water over snow-\/free subarea \mbox{[} \mbox{]}\\
\hline
{\em fsnowc} & Fractional coverage of canopy by frozen water over snow-\/free subarea \mbox{[} \mbox{]}\\
\hline
{\em fraics} & Fractional coverage of canopy by liquid water over snow-\/covered subarea \mbox{[} \mbox{]}\\
\hline
{\em fsnocs} & Fractional coverage of canopy by frozen water over snow-\/covered subarea \mbox{[} \mbox{]}\\
\hline
{\em disp} & Displacement height of vegetation over bare ground \mbox{[}m\mbox{]}\\
\hline
{\em disps} & Displacement height of vegetation over snow \mbox{[}m\mbox{]}\\
\hline
{\em zomlnc} & Logarithm of roughness length for momentum of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em zomlcs} & Logarithm of roughness length for momentum of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em zoelnc} & Logarithm of roughness length for heat of vegetation over bare ground \mbox{[} \mbox{]}\\
\hline
{\em zoelcs} & Logarithm of roughness length for heat of vegetation over snow \mbox{[} \mbox{]}\\
\hline
{\em zomlng} & Logarithm of roughness length for momentum of bare ground \mbox{[} \mbox{]}\\
\hline
{\em zomlns} & Logarithm of roughness length for momentum of snow \mbox{[} \mbox{]}\\
\hline
{\em zoelng} & Logarithm of roughness length for heat of bare ground \mbox{[} \mbox{]}\\
\hline
{\em zoelns} & Logarithm of roughness length for heat of snow \mbox{[} \mbox{]}\\
\hline
{\em chcap} & Heat capacity of canopy over bare ground $ [J m^{-2} K^{-1}]$\\
\hline
{\em chcaps} & Heat capacity of canopy over snow $[J m^{-2} K^{-1}]$\\
\hline
{\em cmassc} & Mass of canopy over bare ground $[kg m^{-2}]$\\
\hline
{\em cmascs} & Mass of canopy over snow $[kg m^{-2}]$\\
\hline
{\em cwlcap} & Storage capacity of canopy over bare ground for liquid water $[kg m^{-2}]$\\
\hline
{\em cwfcap} & Storage capacity of canopy over bare ground for frozen water $[kg m^{-2}]$\\
\hline
{\em cwlcps} & Storage capacity of canopy over snow for liquid water $[kg m^{-2}]$\\
\hline
{\em cwfcps} & Storage capacity of canopy over snow for frozen water $[kg m^{-2}]$\\
\hline
{\em rc} & Stomatal resistance of vegetation over bare ground $[s m^{-1}]$\\
\hline
{\em rcs} & Stomatal resistance of vegetation over snow $[s m^{-1}]$\\
\hline
{\em zplimc} & Maximum water ponding depth for ground under canopy \mbox{[}m\mbox{]}\\
\hline
{\em zplimg} & Maximum water ponding depth for bare ground \mbox{[}m\mbox{]}\\
\hline
{\em zplmcs} & Maximum water ponding depth for ground under snow under canopy \mbox{[}m\mbox{]}\\
\hline
{\em zplmgs} & Maximum water ponding depth for ground under snow \mbox{[}m\mbox{]}\\
\hline
{\em rbcoef} & Parameter for calculation of leaf boundary resistance\\
\hline
{\em trsnowc} & Short-\/wave transmissivity of snow pack under vegetation \mbox{[} \mbox{]}\\
\hline
{\em zsnow} & Depth of snow pack $[m] (z_s)$\\
\hline
{\em wsnow} & Liquid water content of snow pack $[kg m^{-2}]$\\
\hline
{\em alvs} & Diagnosed total visible albedo of land surface \mbox{[} \mbox{]}\\
\hline
{\em alir} & Diagnosed total near-\/infrared albedo of land surface \mbox{[} \mbox{]}\\
\hline
{\em htcc} & Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em htcs} & Diagnosed internal energy change of snow pack due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em wtrc} & Diagnosed residual water transferred off the vegetation canopy $[kg m^{-2} s^{-1}]$\\
\hline
{\em wtrs} & Diagnosed residual water transferred into or out of the snow pack $[kg m^{-2} s^{-1}]$\\
\hline
{\em wtrg} & Diagnosed residual water transferred into or out of the soil $[kg m^{-2} s^{-1}]$\\
\hline
{\em cmai} & Aggregated mass of vegetation canopy $[kg m^{-2}]$\\
\hline
{\em fsnow} & Diagnosed fractional snow coverage \mbox{[} \mbox{]}\\
\hline
{\em froot} & Fraction of total transpiration contributed by soil layer over snow-\/free subarea \mbox{[} \mbox{]}\\
\hline
{\em froots} & Fraction of total transpiration contributed by snow-\/covered subarea \mbox{[} \mbox{]}\\
\hline
{\em htc} & Diagnosed internal energy change of soil layer due to conduction and/or change in mass $[W m^{-2}]$\\
\hline
{\em trsnowg} & Short-\/wave transmissivity of snow pack in bare areas \mbox{[} \mbox{]}\\
\hline
{\em altg} & Total albedo in each modelled wavelength band \mbox{[} \mbox{]}\\
\hline
{\em alsno} & Albedo of snow in each modelled wavelength band \mbox{[} \mbox{]}\\
\hline
{\em fcanmx} & Maximum fractional coverage of modelled area by vegetation category \mbox{[} \mbox{]}\\
\hline
{\em zoln} & Natural logarithm of maximum roughness length of vegetation category \mbox{[} \mbox{]}\\
\hline
{\em alvsc} & Background average visible albedo of vegetation category \mbox{[} \mbox{]}\\
\hline
{\em alirc} & Background average near-\/infrared albedo of vegetation category \mbox{[} \mbox{]}\\
\hline
{\em paimax} & Maximum plant area index of vegetation category \mbox{[} \mbox{]}\\
\hline
{\em paimin} & Minimum plant area index of vegetation category \mbox{[} \mbox{]}\\
\hline
{\em cwgtmx} & Maximum canopy mass for vegetation category $[kg m^{-2}]$\\
\hline
{\em zrtmax} & Maximum rooting depth of vegetation category \mbox{[}m\mbox{]}\\
\hline
{\em rsmin} & Minimum stomatal resistance of vegetation category $[s m^{-1}]$\\
\hline
{\em qa50} & Reference value of incoming shortwave radiation for vegetation category (used in stomatal resistance calculation) $[W m^{-2}]$\\
\hline
{\em vpda} & Vapour pressure deficit coefficient for vegetation category (used in stomatal resistance calculation) \mbox{[} \mbox{]}\\
\hline
{\em vpdb} & Vapour pressure deficit coefficient for vegetation category (used in stomatal resistance calculation) \mbox{[} \mbox{]}\\
\hline
{\em psiga} & Soil moisture suction coefficient for vegetation category (used in stomatal resistance calculation) \mbox{[} \mbox{]}\\
\hline
{\em psigb} & Soil moisture suction coefficient for vegetation category (used in stomatal resistance calculation) \mbox{[} \mbox{]}\\
\hline
{\em paidat} & Optional user-\/specified value of plant area indices of vegetation categories to override C\+L\+A\+S\+S-\/calculated values \mbox{[} \mbox{]}\\
\hline
{\em hgtdat} & Optional user-\/specified values of height of vegetation categories to override C\+L\+A\+S\+S-\/ calculated values \mbox{[}m\mbox{]}\\
\hline
{\em acvdat} & Optional user-\/specified value of canopy visible albedo to override C\+L\+A\+S\+S-\/calculated value \mbox{[} \mbox{]}\\
\hline
{\em acidat} & Optional user-\/specified value of canopy near-\/infrared albedo to override C\+L\+A\+S\+S-\/ calculated value \mbox{[} \mbox{]}\\
\hline
{\em thliq} & Volumetric liquid water content of soil layers $[m^3 m^{-3}]$\\
\hline
{\em thice} & Volumetric frozen water content of soil layers $[m^3 m^{-3}]$\\
\hline
{\em tbar} & Temperature of soil layers \mbox{[}K\mbox{]}\\
\hline
{\em asvdat} & Optional user-\/specified value of snow visible albedo to override C\+L\+A\+S\+S-\/calculated value \mbox{[} \mbox{]}\\
\hline
{\em asidat} & Optional user-\/specified value of snow near-\/ infrared albedo to override C\+L\+A\+S\+S-\/calculated value \mbox{[} \mbox{]}\\
\hline
{\em agvdat} & Optional user-\/specified value of ground visible albedo to override C\+L\+A\+S\+S-\/calculated value \mbox{[} \mbox{]}\\
\hline
{\em agidat} & Optional user-\/specified value of ground near-\/ infrared albedo to override C\+L\+A\+S\+S-\/calculated value \mbox{[} \mbox{]}\\
\hline
{\em algwv} & Reference albedo for saturated soil (visible) \mbox{[} \mbox{]}\\
\hline
{\em algwn} & Reference albedo for saturated soil (N\+I\+R) \mbox{[} \mbox{]}\\
\hline
{\em algdv} & Reference albedo for dry soil (visible) \mbox{[} \mbox{]}\\
\hline
{\em algdn} & Reference albedo for dry soil (N\+I\+R) \mbox{[} \mbox{]}\\
\hline
{\em rhosni} & Density of fresh snow $[kg m^{-3}]$\\
\hline
{\em z0oro} & Orographic roughness length \mbox{[}m\mbox{]}\\
\hline
{\em rcan} & Intercepted liquid water stored on canopy $[kg m^{-2}]$\\
\hline
{\em sncan} & Intercepted frozen water stored on canopy $[kg m^{-2}]$\\
\hline
{\em tcan} & Vegetation canopy temperature \mbox{[}K\mbox{]}\\
\hline
{\em growth} & Vegetation growth index \mbox{[} \mbox{]}\\
\hline
{\em sno} & Mass of snow pack $[kg m^{-2}] (W_s)$\\
\hline
{\em tsnow} & Snowpack temperature \mbox{[}K\mbox{]}\\
\hline
{\em rhosno} & Density of snow $[kg m^{-3}] (\rho_s)$\\
\hline
{\em albsno} & Snow albedo \mbox{[} \mbox{]}\\
\hline
{\em fcloud} & Fractional cloud cover \mbox{[} \mbox{]}\\
\hline
{\em ta} & Air temperature at reference height \mbox{[}K\mbox{]}\\
\hline
{\em vpd} & Vapour pressure deficit of air \mbox{[}mb\mbox{]}\\
\hline
{\em rhoair} & Density of air $[kg m^{-3}]$\\
\hline
{\em coszs} & Cosine of solar zenith angle \mbox{[} \mbox{]}\\
\hline
{\em qswinv} & Visible radiation incident on horizontal surface $[W m^{-2}]$\\
\hline
{\em dlon} & Longitude of grid cell (east of Greenwich) \mbox{[}degrees\mbox{]}\\
\hline
{\em zblend} & Atmospheric blending height for surface roughness length averaging \mbox{[}m\mbox{]}\\
\hline
{\em snolim} & Limiting snow depth below which coverage is $<$ 100\% $[m] (z_{s,lim})$\\
\hline
{\em zplmg0} & Maximum water ponding depth for snow-\/free subareas (user-\/specified when running M\+E\+S\+H code) \mbox{[}m\mbox{]}\\
\hline
{\em zplms0} & Maximum water ponding depth for snow-\/covered subareas (user-\/specified when running M\+E\+S\+H code) \mbox{[}m\mbox{]}\\
\hline
{\em radj} & Latitude of grid cell (positive north of equator) \mbox{[}rad\mbox{]}\\
\hline
{\em refsno} & Snow grain size (for I\+S\+N\+O\+A\+L\+B=1 option) \mbox{[}m\mbox{]}\\
\hline
{\em bcsno} & Black carbon mixing ratio (for I\+S\+N\+O\+A\+L\+B=1 option) $[kg m^{-3}]$\\
\hline
{\em fsdb} & Direct solar radiation in each modelled wavelength band $[W m^{-2}]$\\
\hline
{\em fsfb} & Diffuse solar radiation in each modelled wavelength band $[W m^{-2}]$\\
\hline
{\em delzw} & Permeable thickness of soil layer \mbox{[}m\mbox{]}\\
\hline
{\em zbotw} & Depth to permeable bottom of soil layer \mbox{[}m\mbox{]}\\
\hline
{\em thpor} & Pore volume in soil layer $[m^3 m^{-3}]$\\
\hline
{\em thlmin} & Residual soil liquid water content remaining after freezing or evaporation $[m^3 m^{-3}]$\\
\hline
{\em psisat} & Soil moisture suction at saturation \mbox{[}m\mbox{]}\\
\hline
{\em bi} & Clapp and Hornberger empirical \char`\"{}b\char`\"{} parameter \mbox{[} \mbox{]}\\
\hline
{\em psiwlt} & Soil moisture suction at wilting point \mbox{[}m\mbox{]}\\
\hline
{\em hcps} & Volumetric heat capacity of soil particles $[J m^{-3}]$\\
\hline
{\em isand} & Sand content flag\\
\hline
{\em delz} & Soil layer thickness \mbox{[}m\mbox{]}\\
\hline
{\em ipeatland} & Peatland flag\+: 0 = not a peatland, 1= bog, 2 = fen \\
\hline
\end{DoxyParams}
In the first loop, the depth of snow $z_s$ is calculated from the snow mass $W_s$ and density $\varrho_s$ as\+: $ z_s = W_s / \varrho_s. $

If the calculated value of $z_s$ is less than the limiting snow depth $z_{s,lim}$, the snow cover is deemed to be discontinuous. The fractional snow coverage $X_s$ of the modelled area is evaluated as $ X_s = z_s / z_{s,lim} $ and the snow depth is reset to $z_{s,lim}$. The water content of the snow pack is corrected according to the new snow fractional area.

The subarea albedo and transmissivity arrays (for canopy, bare ground, canopy over snow and snow over bare ground) are next initialized to zero, and the four C\+L\+A\+S\+S\+A subsidiary subroutines are called in turn\+: A\+P\+R\+E\+P to evaluate various model parameters for the four subareas, G\+R\+A\+L\+B to calculate the ground surface albedo, S\+N\+O\+A\+L\+B\+A to calculate the snow albedo and transmissivity, and C\+A\+N\+A\+L\+B to calculate the canopy albedo, transmissivity and stomatal resistance. Finally, the overall visible, near-\/infrared and total albedos for the modelled area are determined as weighted averages over the four subareas.

Here is the call graph for this function\+:
% FIG 0


