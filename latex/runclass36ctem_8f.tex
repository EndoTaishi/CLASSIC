\hypertarget{runclass36ctem_8f}{}\section{runclass36ctem.\+f File Reference}
\label{runclass36ctem_8f}\index{runclass36ctem.\+f@{runclass36ctem.\+f}}


Principle driver program to run C\+L\+A\+S\+S in stand-\/alone mode using specified boundary conditions and atmospheric forcing, coupled to C\+T\+E\+M.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
\hypertarget{runclass36ctem_8f_a6d56d6301df42923fa1e8aa2e6c02ec3}{}program {\bfseries runclass36ctem}\label{runclass36ctem_8f_a6d56d6301df42923fa1e8aa2e6c02ec3}

\item 
integer function \hyperlink{runclass36ctem_8f_ae665ea752226de365786f295628b2f4f}{strlen} (S\+T)
\begin{DoxyCompactList}\small\item\em After the D\+I\+M\+E\+N\+S\+I\+O\+N statements and variable declarations, the common blocks are defined and the values of the parameters are assigned through the external B\+L\+O\+C\+K D\+A\+T\+A routine C\+L\+A\+S\+S\+B\+D and a call to the subroutine C\+L\+A\+S\+S\+D (see the appropriate section.) \end{DoxyCompactList}\item 
\hypertarget{runclass36ctem_8f_a1804a475192bb994b7e4be078687d902}{}character(len=10) function {\bfseries int2str} (i)\label{runclass36ctem_8f_a1804a475192bb994b7e4be078687d902}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Principle driver program to run C\+L\+A\+S\+S in stand-\/alone mode using specified boundary conditions and atmospheric forcing, coupled to C\+T\+E\+M. 

\subsection*{Overview}

This driver program initializes the run, reads in C\+L\+A\+S\+S input files, manages the run and the coupling between C\+L\+A\+S\+S and C\+T\+E\+M, writes the C\+L\+A\+S\+S sub-\/monthly outputs, and closes the run. 

\subsection{Function/\+Subroutine Documentation}
\hypertarget{runclass36ctem_8f_ae665ea752226de365786f295628b2f4f}{}\index{runclass36ctem.\+f@{runclass36ctem.\+f}!strlen@{strlen}}
\index{strlen@{strlen}!runclass36ctem.\+f@{runclass36ctem.\+f}}
\subsubsection[{strlen}]{\setlength{\rightskip}{0pt plus 5cm}integer function strlen (
\begin{DoxyParamCaption}
\item[{character, dimension($\ast$)}]{S\+T}
\end{DoxyParamCaption}
)}\label{runclass36ctem_8f_ae665ea752226de365786f295628b2f4f}


After the D\+I\+M\+E\+N\+S\+I\+O\+N statements and variable declarations, the common blocks are defined and the values of the parameters are assigned through the external B\+L\+O\+C\+K D\+A\+T\+A routine C\+L\+A\+S\+S\+B\+D and a call to the subroutine C\+L\+A\+S\+S\+D (see the appropriate section.) 

The grid-\/average height for the momentum diagnostic variables, Z\+D\+M\+R\+O\+W, and for the energy diagnostic variables, Z\+D\+H\+R\+O\+W, are hard-\/coded to the standard anemometer height of 10 m and to the screen height of 2 m respectively. The soil colour index S\+O\+C\+I\+R\+O\+T is assigned a representative value. Next the first data line in the “ini” file is read, which contains several basic pieces of information\+: 1) D\+E\+G\+L\+A\+T and D\+E\+G\+L\+O\+N, the latitude (positive northward, negative southward) and longitude (east of Greenwich), in degrees. 2) Z\+R\+F\+M\+R\+O\+W and Z\+R\+F\+H\+R\+O\+W, the reference heights at which the momentum variables (wind speed) and energy variables (temperature and specific humidity) are provided. In a run using atmospheric model forcing data, these heights would vary by time step, but since this version of the driver is set up to use field data, Z\+R\+F\+M\+R\+O\+W and Z\+R\+F\+H\+R\+O\+W refer to the measurement height of these variables, which is fixed. 3) Z\+B\+L\+D\+R\+O\+W, the atmospheric blending height. Technically this variable depends on the length scale of the patches of roughness elements on the land surface, but this is difficult to ascertain. Here it is assigned a value of 50 m. 4) G\+C\+R\+O\+W, the G\+C\+M surface descriptor variable. For land surfaces (including inland water) it has a value of -\/1. 5) N\+L\+T\+E\+S\+T and N\+M\+T\+E\+S\+T, the number of grid cells and the number of mosaic tiles per grid cell for this test run. As noted above, the benchmark version of the driver is set up to handle one grid cell with one mosaic tile, so N\+L\+T\+E\+S\+T and N\+M\+T\+E\+S\+T are each assigned values of 1 in the “ini” file, and all of the R\+O\+W input variables have only one entry. If it were desired to run different data sets with more tiles or grid cells, a loop or loops would have to be introduced into the R\+E\+A\+D statements, and additional lines in the “ini” file, to read in the necessary information. In the following lines of code the parameter J\+L\+A\+T is calculated from D\+E\+G\+L\+A\+T as the nearest integer value, and D\+E\+G\+L\+O\+N is converted to radians and stored in the array R\+A\+D\+J\+R\+O\+W. D\+E\+G\+L\+O\+N is stored as is in D\+L\+O\+N\+R\+O\+W. The orographic roughness length, Z0\+O\+R\+R\+O\+W, and the geothermal heat flux, G\+G\+E\+O\+R\+O\+W, are set to zero for this application. In the 50 loop, vegetation and soil information are read over each of the N\+L\+T\+E\+S\+T x N\+M\+T\+E\+S\+T modelled areas and mosaic tiles (= 1 in the benchmark simulation). The first twelve lines deal with background data. The last three lines deal with initialization data for the C\+L\+A\+S\+S prognostic variables. (For more details on these data see the section on “\+Data Requirements” in the manual). In the 100 and 150 loops, further initial calculations are done. In the 100 loop the temperatures that were read from the “ini” file are converted to degrees K, and initial values are assigned to secondary prognostic variables. The limiting snow depth, Z\+S\+N\+L, is assigned its operational value of 0.\+10 m. An option is included to extrapolate soil information to layers below the third layer, if more are being modelled and if no measured data are available for them. (This loop is to be the daily average accumulator arrays are initialized to zero. As the last step in the initialization sequence, the subroutine C\+L\+A\+S\+S\+B is called, to assign soil thermal and hydraulic properties on the basis of the textural information read in for each of the soil layers. The timestep counter N for the run is initialized to 0, the daily averaging counter N\+C\+O\+U\+N\+T is set to 1, and the total number of timesteps in the day N\+D\+A\+Y is calculated as the number of seconds in a day (86400) divided by the timestep length D\+E\+L\+T. The 200 continuation line marks the beginning of the time stepping loop for the actual run. N is incremented by 1, and the atmospheric forcing data for the current time step are read in for each grid cell or modelled area (see the section on “\+Data Requirements”). In the dataset associated with the benchmark run, only the total incoming shortwave radiation F\+S\+D\+O\+W\+N is available; it is partitioned 50\+:50 between the incoming visible (F\+S\+V\+H\+R\+O\+W) and near-\/infrared (F\+S\+I\+H\+R\+O\+W) radiation. The first two elements of the generalized incoming radiation array, F\+S\+S\+B\+R\+O\+L (used for both the I\+S\+N\+O\+A\+L\+B=0 and I\+S\+N\+O\+A\+L\+B=1 options) are set to F\+S\+V\+H\+R\+O\+W and F\+S\+I\+H\+R\+O\+W respectively. The air temperature T\+A\+R\+O\+W is converted from degrees C to K. The zonal (U\+L\+R\+O\+W) and meridional (V\+L\+R\+O\+W) components of the wind speed are not available at the benchmark site; only the overall wind speed U\+V\+R\+O\+W is measured. However, C\+L\+A\+S\+S does not require wind direction for its calculations, so U\+L\+R\+O\+W is arbitrarily assigned the value of U\+V\+R\+O\+W and V\+L\+R\+O\+W is set to zero for this run. The input wind speed V\+M\+O\+D\+R\+O\+W is assigned the value of U\+V\+R\+O\+W. The cosine of the solar zenith angle C\+O\+S\+Z is calculated from the day of the year, the hour, the minute and the latitude using basic radiation geometry, and (avoiding vanishingly small numbers) is assigned to C\+S\+Z\+R\+O\+W. The fractional cloud cover F\+C\+L\+O\+R\+O\+W is not available at the benchmark site; a rough estimate is obtained by setting it to 1 when precipitation is occurring, and to the fraction of incoming diffuse radiation X\+D\+I\+F\+F\+U\+S otherwise (assumed to be 1 when the sun is at the horizon, and 0.\+10 when it is at the zenith). C\+L\+A\+S\+S\+I evaluates a series of derived atmospheric variables G\+A\+T\+P\+R\+E\+P assigns values to vectors governing the gather-\/scatter operations C\+L\+A\+S\+S\+G performs the gather operation, gathering variables from their positions as mosaic tiles within the modelled areas to long vectors of mosaic tiles C\+L\+A\+S\+S\+Z does the initial calculations for the energy and water balance checks; C\+L\+A\+S\+S\+A manages the calculation of albedos and other surface parameters; C\+L\+A\+S\+S\+T calls the subroutines associated with the surface energy balance calculations C\+L\+A\+S\+S\+W calls the subroutines associated with the surface water balance calculations C\+L\+A\+S\+S\+Z completes the energy and water balance checks for the current time step C\+L\+A\+S\+S\+S performs the scatter operation, scattering the variables from the long vectors of mosaic tiles back onto the configuration of mosaic tiles within grid cells. 