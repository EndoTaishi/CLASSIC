<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: Moss_photosynthesis</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Moss_photosynthesis</div>  </div>
</div><!--header-->
<div class="contents">

<p>Moss photosynthesis subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="memitem:ga74c6ae528153d57336622db389f4bdd3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__moss__photosynthesis.html#ga74c6ae528153d57336622db389f4bdd3">peatlands_mod::mosspht</a> (il1, il2, iday, qswnv, thliq, co2conc, tsurfk, zsnow, pres, Cmossmas, dmoss, anmoss, rmlmoss, cevapmoss, ievapmoss, ipeatland, daylength, pdd)</td></tr>
<tr class="separator:ga74c6ae528153d57336622db389f4bdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Moss photosynthesis subroutine. </p>
<p>Mosses are an important contributor to the primary production and the C sequestration in peatlands, owing to the low decomposability of the moss tissue. Sphagnum in peatlands grows at 20&ndash;1600 g biomass m <img class="formulaInl" alt="$^{-2} $" src="form_1911.png"/>/yr and accounts for about 50 % of the total peat volume (Turetsky, 2003). We have modified CTEM to include a moss C pool and moss litter pool along with the related C fluxes, i.e. photosynthesis, autotrophic respiration, heterotrophic respiration, and humification. The net photosynthesis of moss ( <img class="formulaInl" alt="$G_m)$" src="form_1912.png"/> is calculated from the gross photosynthesis ( <img class="formulaInl" alt="$G_{0,m})$" src="form_1913.png"/> and dark respiration ( <img class="formulaInl" alt="$R_{d,m}$" src="form_1914.png"/>):</p>
<p><img class="formulaInl" alt="$ G_m=G_{0,m}-R_{d,m} $" src="form_1915.png"/>.</p>
<p>The moss photosynthesis and dark respiration are calculated using the Farquhar~(1989) biochemical approach following the MWM (St-Hilaire et al., 2010) <a class="el" href="citelist.html#CITEREF_St-Hilaire2010-5e9">[56]</a> and CTEM (Melton and Arora, 2016) <a class="el" href="citelist.html#CITEREF_Melton2016-zx">[42]</a>, with modifications for integration with CLASS&ndash;CTEM and moss phenology. The leaf-level gross photosynthesis rate <img class="formulaInl" alt="$G_{0,m} $" src="form_1916.png"/> ( <img class="formulaInl" alt="$\mu $" src="form_1917.png"/> mol CO <img class="formulaInl" alt="$_2 $" src="form_1918.png"/> /m <img class="formulaInl" alt="$^2 $" src="form_1919.png"/>/s) is obtained as the minimum of the transportation limited photosynthesis rates ( <img class="formulaInl" alt="$J_s)$" src="form_1920.png"/> and the first root of the quadratic solution of the light-limited rate ( <img class="formulaInl" alt="$J_e)$" src="form_1921.png"/> and the Rubisco limited rate ( <img class="formulaInl" alt="$J_c)$" src="form_1922.png"/>. A logistic factor ( <img class="formulaInl" alt="$\varsigma$" src="form_1923.png"/>) is added with values 0 or 1 to introduce a seasonal control of moss photosynthesis. In the MWM, spring photosynthesis starts when the snow depth is below 0.05 m and the soil temperature at 5 cm depth goes above 0.5 C (Moore et al., 2006). Since in our case CLASS sets the minimum depth for melting, discontinuous snow to 0.10 m, this limits the spring photosynthesis to starting only once the snow is completely melted.</p>
<p><img class="formulaInl" alt="$ G_{0,m} = \quad \varsigma \min \left(J_{s},\frac{(J_{c}+J_{e})\pm \sqrt{{(J_c +J_ e )}^2 - 4(J_c +J_e)} }{2}\right) $" src="form_1924.png"/></p>
<p>The dark respiration in mosses ( <img class="formulaInl" alt="$R_{d,m})$" src="form_1925.png"/> is calculated as a function of the base dark respiration rate ( <img class="formulaInl" alt="$R_{d,m,0})$" src="form_1926.png"/>, which has a value of 1.1 ( <img class="formulaInl" alt="$\mu $" src="form_1917.png"/> mol CO <img class="formulaInl" alt="$_2 $" src="form_1918.png"/> /m <img class="formulaInl" alt="$^2 $" src="form_1919.png"/>/s) (Adkinson and Humphreys, 2011) scaled by the moss moisture ( <img class="formulaInl" alt="$f_{m,rd}$" src="form_1927.png"/>) and soil temperature functions ( <img class="formulaInl" alt="$f_{T,rd})$" src="form_1928.png"/>. The moss moisture function is based on the volumetric water content of the moss, <img class="formulaInl" alt="$\theta_m$" src="form_1929.png"/> (kg water /(kg dry mass)). The MWM models the relation between water content in mosses and dark respiration with optimal water content at 5.8 g water per g dry weight, following the approach in Frolking et al. (1996). We modified the relation for water content above the optimal water content, based on a recent discovery of a weak linear positive relation between the dark respiration rate and the water content above the optimal water content during the late summer and fall (Adkinson and Humphreys, 2011):</p>
<p><img class="formulaInl" alt="$R_{d,m} = R_{d,m,0} f_{m,rd} f_{T,{rd}}$" src="form_1930.png"/></p>
<p><img class="formulaInl" alt="$ f_{T,{rd}} = (3.22-(0.046 \cdot T_{moss})^{(T_{moss}-25/10)} $" src="form_1931.png"/></p>
<p><img class="formulaInl" alt="$ f_{m,rd} = 0$" src="form_1932.png"/> for <img class="formulaInl" alt="$ \theta_{m} <0.4 $" src="form_1933.png"/></p>
<p><img class="formulaInl" alt="$ f_{m,rd} = 0.35 \theta_{m}^{2/3}-0.14$" src="form_1934.png"/> for <img class="formulaInl" alt="$ 0.4\le \theta_m<5.8 $" src="form_1935.png"/></p>
<p><img class="formulaInl" alt="$ f_{m,rd} = 0.01 \theta_{m} +0.942$" src="form_1936.png"/> for <img class="formulaInl" alt="$5.8<\theta _{m} $" src="form_1937.png"/></p>
<p>Photosynthetic photon flux density (PPFD) is measured by the photosynthetically active radiation (PAR), which is defined as the solar radiation between 0.4 to 0.7 <img class="formulaInl" alt="$\mu $" src="form_1917.png"/> mol that can be used by plants via photosynthesis. In the coupled CLASS&ndash;CTEM system, the PAR received by the moss (PAR <img class="formulaInl" alt="$_m$" src="form_1938.png"/>, unit <img class="formulaInl" alt="$\mu $" src="form_1917.png"/>mol photons m <img class="formulaInl" alt="$^-2$" src="form_1939.png"/>/s is converted from the visible short-wave radiation reaching the ground ( <img class="formulaInl" alt="$K_{\ast g}$" src="form_1940.png"/>, unit W/m <img class="formulaInl" alt="$^2$" src="form_1941.png"/>) in CLASS by a factor of 4.6 <img class="formulaInl" alt="$\mu$" src="form_1942.png"/> mol /m <img class="formulaInl" alt="$^2$" src="form_1941.png"/>/s per W/m <img class="formulaInl" alt="$^2$" src="form_1941.png"/> (McCree, 1972). <img class="formulaInl" alt="$K_{\ast g}$" src="form_1940.png"/> is a function of the incoming short-wave radiation ( <img class="formulaInl" alt="$K\downarrow $" src="form_1943.png"/>, unit: W/m <img class="formulaInl" alt="$^2$" src="form_1941.png"/>), the surface albedo ( <img class="formulaInl" alt="$\alpha_g$" src="form_1602.png"/>), and the canopy transmissivity ( <img class="formulaInl" alt="$\tau _c$" src="form_1944.png"/>):</p>
<p><img class="formulaInl" alt="$K_{\ast g} = K \downarrow \tau_{c}\left( 1-\alpha_{g}\right)$" src="form_1945.png"/></p>
<p>The energy uptake by the moss layer is thus a function of the total incoming short-wave radiation, the aggregated LAI of the PFTs present, the snow depth, the fractional vegetation cover, and the soil water content (Verseghy, 2012). In peatland C models that do not consider vegetation dynamics, the transmissivity of the vegetation canopy is usually assumed to be constant (e.g. St-Hilaire et al., 2010) <a class="el" href="citelist.html#CITEREF_St-Hilaire2010-5e9">[56]</a>. Compared with such models, CLASS enables a more detailed representation of light incident on the moss surface since it includes partitioning of direct/diffuse and visible/near-IR radiation, PFT-specific transmissivities, and time-varying LAI and fractional PFT coverages (Verseghy, 2012) <a class="el" href="citelist.html#CITEREF_Verseghy2012-c0e">[59]</a>. </p>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ga74c6ae528153d57336622db389f4bdd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public peatlands_mod::mosspht </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>qswnv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd), intent(in)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>co2conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>tsurfk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>zsnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>Cmossmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>dmoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(out)&#160;</td>
          <td class="paramname"><em>anmoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(out)&#160;</td>
          <td class="paramname"><em>rmlmoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(out)&#160;</td>
          <td class="paramname"><em>cevapmoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg), intent(out)&#160;</td>
          <td class="paramname"><em>ievapmoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>ipeatland</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(in)&#160;</td>
          <td class="paramname"><em>daylength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg), intent(inout)&#160;</td>
          <td class="paramname"><em>pdd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qswnv</td><td>visible short wave radiation = qswnv in TSOLVE and qswnvg in TSOLVC (W/m2)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tsurfk</td><td>grid average ground surface temprature in K</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmossmas</td><td>unit kg moss C updated in ctem</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dmoss</td><td>unit m, depth of living moss. assume = 2 cm can be related to mmoss as a variable</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ievapmoss</td><td>Value is 0 is no evaporation from moss, 1 otherwise</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">anmoss</td><td>net photosynthesis (umol CO2/m2/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rmlmoss</td><td>moss autotrophic respiration (umol CO2/m2/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cevapmoss</td><td>evaporation coefficent for moss surface </td></tr>
  </table>
  </dd>
</dl>
<p>phenology water factor on mosses ,grow when temperature &gt; -4.0 and snowpack &lt; 0.15 m </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__moss__photosynthesis_ga74c6ae528153d57336622db389f4bdd3_icgraph.png" border="0" usemap="#group__moss__photosynthesis_ga74c6ae528153d57336622db389f4bdd3_icgraph" alt=""/></div>
<!-- MAP 0 -->
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 5 2017 11:23:11 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
