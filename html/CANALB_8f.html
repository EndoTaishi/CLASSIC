<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM Documentation: CANALB.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CANALB.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Calculate vegetation albedos, transmissivities and stomatal resistances.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ad01e3318e7b9408fb2f037378ffb6589"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CANALB_8f.html#ad01e3318e7b9408fb2f037378ffb6589">canalb</a> (ALVSCN, ALIRCN, ALVSCS, ALIRCS, TRVSCN, TRIRCN, TRVSCS, TRIRCS, RC, RCS, ALVSC, ALIRC, RSMIN, QA50, VPDA, VPDB, PSIGA, PSIGB, FC, FCS, FSNOW, FSNOWC, FSNOCS, FCAN, FCANS, PAI, PAIS, AIL, PSIGND, FCLOUD, COSZS, QSWINV, VPD, TA, ACVDAT, ACIDAT, ALVSGC, ALIRGC, ALVSSC, ALIRSC, ILG, IL1, IL2, JL, IC, ICP1, IG, IALC, CXTEFF, TRVS, TRIR, RCACC, RCG, RCV, RCT, GC)</td></tr>
<tr class="separator:ad01e3318e7b9408fb2f037378ffb6589"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Calculate vegetation albedos, transmissivities and stomatal resistances. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ad01e3318e7b9408fb2f037378ffb6589"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine canalb </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRVSCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRIRCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRVSCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRIRCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>RC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>RCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,icp1)&#160;</td>
          <td class="paramname"><em>ALVSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,icp1)&#160;</td>
          <td class="paramname"><em>ALIRC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>RSMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>QA50</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>VPDA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>VPDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>PSIGA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>PSIGB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOWC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCANS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>AIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PSIGND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FCLOUD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>COSZS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>QSWINV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>VPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ACVDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ACIDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALVSSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ALIRSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IALC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>CXTEFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TRVS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TRIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>RCACC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>RCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>RCV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>RCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>GC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alvscn</td><td>Visible albedo of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">alircn</td><td>Near-IR albedo of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">alvscs</td><td>Visible albedo of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">alircs</td><td>Near-IR albedo of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">trvscn</td><td>Visible transmissivity of vegetation over bare ground <img class="formulaInl" alt="$[ ] (\tau_c)$" src="form_1194.png"/></td></tr>
    <tr><td class="paramname">trircn</td><td>Near-IR transmissivity of vegetation over bare ground <img class="formulaInl" alt="$[ ] (\tau_c)$" src="form_1194.png"/></td></tr>
    <tr><td class="paramname">trvscs</td><td>Visible transmissivity of vegetation over snow <img class="formulaInl" alt="$[ ] (\tau_c)$" src="form_1194.png"/></td></tr>
    <tr><td class="paramname">trircs</td><td>Near-IR transmissivity of vegetation over snow <img class="formulaInl" alt="$[ ] (\tau_c)$" src="form_1194.png"/></td></tr>
    <tr><td class="paramname">rc</td><td>Stomatal resistance of vegetation over bare ground <img class="formulaInl" alt="$[s m^{-1}] (r_c)$" src="form_1195.png"/></td></tr>
    <tr><td class="paramname">rcs</td><td>Stomatal resistance of vegetation over snow <img class="formulaInl" alt="$[s m^{-1}]$" src="form_1196.png"/></td></tr>
    <tr><td class="paramname">alvsc</td><td>Background average visible albedo of vegetation category [ ]</td></tr>
    <tr><td class="paramname">alirc</td><td>Background average near-infrared albedo of vegetation category [ ]</td></tr>
    <tr><td class="paramname">rsmin</td><td>Minimum stomatal resistance of vegetation category <img class="formulaInl" alt="$[s m^{-1}] (r_{s,min})$" src="form_1197.png"/></td></tr>
    <tr><td class="paramname">qa50</td><td>Reference value of incoming shortwave radiation for vegetation category (used in stomatal resistance calculation) <img class="formulaInl" alt="$[W m^{-2}] (K \downarrow_{1/2})$" src="form_1198.png"/></td></tr>
    <tr><td class="paramname">vpda</td><td>Vapour pressure deficit coefficient for vegetation category (used in stomatal resistance calculation) <img class="formulaInl" alt="$[ ] (c_{v1})$" src="form_1199.png"/></td></tr>
    <tr><td class="paramname">vpdb</td><td>Vapour pressure deficit coefficient for vegetation category (used in stomatal resistance calculation) <img class="formulaInl" alt="$[ ] (c_{v2})$" src="form_1200.png"/></td></tr>
    <tr><td class="paramname">psiga</td><td>Soil moisture suction coefficient for vegetation category (used in stomatal resistance calculation) <img class="formulaInl" alt="$[ ] (c_{\Psi 1})$" src="form_1201.png"/></td></tr>
    <tr><td class="paramname">psigb</td><td>Soil moisture suction coefficient for vegetation category (used in stomatal resistance calculation) <img class="formulaInl" alt="$[ ] (c_{\Psi 2})$" src="form_1202.png"/></td></tr>
    <tr><td class="paramname">fcan</td><td>Fractional coverage of vegetation category over bare ground <img class="formulaInl" alt="$[ ] (X_i)$" src="form_1178.png"/></td></tr>
    <tr><td class="paramname">fcans</td><td>Fractional coverage of vegetation category over snow [ ]</td></tr>
    <tr><td class="paramname">pai</td><td>Plant area index of vegetation category over bare ground <img class="formulaInl" alt="$[ ] (\Lambda_p)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">pais</td><td>Plant area index of vegetation category over snow <img class="formulaInl" alt="$[ ] (\Lambda_p)$" src="form_1203.png"/></td></tr>
    <tr><td class="paramname">acvdat</td><td>Optional user-specified value of canopy visible albedo to override CLASS-calculated value [ ]</td></tr>
    <tr><td class="paramname">acidat</td><td>Optional user-specified value of canopy near-infrared albedo to override CLASS- calculated value [ ]</td></tr>
    <tr><td class="paramname">ail</td><td>Leaf area index of vegetation category over bare ground <img class="formulaInl" alt="$[ ] (\Lambda)$" src="form_1204.png"/></td></tr>
    <tr><td class="paramname">fc</td><td>Fractional coverage of canopy over bare ground [ ]</td></tr>
    <tr><td class="paramname">fcs</td><td>Fractional coverage of canopy over snow [ ]</td></tr>
    <tr><td class="paramname">fsnow</td><td>Diagnosed fractional snow coverage [ ]</td></tr>
    <tr><td class="paramname">fsnowc</td><td>Fractional coverage of canopy by frozen water over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">fsnocs</td><td>Fractional coverage of canopy by frozen water over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">psignd</td><td>Minimum liquid moisture suction in soil layers <img class="formulaInl" alt="$[m] (\Psi_s)$" src="form_1205.png"/></td></tr>
    <tr><td class="paramname">fcloud</td><td>Fractional cloud cover <img class="formulaInl" alt="$[ ] (X_i) $" src="form_1206.png"/></td></tr>
    <tr><td class="paramname">coszs</td><td>Cosine of solar zenith angle [ ]</td></tr>
    <tr><td class="paramname">qswinv</td><td>Visible radiation incident on horizontal surface <img class="formulaInl" alt="$[W m^{-2}] (K)$" src="form_1207.png"/></td></tr>
    <tr><td class="paramname">vpd</td><td>Vapour pressure deficit of air <img class="formulaInl" alt="$[mb] {\Delta e }$" src="form_1208.png"/></td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height <img class="formulaInl" alt="$[K] (T_a) $" src="form_1209.png"/></td></tr>
    <tr><td class="paramname">alvsgc</td><td>Visible/near-IR albedo of bare ground under vegetation [ ]</td></tr>
    <tr><td class="paramname">alirgc</td><td>Visible/near-IR albedo of bare ground under vegetation [ ]</td></tr>
    <tr><td class="paramname">alvssc</td><td>Visible/near-IR albedo of snow under vegetation [ ]</td></tr>
    <tr><td class="paramname">alirsc</td><td>Visible/near-IR albedo of snow under vegetation [ ] </td></tr>
  </table>
  </dd>
</dl>
<p>The transmissivity <img class="formulaInl" alt="$\tau_c$" src="form_661.png"/> of a vegetation canopy to shortwave radiation is obtained by applying a form of Beer’s law of radiation transfer in non-scattering media: <img class="formulaInl" alt="$\tau_c = exp[-\kappa \Lambda_p]$" src="form_662.png"/> where <img class="formulaInl" alt="$\kappa$" src="form_663.png"/> is the canopy extinction coefficient and <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/> is the plant area index. The extinction coefficient is calculated after Goudriaan (1988) as <img class="formulaInl" alt="$\kappa = \epsilon O/cos(Z)$" src="form_665.png"/> where epsilon is a correction factor less than or equal to 1, accounting for forward-scattering of radiation and non-random leaf distributions (i.e. clumping), O represents the mean projected leaf area fraction perpendicular to the incoming radiation, and Z is the zenith angle of the incoming radiation. For crops, grass and needleleaf trees, the distribution of leaf angles is assumed to be spherical, and thus O = 0.5. For broadleaf trees, the preferred leaf orientation tends to be horizontal; thus O = cos(Z).</p>
<p>In the clear-sky case, incoming shortwave radiation is dominated by the direct beam; thus, the transmissivity for clear skies <img class="formulaInl" alt="$\tau_{c,0}$" src="form_666.png"/> is evaluated by simply setting Z to <img class="formulaInl" alt="$Z_s$" src="form_667.png"/>, the solar zenith angle. An extensive search of the literature for values of epsilon appropriate to the four vegetation categories yielded the following results for the extinction coefficient:</p>
<p><img class="formulaInl" alt="$\kappa = 0.3/cos(Z_s) (needleleaf trees)$" src="form_668.png"/> <img class="formulaInl" alt="$\kappa = 0.4 (broadleaf trees, full canopy)$" src="form_669.png"/> <img class="formulaInl" alt="$\kappa = 0.4/cos(Z_s) (broadleaf trees, leafless)$" src="form_670.png"/> <img class="formulaInl" alt="$\kappa = 0.4/cos(Z_s) (crops and grass)$" src="form_671.png"/></p>
<p>In the visible range of the shortwave spectrum, scattering is less important because of high leaf absorptivities. The following results were obtained for visible radiation:</p>
<p><img class="formulaInl" alt="$\kappa = 0.4/cosZ_s (needleleaf trees)$" src="form_672.png"/> <img class="formulaInl" alt="$\kappa = 0.7 (broadleaf trees, full canopy)$" src="form_673.png"/> <img class="formulaInl" alt="$\kappa = 0.4/cosZ_s (broadleaf trees, leafless)$" src="form_674.png"/> <img class="formulaInl" alt="$\kappa = 0.5/cosZ_s (crops and grass)$" src="form_675.png"/></p>
<p>In the case of overcast skies, the hemispherical distribution of incoming shortwave radiation is modelled using the generally accepted “standard overcast sky” distribution (e.g. Steven and Unsworth, 1980), where the shortwave radiation D(Z) emanating from a sky zenith angle Z is approximated as</p>
<p><img class="formulaInl" alt="$D(Z) = D(0) [(1 + 1.23cosZ)/2.23].$" src="form_676.png"/></p>
<p>Integration of the cloudy-sky transmissivity <img class="formulaInl" alt="$tau_{c,cloudy}$" src="form_677.png"/> over the sky hemisphere is performed using a simple weighting function proposed by Goudriaan (1988):</p>
<p><img class="formulaInl" alt="$\tau_{c,cloudy} = 0.3 \tau_c(Z=15^o) + 0.5 \tau_c(Z=45^o) + 0.2 \tau_c(Z=75^o)$" src="form_678.png"/></p>
<p>The albedo <img class="formulaInl" alt="$\alpha_c$" src="form_679.png"/> of a vegetation canopy is, like the transmissivity, dependent in principle on the zenith angle Z of the incoming radiation and the mean projected leaf area fraction O. However, in practice the observed diurnal and seasonal variation of vegetation albedo tends to be slight for closed canopies or for radiation zenith angles larger than a few degrees. Since the former is generally true in the tropics and the latter in the extratropics, the diurnal variation of visible and near-infrared canopy albedo is neglected in CLASS.</p>
<p>Corrections are applied to the average albedos to account for the effects of intercepted snow on the canopy and incomplete canopy closure. The presence of snow on the canopy will increase the albedo; this increase will be larger in the visible range of the spectrum, since the visible albedo of vegetation is typically very small. Making use of data presented by Leonard and Eschner (1968), the visible albedo of snow-covered vegetation is set to 0.17. The near-infrared albedo, being larger in magnitude, will be affected to a lesser degree, and is therefore set to the background near-infrared albedo plus 0.04.</p>
<p>If the canopy closure is incomplete, a fraction chi of the ground or snow under the canopy will be visible through gaps in it. This fraction is equal to the sky view factor of the underlying surface, which is calculated using an equation analogous to that for the canopy transmissivity, as an exponential function of the plant area index <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/>:</p>
<p><img class="formulaInl" alt="$\chi = exp[-c\Lambda_p]$" src="form_680.png"/></p>
<p>where c is a constant depending on the vegetation category. The overall albedo <img class="formulaInl" alt="$\alpha_T$" src="form_681.png"/> is calculated as a weighted average of the canopy albedo and the underlying ground or snow albedo (the latter weighted by the canopy transmissivity, to account for the decreased downwelling shortwave radiation at the surface):</p>
<p><img class="formulaInl" alt="$\alpha_T = (1 – \chi) \alpha_c + \chi \tau_c \alpha_0$" src="form_682.png"/></p>
<p>where <img class="formulaInl" alt="$alpha_0$" src="form_683.png"/> is the albedo of the surface under the canopy.</p>
<p>At the beginning of the subroutine, a series of work arrays is initialized to zero. Then the transmissivity and albedo of each vegetation category are calculated in turn, first over bare soil and then over a snow pack. After each of the latter sets of calculations, consistency checks are carried out to ensure that the calculated albedos and transmissivities are not less than 0 or greater than 1, and that the transmissivity is not greater than 90% of the non-reflected radiation.</p>
<p>The clear-sky and cloudy-sky transmissivities in the visible range are calculated first, and then the clear-sky and cloudy-sky transmissivities in the total shortwave spectrum, using the extinction coefficient equations above. (For broadleaf trees, the minimum of the full-canopy and leafless calculated values is used.) The overall transmissivity in the visible range at the current time step is obtained as an average of the clear and cloudy-sky values, weighted according to the fractional cloud cover. The effective overall extinction coefficient CXTEFF in the visible range is computed for use later on in the stomatal resistance calculation. The overall transmissivity for the entire shortwave spectrum at the current time step is similarly obtained as an average of the clear and cloudy-sky values, weighted according to the fractional cloud cover. The near-infrared transmissivity is calculated from the total and visible transmissivities, making use of the assumption that visible and near-infrared radiation each typically comprise 50% of the incoming shortwave radiation. Lastly, the aggregated visible and near-infrared transmissivities for the bulk canopy are incremented using the current values weighted by the fractional coverage of the vegetation category. At the end, the sum is normalized by the total fractional vegetation coverage in the subarea.</p>
<p>For the albedos, first the sky view factor and the near-infrared albedo of snow-covered vegetation are calculated. Next, a branch directs further processing depending on the value of the flag IALC. If IALC = 0, the CLASS-calculated visible and near-infrared vegetation albedos are used. These albedos are corrected for the presence of intercepted snow, using an average of the snow- covered and background snow-free albedos weighted according to FSNOWC over snow-free, and FSNOCS over snow-covered subareas (representing the ratio of the amount of snow present on the canopy relative to the interception capacity). The correction for incomplete canopy closure is applied to the resulting visible and near- infrared albedos as described above. If IALC = 1, user- specified albedos for the vegetation canopy are used instead of the CLASS values. These are assumed to incorporate the effects of incomplete canopy closure, but not of the presence of snow. Thus the CLASS values for the albedo of snow-covered vegetation and the albedo of snow under the canopy are still used in the averaging. Finally, the aggregated visible and near-infrared albedos for the bulk canopy are incremented using the current values weighted by the fractional coverage of the vegetation category. At the end, the sum is normalized by the total fractional vegetation coverage in the subarea.</p>
<p>In the final section, the stomatal resistance <img class="formulaInl" alt="$r_c$" src="form_684.png"/> of the vegetation canopy is determined. Based on the analysis of Schulze et al. (1995), the unstressed stomatal resistance <img class="formulaInl" alt="$r_{c,u}$" src="form_685.png"/> for a given vegetation category can be calculated as a function of the incoming visible shortwave radiation <img class="formulaInl" alt="$K\downarrow$" src="form_686.png"/>:</p>
<p><img class="formulaInl" alt="$r_{c,u} = r_{s,min} \kappa_e / ln[{K\downarrow + K\downarrow_{1/2} / \kappa_e} / { K\downarrow exp(-\kappa_e \Lambda ) + K\downarrow_{1/2} / \kappa_e }]$" src="form_687.png"/></p>
<p>where <img class="formulaInl" alt="$r_{s,min}$" src="form_688.png"/> is the minimum stomatal resistance for the vegetation category, <img class="formulaInl" alt="$\kappa_e$" src="form_689.png"/> is the extinction coeffient for visible radiation (CXTEFF above), <img class="formulaInl" alt="$\Lambda$" src="form_0.png"/> is the leaf area index, and <img class="formulaInl" alt="$K\downarrow_{1/2}$" src="form_690.png"/> is the value of <img class="formulaInl" alt="$K\downarrow$" src="form_686.png"/> at which <img class="formulaInl" alt="$r_{c,u} = 2 r_{s,min}.$" src="form_691.png"/></p>
<p>Suboptimum environmental conditions for transpiration may lead to stresses on the plant, causing the stomatal resistance to be greater than its unstressed value. The effects of these stresses are modelled by defining functions of the air temperature <img class="formulaInl" alt="$T_a$" src="form_692.png"/>, the air vapour pressure deficit <img class="formulaInl" alt="$\Delta e$" src="form_693.png"/>, and the soil moisture suction <img class="formulaInl" alt="$\Psi_s$" src="form_694.png"/>. These functions are used to derive <img class="formulaInl" alt="$r_{c,i}$" src="form_695.png"/> of each vegetation category on the basis of <img class="formulaInl" alt="$r_{c,u,i}$" src="form_696.png"/>:</p>
<p><img class="formulaInl" alt="$r_{c,i} = f(T_a) f( \Delta_e ) f( \Psi_s ) * r_{c,u,i}$" src="form_697.png"/></p>
<p>The air temperature function <img class="formulaInl" alt="$f(T_a)$" src="form_698.png"/> has a value of 1 for temperatures between <img class="formulaInl" alt="$5^o C$" src="form_699.png"/> and <img class="formulaInl" alt="$40^o C$" src="form_700.png"/>, and an arbitrary large value of 250 for temperatures less than <img class="formulaInl" alt="$-5^o C$" src="form_701.png"/> and greater than <img class="formulaInl" alt="$50^o C$" src="form_702.png"/>. Between these points it varies in a linear fashion. For the vapour pressure deficit function <img class="formulaInl" alt="$f( \Delta e )$" src="form_703.png"/>, two alternate forms are provided, after Oren et al. (1999) and Wu et al. (2000) respectively:</p>
<p><img class="formulaInl" alt="$f( \Delta e) = [( \Delta e/10.0)^{cv2}]/c_{v1}$" src="form_704.png"/> and <img class="formulaInl" alt="$f(\Delta e) = 1/[exp(-c_{v1} \Delta e/10.0)]$" src="form_705.png"/></p>
<p>where <img class="formulaInl" alt="$c_{v1}$" src="form_706.png"/> and <img class="formulaInl" alt="$c_{v2}$" src="form_707.png"/> are parameters depending on the vegetation category. If <img class="formulaInl" alt="$c_{v2}$" src="form_707.png"/> is greater than zero, the first form is used; if not, the second form is used. The soil moisture suction function <img class="formulaInl" alt="$f(\Psi_s)$" src="form_708.png"/> is expressed, following Choudhury and Idso (1985) and Fisher et al. (1981), as:</p>
<p><img class="formulaInl" alt="$f(\Psi_s) = 1 + (\Psi_s / c_{\Psi 1})^{c \Psi 2}$" src="form_709.png"/></p>
<p>where <img class="formulaInl" alt="$c_{\Psi 1}$" src="form_710.png"/> and <img class="formulaInl" alt="$c_{\Psi 2}$" src="form_711.png"/> are parameters depending on the vegetation category. Finally, the aggregated stomatal resistance for the canopy over the bare ground subarea is obtained as a weighted average over the vegetation categories. (It is assumed that transpiration is suppressed when snow is present under the canopy, so rc for this subarea is set to a large number). Since, following the electrical analogy, resistances act in parallel, the aggregated resistance for the subarea of canopy over bare ground is obtained as an average of inverses:</p>
<p><img class="formulaInl" alt="$X/r_c = \Sigma (X_i / r_{c,i})$" src="form_712.png"/></p>
<p>The calculations described above pertaining to stomatal resistances are performed in loops 850, 900 and 950. In the 850 loop, <img class="formulaInl" alt="$f(T_a)$" src="form_698.png"/> is evaluated. In the 900 loop, for each vegetation category in turn, <img class="formulaInl" alt="$f(\Delta e)$" src="form_713.png"/>, <img class="formulaInl" alt="$f(\Psi_s)$" src="form_708.png"/> and <img class="formulaInl" alt="$r_{c,i}$" src="form_695.png"/> are determined. <img class="formulaInl" alt="$r_{c,i}$" src="form_695.png"/> is assigned upper and lower limits of 5000 and 10 <img class="formulaInl" alt="$s m^{-1}$" src="form_714.png"/> respectively, and the accumulated stomatal resistance for the canopy is incremented by <img class="formulaInl" alt="$X_i / r_{c,i}$" src="form_715.png"/>. In loop 950, FRMAX, the maximum value of FROOT, the fraction of transpiration apportioned to each soil layer, is determined. If FRMAX is vanishingly small, transpiration is suppressed by setting the stomatal resistances over the vegetated subareas to a large number. If the incoming visible radiation is small, the stomatal resistances are likewise set to a large number. Otherwise, the stomatal resistance of vegetation over snow is set to a large number, and the normalized, aggregated stomatal resistance of vegetation over soil is obtained by inverting the accumulated value.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 31 2016 14:29:32 for CLASS-CTEM Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
