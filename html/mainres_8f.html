<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: mainres.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mainres.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) Maintenance Respiration Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a86c41356a868e2ef9d08ffb14f45aff5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mainres_8f.html#a86c41356a868e2ef9d08ffb14f45aff5">mainres</a> (fcan,fct,stemmass,rootmass,il1, il2, leapnow,tcan,tbar,rmatctem,sort, nol2pfts,isand,</td></tr>
<tr class="separator:a86c41356a868e2ef9d08ffb14f45aff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Canadian Terrestrial Ecosystem Model (CTEM) Maintenance Respiration Subroutine. </p>
<p>Autotrophic respiration ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_1044.png"/>) is composed of maintenance, <img class="formulaInl" alt="$R_\mathrm{m}$" src="form_1065.png"/>, and growth respirations, <img class="formulaInl" alt="$R_\mathrm{g}$" src="form_1066.png"/>, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_\mathrm{a} =R_\mathrm{m} + R_\mathrm{g}. \]" src="form_255.png"/>
</p>
<p> Maintenance respiration accounts for carbon consumed by processes that keep existing plant tissues alive and is a function of environmental stresses. Maintenance respiration is calculated on a half-hourly time step (with photosynthesis) for the leaves, <img class="formulaInl" alt="$R_{mL}$" src="form_1067.png"/>, and at a daily time step for the stem, <img class="formulaInl" alt="$R_{mS}$" src="form_1068.png"/>, and root, <img class="formulaInl" alt="$R_{mR}$" src="form_1069.png"/>, components </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{mainres_all} R_\mathrm{m} = R_{mL} + R_{mS} + R_{mR}. \]" src="form_258.png"/>
</p>
<p>Maintenance respiration is generally strongly correlated with nitrogen content <a class="el" href="citelist.html#CITEREF_Reich1998-zr">[50]</a> <a class="el" href="citelist.html#CITEREF_Ryan1991-ai">[51]</a>. The current version of CTEM does not explicitly track nitrogen in its vegetation components. Therefore, we adopt the approach of <a class="el" href="citelist.html#CITEREF_Collatz1991-5bc">[17]</a> <a class="el" href="citelist.html#CITEREF_Collatz1992-jf">[18]</a> in which the close relation between maximum catalytic capacity of Rubisco, <img class="formulaInl" alt="$V_\mathrm{m}$" src="form_1070.png"/>, and leaf nitrogen content is used as a proxy to estimate leaf maintenance respiration, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_{mL} = \varsigma_\mathrm{L}V_\mathrm{m}\,f_{25}(Q_10d,n)f_{PAR}, \]" src="form_259.png"/>
</p>
<p> where <img class="formulaInl" alt="$\varsigma_\mathrm{L}$" src="form_1071.png"/> is set to 0.015 and 0.025 for <img class="formulaInl" alt="$C_3$" src="form_135.png"/> and <img class="formulaInl" alt="$C_4$" src="form_136.png"/> plants, respectively, <img class="formulaInl" alt="$f_{PAR}$" src="form_1072.png"/> scales respiration from the leaf to the canopy level, similar to Eq. (G_canopy}), and the <img class="formulaInl" alt="$f_{25}(Q_10d,n)$" src="form_1073.png"/> function accounts for different temperature sensitivities of leaf respiration during day ( <img class="formulaInl" alt="$d$" src="form_263.png"/>) and night ( <img class="formulaInl" alt="$n$" src="form_264.png"/>). <a class="el" href="citelist.html#CITEREF_Pons2003-f26">[47]</a> and <a class="el" href="citelist.html#CITEREF_Xu2003-d75">[63]</a> suggest lower temperature sensitivity for leaf respiration during the day compared to night, and therefore we use values of <img class="formulaInl" alt="$Q_10d=1.3$" src="form_1074.png"/> and <img class="formulaInl" alt="$Q_10n=2.0$" src="form_1075.png"/> for day and night, respectively.</p>
<p>Maintenance respiration from the stem and root components is estimated based on PFT-specific base respiration rates ( <img class="formulaInl" alt="$\varsigma_\mathrm{S}$" src="form_1076.png"/> and <img class="formulaInl" alt="$\varsigma_\mathrm{R}$" src="form_1077.png"/> specified at <img class="formulaInl" alt="$15\,C$" src="form_269.png"/>, <img class="formulaInl" alt="$kg\,C\,(kg\,C)^{-1}\,yr^{-1}$" src="form_270.png"/>; see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) that are modified to account for temperature response following a <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> function. Maintenance respiration from stem and root components, <img class="formulaInl" alt="$R_{m\{S,R\}}$" src="form_1078.png"/>, is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{r_msr} R_{\mathrm{m},i} = 2.64 \times 10^{-6}\varsigma_{i}l_{\mathrm{v}, i}C_{i}f_{15}(Q_{10}),\quad i = \mathrm{S}, \mathrm{R}, \]" src="form_272.png"/>
</p>
<p> where <img class="formulaInl" alt="$l_{v,i}$" src="form_1079.png"/> is the live fraction of stem or root component, i.e. the sapwood, and <img class="formulaInl" alt="$C_i$" src="form_1080.png"/> is the stem or root carbon mass ( <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_100.png"/>). The constant <img class="formulaInl" alt="$2.64 \times 10^{-6}$" src="form_1049.png"/> converts units from <img class="formulaInl" alt="$kg\,C\,m^{-2}\,yr^{-1}$" src="form_276.png"/> to <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_1044.png"/>. The live sapwood fraction, <img class="formulaInl" alt="$l_{\mathrm{v},i}$" src="form_1081.png"/>, for stem or root component is calculated following the CENTURY model <a class="el" href="citelist.html#CITEREF_Parton1996-zv">[46]</a> as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ l_{\mathrm{v},i} = \max(0.05, \min[1.0, \exp^{-0.2835 C_i} ]),\quad i = \mathrm{S}, \mathrm{R}. \]" src="form_649.png"/>
</p>
<p>The <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> value used in Eq. (r_msr}) is not assumed to be constant but modelled as a function of temperature following <a class="el" href="citelist.html#CITEREF_Tjoelker2001-uz">[56]</a> as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q_{10} = 3.22 - 0.046 \left(\frac{15.0 + T_{\{S,R\}}}{1.9}\right), \]" src="form_279.png"/>
</p>
<p> where <img class="formulaInl" alt="$T_{\{S,R\}}$" src="form_1082.png"/> is stem or root temperature ( <img class="formulaInl" alt="$C$" src="form_27.png"/>). Stem temperature is assumed to be the same as air temperature while root temperature is based on the soil temperature weighted by the fraction of roots present in each soil layer <a class="el" href="citelist.html#CITEREF_Arora2003838">[4]</a>. The calculated <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> value is additionally constrained to be between 1.5 and 4.0.</p>
<p>Growth respiration, <img class="formulaInl" alt="$R_\mathrm{g}$" src="form_1066.png"/> ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_1044.png"/>), is estimated as a fraction ( <img class="formulaInl" alt="$\epsilon_\mathrm{g}=0.15$" src="form_1083.png"/>) of the positive gross canopy photosynthetic rate after maintenance respiration has been accounted for </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{growth_res} R_\mathrm{g}=\epsilon_\mathrm{g}\max[0,(G_{canopy} - R_\mathrm{m})]. \]" src="form_282.png"/>
</p>
<p> Finally, net primary productivity ( <img class="formulaInl" alt="$NPP$" src="form_283.png"/>) is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ NPP = G_{canopy} - R_\mathrm{m} - R_\mathrm{g}. \]" src="form_284.png"/>
</p>
 </div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a86c41356a868e2ef9d08ffb14f45aff5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mainres </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>fct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>tcan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>tbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd)&#160;</td>
          <td class="paramname"><em>rmatctem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>isand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramname">sort</td><td>index for correspondence between 9 pfts and 12 values in the parameter vectors</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramname">isand</td><td>flag for bedrock or ice in a soil layer</td></tr>
    <tr><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramname">fcan</td><td>fractional coverage of ctem's 9 pfts over the given sub-area</td></tr>
    <tr><td class="paramname">fct</td><td>sum of all fcan fcan &amp; fct are not used at this time but could be used at some later stage</td></tr>
    <tr><td class="paramname">stemmass</td><td>stem biomass for the 9 pfts in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">tcan</td><td>canopy temperature, k</td></tr>
    <tr><td class="paramname">tbar</td><td>soil temperature, k</td></tr>
    <tr><td class="paramname">rootmass</td><td>root biomass for the 9 pfts in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">rmatctem</td><td>fraction of roots in each layer for each pft </td></tr>
  </table>
  </dd>
</dl>
<hr/>
<p> Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a></p>
<p>set the following switch to .true. for using constant temperature indepedent q10 specified below</p>
<p>q10 - if using a constant temperature independent value, i.e. if consq10 is set to true</p>
<hr/>
<p>initialize required arrays to zero</p>
<p>initialization ends</p>
<p>based on root and stem biomass, find fraction which is live. for stem this would be the sapwood to total wood ratio.</p>
<p>fraction of roots for each vegetation type, for each soil layer, in each grid cell is given by rmatctem (grid cell, veg type, soil layer) which bio2str subroutine calculates. rmatctem can thus be used to find average root temperature for each plant functional type</p>
<p>we assume that stem temperature is same as canopy temperature tcan. using stem and root temperatures we can find their maintenance respirations rates</p>
<p>first find the q10 response function to scale base respiration rate from 15 c to current temperature, we do the stem first.</p>
<p>when finding temperature dependent q10, use temperature which is close to average of actual temperature and the temperature at which base rate is specified</p>
<p>This q10 value is then used with the base rate of respiration (commonly taken at some reference temperature (15 deg c), see Tjoelker et al. 2009 New Phytologist or Atkin et al. 2000 New Phyto for an example.). Long-term acclimation to temperature could be occuring see King et al. 2006 Nature SOM for a possible approach. JM.</p>
<p>convert kg c/m2.day -&gt; u mol co2/m2.sec</p>
<p>root respiration</p>
<p>convert kg c/m2.day -&gt; u mol co2/m2.sec </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mainres_8f_a86c41356a868e2ef9d08ffb14f45aff5_icgraph.png" border="0" usemap="#mainres_8f_a86c41356a868e2ef9d08ffb14f45aff5_icgraph" alt=""/></div>
<map name="mainres_8f_a86c41356a868e2ef9d08ffb14f45aff5_icgraph" id="mainres_8f_a86c41356a868e2ef9d08ffb14f45aff5_icgraph">
<area shape="rect" id="node2" href="ctem_8f90.html#ace1598599f37c24cac37dd963f23b497" title="ctem" alt="" coords="123,5,173,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 25 2017 15:37:32 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
