<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: Landuse_change_initialize_luc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Landuse_change_initialize_luc</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) LUC Initial Read-In Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="memitem:gaaeec2aeebe84601010ea8cedab85c4c0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__landuse__change__initialize__luc.html#gaaeec2aeebe84601010ea8cedab85c4c0">landuse_change::initialize_luc</a> (iyear, lucdat, nmtest, nltest, nol2pfts, cyclemet, cylucyr, lucyr, fcanrow, farerow, nfcancmxrow, pfcancmxrow, fcancmxrow, reach_eof, start_bare, compete, onetile_perPFT)</td></tr>
<tr class="separator:gaaeec2aeebe84601010ea8cedab85c4c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Canadian Terrestrial Ecosystem Model (CTEM) LUC Initial Read-In Subroutine. </p>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="gaaeec2aeebe84601010ea8cedab85c4c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public landuse_change::initialize_luc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iyear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(80), intent(in)&#160;</td>
          <td class="paramname"><em>lucdat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nmtest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nltest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican), intent(in)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>cyclemet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cylucyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>lucyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat,nmos,icp1), intent(inout)&#160;</td>
          <td class="paramname"><em>fcanrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat,nmos), intent(inout)&#160;</td>
          <td class="paramname"><em>farerow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat,nmos,icc), intent(out)&#160;</td>
          <td class="paramname"><em>nfcancmxrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat,nmos,icc), intent(out)&#160;</td>
          <td class="paramname"><em>pfcancmxrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nlat,nmos,icc), intent(out)&#160;</td>
          <td class="paramname"><em>fcancmxrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>reach_eof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>start_bare</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>compete</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>onetile_perPFT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">onetile_perpft</td><td>if you are running with one tile per PFT in mosaic mode, set to true. Changes how competition is run. Specifically it allows competition between tiles. This is not recommended for any case where you don't have one PFT in each tile as it has not been tested for that. </td></tr>
  </table>
  </dd>
</dl>
<hr/>
<p> Initialize barefraction to 1.0</p>
<p>reset the composite fcanrow as it is appended on later in a loop</p>
<p>it is the first year, so prepare the luc data:</p>
<p>open the luc file</p>
<p>Skip first three rows:</p>
<p>get first year of luc data note we load the nfcancmx, not pfcancmx array. this is because this nfcancmx value is passed to the pfcancmx array at the start of each simulation year</p>
<p>next update our luc data if either of the following conditions are met:</p>
<p>1) we are cycling the met data and the luc year we just read in is less than the year we want to cycle over (assuming it is not defaulted to -9999) or,</p>
<p>2) we are not cycling over the met data so we just want to get the same year of luc data as the met data we read in above in preparation for our transient run.</p>
<p>If you are running with start_bare on, take in only the crop fractions, set rest to seed. If compete, but not start bare, then just make sure you have at least seed for each pft.</p>
<p>not starting bare, but still make sure you have at least seed</p>
<p>Keep track of the non-crop nfcancmx for use in loop below. pftarrays keeps track of the nfcancmxrow for all non-crops indexposj and indexposm store the index values of the non-crops in a continuous array for use later. n and k are then the indexes used by these arrays.</p>
<p>check that in making these seed fraction we haven't made our total fraction more than 1.0.</p>
<p>Find out which of the non-crop PFTs covers the largest area.</p>
<p>j is then the nmos index and m is the icc index of the PFT with the largest area</p>
<p>Reduce the most dominant PFT by barf and minbare. The extra amount is to ensure we don't have trouble later with an extremely small bare fraction. barf is a negative value.</p>
<p>Find out which of the non-crop PFTs covers the largest area.</p>
<p>j is then the nmos index and m is the icc index of the PFT with the largest area</p>
<p>Reduce the most dominant PFT by barf and minbare. The extra amount is to ensure we don't have trouble later with an extremely small bare fraction. barf is a negative value.</p>
<p>get fcans for use by class using the nfcancmxs just read in</p>
<p>this tile has some plants so overwrite the seed fraction with an actual fraction</p>
<p>note: the seed fraction has already been assigned in runclassctem prior to entering this subroutine.</p>
<p>(re)find the bare fraction for farerow(i,iccp1)</p>
<p>check that the bare fraction is possible (&gt;0) and if not then reduce the other pfts proportionally to make a non-negative bare ground fraction.</p>
<p>competition requires a 'seed' fraction so make sure the bare ground is also that big. for prescribed runs you just need it to be possible (&gt;0).</p>
<p>assign the present pft fractions from those just read in</p>
<p>back up one year in the luc file this is because we were setting things up here, we will later call readin_luc so want the file to be rewound prior to that to the proper start year.</p>
<p>end of the luc file is reached. close and tell main program to exit </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 4 2017 18:16:57 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
