<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM Documentation: CLASSI.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSI.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Evaluate atmospheric variables and rainfall/snowfall rates over modelled area.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4e0212f4e58542e09cc303c2a0054949"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSI_8f.html#a4e0212f4e58542e09cc303c2a0054949">classi</a> (VPD, TADP, PADRY, RHOAIR, RHOSNI, RPCP, TRPCP, SPCP, TSPCP, TA, QA, PCPR, RRATE, SRATE, PRESSG, IPCP, NL, IL1, IL2)</td></tr>
<tr class="separator:a4e0212f4e58542e09cc303c2a0054949"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Evaluate atmospheric variables and rainfall/snowfall rates over modelled area. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a4e0212f4e58542e09cc303c2a0054949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classi </td>
          <td>(</td>
          <td class="paramtype">real, dimension   (nl)&#160;</td>
          <td class="paramname"><em>VPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>TADP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>PADRY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>RHOAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>RPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>TRPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>SPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>TSPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl)&#160;</td>
          <td class="paramname"><em>QA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl)&#160;</td>
          <td class="paramname"><em>PCPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>RRATE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl)&#160;</td>
          <td class="paramname"><em>SRATE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl)&#160;</td>
          <td class="paramname"><em>PRESSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IPCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vpd</td><td>Vapour pressure deficit of air <img class="formulaInl" alt="$[mb] (e_d)$" src="form_1232.png"/></td></tr>
    <tr><td class="paramname">tadp</td><td>Dew point temperature of air [K]</td></tr>
    <tr><td class="paramname">padry</td><td>Partial pressure of dry air <img class="formulaInl" alt="$[Pa] (p_{dry})$" src="form_1233.png"/></td></tr>
    <tr><td class="paramname">rhoair</td><td>Density of air <img class="formulaInl" alt="$[kg m^{-3}] (\rho_a)$" src="form_1234.png"/></td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow <img class="formulaInl" alt="$[kg m^{-3}] (\rho_{s,i})$" src="form_1235.png"/></td></tr>
    <tr><td class="paramname">rpcp</td><td>Calculated rainfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">trpcp</td><td>Rainfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">spcp</td><td>Calculated snowfall rate over modelled area <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">tspcp</td><td>Snowfall temperature over modelled area [C]</td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height <img class="formulaInl" alt="$[K] (T_a)$" src="form_1236.png"/></td></tr>
    <tr><td class="paramname">qa</td><td>Specific humidity at reference height <img class="formulaInl" alt="$[kg kg^{-1}] (q_a)$" src="form_1237.png"/></td></tr>
    <tr><td class="paramname">pressg</td><td>Surface atmospheric pressure <img class="formulaInl" alt="$[Pa] (p)$" src="form_1238.png"/></td></tr>
    <tr><td class="paramname">pcpr</td><td>Precipitation rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">rrate</td><td>Input rainfall rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">srate</td><td>Input snowfall rate over modelled area <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>In the first section, the air vapour pressure deficit, dry air pressure, air density and dew point temperature are calculated. The vapour pressure deficit <img class="formulaInl" alt="$e_d$" src="form_1239.png"/> (in units of mb) is obtained from the saturated and actual vapour pressures of the air, <img class="formulaInl" alt="$e_a$" src="form_1240.png"/> and <img class="formulaInl" alt="$e_{a,sat}$" src="form_1241.png"/> respectively (in units of Pa), as <img class="formulaInl" alt="$e_d = [e_{a,sat} - e_a] /100.0$" src="form_1242.png"/></p>
<p>The air vapour pressure is obtained from the specific humidity <img class="formulaInl" alt="$q_a$" src="form_1243.png"/> using the formula</p>
<p><img class="formulaInl" alt="$e_a = q_a p /[0.622 + 0.378 q_a ]$" src="form_1244.png"/></p>
<p>where p is the surface atmospheric pressure. For the saturated vapour pressure, a standard empirical equation is utilized relating <img class="formulaInl" alt="$e_{a,sat}$" src="form_1241.png"/> to the temperature <img class="formulaInl" alt="$T_a$" src="form_692.png"/> and the freezing point <img class="formulaInl" alt="$T_f$" src="form_1245.png"/>:</p>
<p><img class="formulaInl" alt="$e_{a,sat} = 611.0 exp[17.269*(T_a – T_f)/(T_a – 35.86)]$" src="form_1844.png"/> <img class="formulaInl" alt="$T_a \geq T_f$" src="form_1845.png"/></p>
<p><img class="formulaInl" alt="$e_{a,sat} = 611.0 exp[21.874 (T_a – T_f)/(T_a – 7.66)]$" src="form_1846.png"/> <img class="formulaInl" alt="$T_a < T_f$" src="form_1847.png"/></p>
<p>The partial pressure of dry air, <img class="formulaInl" alt="$p_{dry}$" src="form_1248.png"/>, is obtained by subtracting <img class="formulaInl" alt="$e_a$" src="form_1240.png"/> from p, and the density of the air is calculated as the sum of the densities of the dry air and the water vapour: <img class="formulaInl" alt="$\rho_a = p_{dry} / R_d T_a + e_a / R_v T_a$" src="form_1249.png"/></p>
<p>where <img class="formulaInl" alt="$R_d$" src="form_1250.png"/> and <img class="formulaInl" alt="$R_v$" src="form_1251.png"/> are the gas constants for dry air and water vapour respectively. The dew point temperature of the air is evaluated by substituting <img class="formulaInl" alt="$e_a$" src="form_1240.png"/> for <img class="formulaInl" alt="$e_{a,sat}$" src="form_1241.png"/> on the left-hand side of the appropriate equation above, and solving for <img class="formulaInl" alt="$T_a$" src="form_692.png"/>.</p>
<p>Finally, if IPCP = 4, this indicates that the partitioning between rainfall and snowfall has been done outside of CLASS. The rainfall and snowfall rates RRATE and SRATE that have been passed into the subroutine are therefore simply assigned to RPCP and SPCP.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 7 2016 18:08:21 for CLASS-CTEM Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
