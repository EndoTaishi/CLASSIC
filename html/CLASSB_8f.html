<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: CLASSB.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CLASSB.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Assign thermal and hydraulic properties to soil layers based on sand/clay content, or soil type. Also calculate permeable thickness of soil layers, and wet and dry surface albedo for mineral soils.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7ca965fc9694d6dc36fc64713e1b4e2f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CLASSB_8f.html#a7ca965fc9694d6dc36fc64713e1b4e2f">classb</a> (THPOR, THLRET, THLMIN, BI, PSISAT, GRKSAT, THLRAT, HCPS, TCS, THFC, THLW, PSIWLT, DELZW, ZBOTW, ALGWET, ALGDRY, ALGWV, ALGWN, ALGDV, ALGDN, SAND, CLAY, ORGM, SOCI, DELZ, ZBOT, SDEPTH, ISAND, IGDR, NL, NM, IL1, IL2, IM, IG, IGRALB, ipeatland)</td></tr>
<tr class="separator:a7ca965fc9694d6dc36fc64713e1b4e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Assign thermal and hydraulic properties to soil layers based on sand/clay content, or soil type. Also calculate permeable thickness of soil layers, and wet and dry surface albedo for mineral soils. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a7ca965fc9694d6dc36fc64713e1b4e2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine classb </td>
          <td>(</td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>GRKSAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLRAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>TCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm,ig)&#160;</td>
          <td class="paramname"><em>PSIWLT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>ALGWET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>ALGDRY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGWV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGWN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGDV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (nl,nm)&#160;</td>
          <td class="paramname"><em>ALGDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>SAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>CLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ORGM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (nl,nm)&#160;</td>
          <td class="paramname"><em>SOCI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>ZBOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>SDEPTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (nl,nm,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (nl,nm)&#160;</td>
          <td class="paramname"><em>IGDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IGRALB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nl,nm)&#160;</td>
          <td class="paramname"><em>ipeatland</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thpor</td><td>Pore volume <img class="formulaInl" alt="$[m^3 m^{-3} ] ( \theta_p )$" src="form_716.png"/></td></tr>
    <tr><td class="paramname">thlret</td><td>Liquid water retention capacity for organic soil <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{ret} )$" src="form_717.png"/></td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{min} )$" src="form_718.png"/></td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical parameter [ ] (b)</td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation [m] <img class="formulaInl" alt="$(\Psi_{sat} )$" src="form_719.png"/></td></tr>
    <tr><td class="paramname">grksat</td><td>Hydraulic conductivity of soil at saturation <img class="formulaInl" alt="$[m s^{-1} ] (K_{sat} )$" src="form_720.png"/></td></tr>
    <tr><td class="paramname">thlrat</td><td>Fractional saturation of soil at half the saturated hydraulic conductivity [ ] <img class="formulaInl" alt="$(f_{inf} )$" src="form_721.png"/></td></tr>
    <tr><td class="paramname">hcps</td><td>Volumetric heat capacity of soil matter <img class="formulaInl" alt="$[J m^{-3} K^{-1} ] (C_g )$" src="form_722.png"/></td></tr>
    <tr><td class="paramname">tcs</td><td>Thermal conductivity of soil <img class="formulaInl" alt="$[W m^{-1} K^{-1} ] (\tau_g )$" src="form_723.png"/></td></tr>
    <tr><td class="paramname">thfc</td><td>Field capacity <img class="formulaInl" alt="$[m^3 m^{-3} ] (\theta_{fc} )$" src="form_724.png"/></td></tr>
    <tr><td class="paramname">thlw</td><td>Soil water content at wilting point, <img class="formulaInl" alt="$[m^3 m^{-3} ]$" src="form_641.png"/></td></tr>
    <tr><td class="paramname">psiwlt</td><td>Soil moisture suction at wilting point [m] <img class="formulaInl" alt="$(\Psi_{wilt} )$" src="form_725.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Thickness of permeable part of soil layer [m]</td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth of bottom of permeable part of soil layer [m]</td></tr>
    <tr><td class="paramname">algwet</td><td>All-wave albedo of wet soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algdry</td><td>All-wave albedo of dry soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algwv</td><td>Visible albedo of wet soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algwn</td><td>NIR albedo of wet soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algdv</td><td>Visible albedo of dry soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">algdn</td><td>NIR albedo of dry soil for modelled area [ ]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">igdr</td><td>Index of soil layer in which bedrock is encountered</td></tr>
    <tr><td class="paramname">ipeatland</td><td>Peatland flag: 0 = not a peatland, 1= bog, 2 = fen</td></tr>
    <tr><td class="paramname">sand</td><td>Percent sand content of soil layer [percent] <img class="formulaInl" alt="$(X_{sand} )$" src="form_726.png"/></td></tr>
    <tr><td class="paramname">clay</td><td>Percent clay content of soil layer [percent] <img class="formulaInl" alt="$(X_{clay} )$" src="form_727.png"/></td></tr>
    <tr><td class="paramname">orgm</td><td>Percent organic matter content of soil layer [percent]</td></tr>
    <tr><td class="paramname">delz</td><td>Thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">zbot</td><td>Depth of bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">sdepth</td><td>Permeable depth of soil column (depth to bedrock) [m] <img class="formulaInl" alt="$(z_b )$" src="form_728.png"/></td></tr>
    <tr><td class="paramname">igralb</td><td>IF IGRALB IS SET TO 0, THE WET AND DRY SOIL ALBEDOS ARE CALCULATED ON THE BASIS OF SOIL TEXTURE. IF IT IS SET TO 1, THEY ARE ASSIGNED VALUES BASED ON THE NCAR CLM SOIL "COLOUR" DATASET. </td></tr>
  </table>
  </dd>
</dl>
<p>In the first section of code, two integer flags are evaluated: IGDR, the index of the soil layer in which the bottom of the soil permeable depth, <img class="formulaInl" alt="$z_b$" src="form_573.png"/> , occurs; and ISAND, the value of the SAND variable for each soil layer converted to an integer. ISAND is used throughout the CLASS code as a flag to determine which branches of code to execute.</p>
<p>In loop 200, calculations are done to determine the permeable thickness DELZW of each soil layer. If the land cover is an ice sheet (indicated by an ISAND value of -4 in the top layer), the value of DELZW in each layer is set to DELZ, the standard thickness of the corresponding thermal layer, and the soil flag is set to -4. If the layer consists of rock, indicated by an ISAND value of -3, DELZW is set to 0. For soil layers where <img class="formulaInl" alt="$z_b$" src="form_573.png"/> occurs below the bottom of the layer, DELZW is set to DELZ; for layers where <img class="formulaInl" alt="$z_b$" src="form_573.png"/> occurs near the top of the layer, DELZW is set to 0 and ISAND is set to -3. For the soil layer containing <img class="formulaInl" alt="$z_b$" src="form_573.png"/> , DELZW is set to the distance from the top of the layer to <img class="formulaInl" alt="$z_b$" src="form_573.png"/> , and is further constrained to be <img class="formulaInl" alt="$\geq$" src="form_10.png"/> 5 cm, to avoid overshoots in the water movement calculations. For all layers, the distance to the bottom of its respective permeable depth, ZBOTW, is set to the depth of the top of the layer plus DELZW. At the end of the loop, if the soil is a mineral one, the wet and dry albedo values are calculated using simple empirical functions derived from values given in Wilson and Henderson-Sellers (1985). (The dry albedo calculation varies slightly depending on whether or not CTEM is being run.)</p>
<p>In loop 300, various thermal and hydraulic soil properties are assigned to each of the soil layers, depending on soil type. Values of ISAND greater than zero indicate mineral soil. The pore volume <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> , the saturated hydraulic conductivity <img class="formulaInl" alt="$K_{sat}$" src="form_729.png"/> , and the soil moisture suction at saturation <img class="formulaInl" alt="$\Psi$" src="form_4.png"/> sat are calculated from the percentage sand content <img class="formulaInl" alt="$X_{sand}$" src="form_730.png"/> , and the hydraulic parameter b is calculated from the percentage clay content <img class="formulaInl" alt="$X_{clay}$" src="form_731.png"/> , based on empirical relationships given in Cosby et al. (1984): <img class="formulaInl" alt="$\theta_p = (-0.126 X_{sand} +48.9)/100.0$" src="form_732.png"/> <img class="formulaInl" alt="$b = 0.159 X_{clay} + 2.91$" src="form_733.png"/> <img class="formulaInl" alt="$\Psi_{sat} = 0.01 exp(-0.0302 X_{sand} + 4.33)$" src="form_734.png"/> <img class="formulaInl" alt="$K_{sat} = 7.0556 x 10 -6 exp(0.0352 X_{sand} - 2.035)$" src="form_735.png"/></p>
<p>The fractional saturation of the soil at half the saturated hydraulic conductivity, <img class="formulaInl" alt="$f_{inf}$" src="form_736.png"/> , is calculated by inverting the Clapp and Hornberger (1978) expression relating hydraulic conductivity <img class="formulaInl" alt="$K$" src="form_737.png"/> to liquid water content of the soil <img class="formulaInl" alt="$\theta_l$" src="form_738.png"/> : <img class="formulaInl" alt="$K = K_{sat} (\theta_l / \theta_p ) (2b + 3)$" src="form_739.png"/></p>
<p>Thus, <img class="formulaInl" alt="$f_{inf} = 0.5 1/(2b+3)$" src="form_740.png"/></p>
<p>The residual soil liquid water content remaining after evaporation or freezing, <img class="formulaInl" alt="$\theta_{min}$" src="form_741.png"/> , and the liquid water retention capacity, <img class="formulaInl" alt="$\theta_{ret}$" src="form_742.png"/> , are both set for mineral soils to a textbook value of 0.04. The volumetric sand, silt + clay and organic matter components of the soil matrix are derived by converting the percent values to volume fractions. The overall volumetric heat capacity of the soil material, <img class="formulaInl" alt="$C_g$" src="form_743.png"/> , is then calculated as a weighted average: <img class="formulaInl" alt="$C_g = \Sigma (C_{sand} \theta_{sand} + C_{fine} \theta_{fine} + C_{org} \theta_{org} )/(1 - \theta_p )$" src="form_744.png"/> where the subscript "fine" refers to the silt and clay particles taken together. The thermal conductivity of the soil material, <img class="formulaInl" alt="$\tau_g$" src="form_745.png"/> , is likewise calculated as a weighted average over the thermal conductivities of the components: <img class="formulaInl" alt="$\tau_g = \Sigma (\tau_{sand} \theta_{sand} + \tau_{fine} \theta_{fine} + \tau_{org} \theta_{org} )/(1 - \theta_p )$" src="form_746.png"/></p>
<p>The field capacity <img class="formulaInl" alt="$\theta_{fc}$" src="form_1168.png"/> , that is, the liquid water content of the soil at which gravitational drainage effectively ceases, is calculated by setting the expression for K above to a value of 0.1 mm <img class="formulaInl" alt="$d^{-1}$" src="form_1169.png"/> , and solving for the liquid water content: <img class="formulaInl" alt="$\theta_{fc} = \theta_p (1.157 x 10^{-9} /K_{sat} )^{1/(2b + 3)}$" src="form_1170.png"/></p>
<p>The only exception is the field capacity of the lowest permeable layer in mineral soils (layer IGDR), which is determined using an expression developed by Soulis et al. (2010), which takes into account the permeable depth of the whole overlying soil: <img class="formulaInl" alt="$\theta_{fc} = \theta_p /(b-1) \bullet (\Psi_{sat} b/ z_b )^{1/b} \bullet [(3b+2)^{(b-1)/b} - (2b+2)^{(b-1)/b} ]$" src="form_1171.png"/></p>
<p>The soil moisture suction <img class="formulaInl" alt="$\Psi_{wilt}$" src="form_754.png"/> at the wilting point (the liquid water content at which plant roots can no longer draw water from the soil) is calculated from the saturated soil moisture suction using the Clapp and Hornberger (1978) expression, with the liquid water content approximated as 0.5 <img class="formulaInl" alt="$\theta_{fc}$" src="form_1168.png"/> : <img class="formulaInl" alt="$\Psi_{wilt} = \Psi_{sat} (0.5 \theta_{fc} / \theta_p )^{-b}$" src="form_1172.png"/> Organic soils are flagged with an ISAND value of -2. For these soils, the variables <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> , b, <img class="formulaInl" alt="$K_{sat}$" src="form_729.png"/> , <img class="formulaInl" alt="$\Psi_{sat}$" src="form_611.png"/> , <img class="formulaInl" alt="$\theta_{min}$" src="form_741.png"/> , and <img class="formulaInl" alt="$\theta_{ret}$" src="form_742.png"/> are assigned values based on the peat texture (fibric, hemic or sapric). These values are obtained from the arrays in common block CLASS5 (see the CLASSBD documentation above). The current default is to assume the first soil layer as fibric, the second as hemic, and any lower layers as sapric. The volumetric heat capacity and thermal conductivity are set to textbook values for organic matter; the field capacity is set equal to the retention capacity; <img class="formulaInl" alt="$f_{inf}$" src="form_736.png"/> is obtained as above; and <img class="formulaInl" alt="$\Psi_{wilt}$" src="form_754.png"/> is assume to apply at a liquid water content of <img class="formulaInl" alt="$\theta_{min}$" src="form_741.png"/> .</p>
<p>In the cases of rock soils and ice sheets (respectively flagged with ISAND values of -3 and -4), all of the above variables are set to zero except for the volumetric heat capacity and the thermal conductivity, which are assigned values representative of rock or ice.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 3 2016 11:29:13 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
