<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: CHKWAT.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">CHKWAT.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Check for closure of surface water budget, and for unphysical values of certain variables.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae24f10ada6d260b942e1b64c3dc5a310"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CHKWAT_8f.html#ae24f10ada6d260b942e1b64c3dc5a310">chkwat</a> (ISFC, PCPR, EVAP, RUNOFF, WLOST, RAICAN, SNOCAN, RAICNI, SNOCNI, ZPOND, ZPONDI, THLIQ, THICE, THLIQI, THICEI, ZSNOW, RHOSNO, XSNOW, SNOWI, WSNOW, WSNOWI, FCS, FGS, FI, BAL, THPOR, THLMIN, DELZW, ISAND, IG, ILG, IL1, IL2, JL, N)</td></tr>
<tr class="separator:ae24f10ada6d260b942e1b64c3dc5a310"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Check for closure of surface water budget, and for unphysical values of certain variables. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ae24f10ada6d260b942e1b64c3dc5a310"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine chkwat </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ISFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>EVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RUNOFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WLOST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPONDI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THICEI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>XSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>SNOWI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WSNOWI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>BAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pcpr</td><td>Precipitation rate over modelled subarea <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">evap</td><td>Evapotranspiration rate over modelled subarea <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">runoff</td><td>Total runoff over modelled subarea [m]</td></tr>
    <tr><td class="paramname">wlost</td><td>Residual amount of water that cannot be supplied by surface stores <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">raican</td><td>Intercepted liquid water on canopy at end of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">snocan</td><td>Intercepted frozen water on canopy at end of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">raicni</td><td>Intercepted liquid water on canopy at beginning of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">snocni</td><td>Intercepted frozen water on canopy at beginning of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">zpond</td><td>Depth of ponded water on ground at end of time step [m]</td></tr>
    <tr><td class="paramname">zpondi</td><td>Depth of ponded water on ground at beginning of time step [m]</td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack [m]</td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow pack <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_1180.png"/></td></tr>
    <tr><td class="paramname">xsnow</td><td>Switch to indicate presence of snow cover [ ]</td></tr>
    <tr><td class="paramname">snowi</td><td>Snow pack mass at beginning of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack at end of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">wsnowi</td><td>Liquid water content of snow pack at beginning of time step <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">fcs</td><td>Fractional coverage of canopy over snow on modelled area [ ]</td></tr>
    <tr><td class="paramname">fgs</td><td>Fractional coverage of snow over bare ground on modelled area [ ]</td></tr>
    <tr><td class="paramname">fi</td><td>Fractional coverage of subarea in question on modelled area [ ]</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers at end of time step <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">thice</td><td>Volumetric frozen water content of soil layers at end of time step <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">thliqi</td><td>Volumetric frozen water content of soil layers at beginning of time step <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">thicei</td><td>Volumetric frozen water content of soil layers at beginning of time step <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable depth of soil layer [m] </td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine is called from CLASSW to perform water balance checks for each of the four subareas. The flag ISFC indicates which subarea is being addressed: ISFC=1 for vegetation over snow, ISFC=2 for snow over bare ground, ISFC=3 for vegetation over bare ground, and ISFC=4 for bare ground. If a problem is discovered, a flag is set to the index of the modelled area, and a call to XIT is performed with an error message. Checks for unphysical values of certain water balance variables are performed against an accuracy limit ACCLMT, currently set to <img class="formulaInl" alt="$1x10^{-3} kg m^{-2}$" src="form_1217.png"/> or <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>. The overall water balance of the subarea is checked against an accuracy limit BALLMT, currently set to <img class="formulaInl" alt="$1x10^{-1} kg m^{-2}$" src="form_1218.png"/>. (These values reflect expected roundoff errors associated with 32-bit computation.)</p>
<p>In loop 100, for canopy-covered subareas, the intercepted rain RAICAN and snow SNOCAN are checked to ensure that if they are negative, they are vanishingly small. A similar check is done for the runoff.</p>
<p>In the 150 loop, for all areas that are not continental ice sheets (ISAND=-4), the liquid water content in each soil layer is checked to ensure that it is not larger than the pore volume and that it is not smaller than the minimum liquid water content (except for rock layers). The ice content is similarly checked to ensure that the sum of it, converted to an equivalent liquid water content, plus the minimum water content, is not greater than the pore volume (except for rock layers). It is also checked to ensure that if it is negative, it is vanishingly small.</p>
<p>Finally, in loop 300, the overall water balance BAL is calculated and compared to BALLMT. BAL is evaluated as the residual of the precipitation, the evaporation, the runoff, the water loss term WLOST, the change in canopy intercepted liquid and frozen water (for vegetation-covered areas), the change in surface ponded water, the change in snow pack and snow liquid water content (for snow-covered areas), and the changes in the soil layer liquid and frozen water contents. If the absolute value of BAL is greater than BALLMT, a flag is set, all of the terms entering BAL are printed out, and a call to XIT is performed.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 4 2017 18:26:34 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
