<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: Hetresg</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Hetresg</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) Heterotrophic respiration Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="memitem:gaf35383e36392dff7ca33ff9022cb70c0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hetresg.html#gaf35383e36392dff7ca33ff9022cb70c0">heterotrophic_respiration::hetresg</a> (litrmass, soilcmas, delzw,thpor,il1,il2,tbar,psisat, b,thliq,zbotw,thiceg,frac,isnow,isand,</td></tr>
<tr class="separator:gaf35383e36392dff7ca33ff9022cb70c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Canadian Terrestrial Ecosystem Model (CTEM) Heterotrophic respiration Subroutine. </p>
<p>Heterotrophic Respiration Subroutine For Bare Fraction</p>
<p>Heterotrophic respiration, <img class="formulaInl" alt="$R_\mathrm{h}$" src="form_1043.png"/> ( <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_1044.png"/>), in CTEM is based on respiration from the litter (which includes contributions from the stem, leaf and root components), <img class="formulaInl" alt="$R_{h,D}$" src="form_1045.png"/>, and soil carbon, <img class="formulaInl" alt="$R_{h,H}$" src="form_1046.png"/>, pools, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{hetres_all} R_\mathrm{h}=R_{h,D}+R_{h,H}. \]" src="form_288.png"/>
</p>
<p>Heterotrophic respiration is regulated by soil temperature and moisture and is calculated on a daily time step. The original heterotrophic respiration scheme is described in <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a> while the modified parametrization used in CTEM v. 2.0 is detailed in <a class="el" href="citelist.html#CITEREF_Melton2014-xy">[37]</a> and is briefly described here. Respiration from the litter and soil carbon pools takes the following basic form </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_{\mathrm{h},i} = 2.64 \times 10^{-6}\,\varsigma_i C_i f_{15}(Q_{10}) f(\Psi)_i, \nonumber \\ i = \mathrm{D}, \mathrm{H}.\label{lithet} \]" src="form_1878.png"/>
</p>
<p>The soil carbon and litter respiration depends on the amount of carbon in these components ( <img class="formulaInl" alt="$C_\mathrm{H}$" src="form_942.png"/> and <img class="formulaInl" alt="$C_\mathrm{D}$" src="form_941.png"/>; <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_100.png"/>) and on a PFT-dependent respiration rate specified at <img class="formulaInl" alt="$15\,{C}$" src="form_290.png"/> ( <img class="formulaInl" alt="$\varsigma_\mathrm{H}$" src="form_1047.png"/> and <img class="formulaInl" alt="$\varsigma_\mathrm{D}$" src="form_1048.png"/>; <img class="formulaInl" alt="$kg\,C\,(kg\,C)^{-1}\,yr^{-1}$" src="form_270.png"/>; see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>). The constant <img class="formulaInl" alt="$2.64 \times 10^{-6}$" src="form_1049.png"/> converts units from <img class="formulaInl" alt="$kg\,C\,m^{-2}\,yr^{-1}$" src="form_276.png"/> to <img class="formulaInl" alt="$mol\,CO_2\,m^{-2}\,s^{-1}$" src="form_1044.png"/>.</p>
<p>The effect of soil moisture is accounted for via dependence on soil matric potential ( <img class="formulaInl" alt="$f(\Psi)$" src="form_1050.png"/>), described later. The temperature dependency of microbial soil respiration rates has been estimated by several different formulations, ranging from simple <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> (exponential) to Arrhenius-type formulations (see review by <a class="el" href="citelist.html#CITEREF_Lloyd1994-ct">[34]</a>). In CTEM, soil temperature influences heterotrophic respiration through a temperature-dependent <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> function ( <img class="formulaInl" alt="$f_{15}(Q_{10})$" src="form_1052.png"/>). The value of <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> itself is assumed to be a function of temperature following a hyperbolic tan function: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q_{10} = 1.44 + 0.56\,\tanh[0.075 (46.0 - T_i)], \nonumber\\ i = \mathrm{D}, \mathrm{H}\label{hyper}, \]" src="form_660.png"/>
</p>
<p> where <img class="formulaInl" alt="$T_{\{D,H\}}$" src="form_1053.png"/> is the temperature of either the litter or soil carbon pool ( <img class="formulaInl" alt="$C$" src="form_27.png"/>), respectively. The parametrization is a compromise between the temperature-independent <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> commonly found in many terrestrial ecosystem models <a class="el" href="citelist.html#CITEREF_Cox2001-am">[18]</a> and the temperature-dependent <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> of <a class="el" href="citelist.html#CITEREF_Kirschbaum1995-db">[26]</a>. While a constant <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> yields an indefinitely increasing respiration rate with increasing temperature, the formulation of <a class="el" href="citelist.html#CITEREF_Kirschbaum1995-db">[26]</a> gives a continuously increasing <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> under decreasing temperature, which leads to unreasonably high soil and litter carbon pools at high latitudes in CTEM. The CTEM parametrization avoids these issues with a $Q_{10}$ value of about 2.0 for temperatures less than <img class="formulaInl" alt="$20\,C$" src="form_297.png"/>, while a decreasing value of <img class="formulaInl" alt="$Q_{10}$" src="form_1051.png"/> at temperatures above <img class="formulaInl" alt="$20\,C$" src="form_297.png"/> ensures that the respiration rate does not increase indefinitely.</p>
<p>The temperature of the litter pool is a weighted average of the temperature of the top soil layer ( <img class="formulaInl" alt="$T_1$" src="form_1054.png"/>) and the root temperature ( <img class="formulaInl" alt="$T_\mathrm{R}$" src="form_1055.png"/>) as litter consists of leaf, stem, and root litter ( <img class="formulaInl" alt="$T_\mathrm{D} = 0.7 T_1 + 0.3T_\mathrm{R}$" src="form_1056.png"/>). The temperature of the soil carbon pool is calculated as the mean soil temperature in the rooting zone based upon the fraction of roots in each soil layer and their temperature. The carbon in each soil layer is not explicitly tracked but assumed to adopt an exponential distribution <a class="el" href="citelist.html#CITEREF_Jobbagy2000-pa">[25]</a>.</p>
<p>The response of heterotrophic respiration to soil moisture is formulated through soil matric potential ( <img class="formulaInl" alt="$\Psi$" src="form_4.png"/>; <img class="formulaInl" alt="$MPa$" src="form_302.png"/>). While soil matric potential values are usually negative, the formulation uses absolute values to allow its logarithm to be taken. Absolute values of soil matric potential are high when soil is dry and low when it is wet. The primary premise of soil moisture control on heterotrophic respiration is that heterotrophic respiration is constrained both when the soils are dry (due to reduced microbial activity) and when they are wet (due to impeded oxygen supply to microbes) with optimum conditions in-between. The exception is the respiration from the litter component, which is assumed to be continually exposed to air, and thus never oxygen deprived, even when soil moisture content is high ( <img class="formulaInl" alt="$0.04 > \vert \Psi \vert \geq \vert \Psi_{sat} \vert$" src="form_1057.png"/>, where <img class="formulaInl" alt="$\Psi_{sat}$" src="form_611.png"/> is the soil matric potential at saturation). The soil moisture dependence thus varies between 0 and 1 with matric potential as follows:</p>
<p>for <img class="formulaInl" alt="$0.04 > \vert\Psi\vert \geq \vert\Psi_{sat}\vert$" src="form_1058.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi)_\mathrm{H} = 1 - 0.5 \frac{\log(0.04)-\log\vert\Psi\vert} {\log(0.04)-\log\vert\Psi_{sat}\vert}\\ f(\Psi)_D = 1\nonumber; \]" src="form_1879.png"/>
</p>
<p> for <img class="formulaInl" alt="$0.06 \geq \vert\Psi\vert \geq 0.04$" src="form_1059.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi)_\{D,H\} = 1; \]" src="form_308.png"/>
</p>
<p> for <img class="formulaInl" alt="$100.0 \geq \vert\Psi\vert > 0.06$" src="form_1060.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(\Psi)_\{D,H\} = 1 - 0.8\frac{\log\vert\Psi\vert-\log(0.06)}{\log(100)-\log(0.06)}; \]" src="form_310.png"/>
</p>
<p> for <img class="formulaInl" alt="$\vert\Psi\vert > 100.0$" src="form_1061.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{lastpsi} f(\Psi)_\{D,H\}=0.2. \]" src="form_312.png"/>
</p>
<p>Heterotrophic respiration for bare ground is treated separately in CTEM. The carbon contributions to the bare ground litter and soil carbon pools come via processes such as creation of bare ground due to fire, competition between PFTs and land use change. The heterotrophic respiration is sensitive to temperature and moisture in the same manner as vegetated areas using Eqs. (lithet})&ndash;(lastpsi}). The base respiration rates of <img class="formulaInl" alt="$\varsigma_{D,bare}$" src="form_1062.png"/> and <img class="formulaInl" alt="$\varsigma_{H,bare}$" src="form_1063.png"/> are set to <img class="formulaInl" alt="$0.5605$" src="form_315.png"/> and <img class="formulaInl" alt="$0.02258\,kg\,C\,(kg\,C)^{-1}\,yr^{-1}$" src="form_316.png"/>, respectively.</p>
<p>The amount of humidified litter, which is transferred from the litter to the soil carbon pool ( <img class="formulaInl" alt="$C_{\mathrm{D} \rightarrow \mathrm{H}}$" src="form_1064.png"/>) is modelled as a fraction of litter respiration ( <img class="formulaInl" alt="$R_{h,D}$" src="form_1045.png"/>) as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{cdtoh} C_{\mathrm{D} \rightarrow \mathrm{H}} = \chi\,R_{h,D} \]" src="form_318.png"/>
</p>
<p> where <img class="formulaInl" alt="$\chi$" src="form_1.png"/> (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) is the PFT-dependent humification factor and varies between 0.4 and 0.5. For crops, <img class="formulaInl" alt="$\chi$" src="form_1.png"/> is set to 0.1 to account for reduced transfer of humidified litter to the soil carbon pool which leads to loss in soil carbon when natural vegetation is converted to croplands. Over the bare ground fraction <img class="formulaInl" alt="$\chi$" src="form_1.png"/> is set to 0.45.</p>
<p>With heterotrophic respiration known, net ecosystem productivity ( <img class="formulaInl" alt="$NEP$" src="form_320.png"/>) is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ NEP = G_{canopy} - R_\mathrm{m} - R_\mathrm{g} - R_\mathrm{h}. \]" src="form_321.png"/>
</p>
 <h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="gaf35383e36392dff7ca33ff9022cb70c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public heterotrophic_respiration::hetresg </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc+1)&#160;</td>
          <td class="paramname"><em>litrmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc+1)&#160;</td>
          <td class="paramname"><em>soilcmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>delzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thpor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>tbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>psisat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>zbotw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thiceg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>isnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>isand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramname">isnow</td><td>integer telling if bare fraction is fg (0) or fgs (1), isnow is changed to isnow(ilg) in classt of class version higher than 3.4 for coupling with ctem</td></tr>
    <tr><td class="paramname">litrmass</td><td>litter mass for the 8 pfts + bare in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">soilcmas</td><td>soil carbon mass for the 8 pfts + bare in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">tbar</td><td>soil temperature, k</td></tr>
    <tr><td class="paramname">thliq</td><td>liquid soil moisture content in 3 soil layers</td></tr>
    <tr><td class="paramname">zbotw</td><td>bottom of soil layers</td></tr>
    <tr><td class="paramname">frac</td><td>fraction of ground (fg) or snow over ground (fgs)</td></tr>
    <tr><td class="paramname">psisat</td><td>saturation matric potential</td></tr>
    <tr><td class="paramname">b</td><td>parameter b of clapp and hornberger</td></tr>
    <tr><td class="paramname">thpor</td><td>porosity </td></tr>
  </table>
  </dd>
</dl>
<p>Estimate temperature of the litter and soil carbon pools.</p>
<p>We estimate the temperature of the soil c pool assuming that soil carbon over the bare fraction is distributed exponentially. note that bare fraction may contain dead roots from different pfts all of which may be distributed differently. For simplicity we do not track each pft's dead root biomass and assume that distribution of soil carbon over the bare fraction can be described by a single parameter.</p>
<p>find moisture scalar for soil c decomposition</p>
<p>find moisture scalar for litter decomposition </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 30 2017 10:33:39 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
