<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: mortality.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mortality.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) Mortality Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a11a826efba70183880f4f963e93c4247"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mortality_8f.html#a11a826efba70183880f4f963e93c4247">mortalty</a> (stemmass, rootmass,ailcg, gleafmas,bleafmas,il1,il2, leapnow,iday, sort,fcancmx,</td></tr>
<tr class="separator:a11a826efba70183880f4f963e93c4247"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Canadian Terrestrial Ecosystem Model (CTEM) Mortality Subroutine. </p>
<p>Mortality</p>
<p>The PFT-dependent mortality rate ( <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>),</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{mortality} m_{\alpha} = m_{intr,\alpha} + m_{ge,\alpha} + m_{bioclim,\alpha} + m_{dist,\alpha}, \]" src="form_113.png"/>
</p>
<p> reflects the net effect of four different processes: (1) intrinsic- or age-related mortality, <img class="formulaInl" alt="$m_{intr}$" src="form_1084.png"/>, (2) growth or stress-related mortality, <img class="formulaInl" alt="$m_{ge}$" src="form_1085.png"/>, (3) mortality associated with bioclimatic criteria, <img class="formulaInl" alt="$m_{bioclim}$" src="form_943.png"/> and (4) mortality associated with disturbances, <img class="formulaInl" alt="$m_{dist}$" src="form_937.png"/>.</p>
<p>Intrinsic- or age-related mortality uses a PFT-specific maximum age, <img class="formulaInl" alt="$A_{max}$" src="form_1086.png"/> (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>), to calculate an annual mortality rate such that only <img class="formulaInl" alt="$1\,{\%}$" src="form_1453.png"/> of tree PFTs exceed <img class="formulaInl" alt="$A_{max},\alpha$" src="form_1087.png"/>. Intrinsic mortality accounts for processes, whose effect is not explicitly captured in the model including insect damage, hail, wind throw, etc.,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{intrmort} m_{intr,\alpha} = 1 - \exp(-4.605/A_{max,\alpha}). \]" src="form_120.png"/>
</p>
<p>Grasses and crops have <img class="formulaInl" alt="$m_{intr} = 0$" src="form_1088.png"/>. The annual growth-related mortality <img class="formulaInl" alt="$m_{ge}$" src="form_1085.png"/> is calculated using growth efficiency of a PFT over the course of the previous year following <a class="el" href="citelist.html#CITEREF_Prentice1993-xn">[14]</a> and <a class="el" href="citelist.html#CITEREF_Sitch2003-847">[52]</a> as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{mgrow} m_{ge,\alpha} = \frac{m_{{ge},max,\alpha}}{1 + k_{m} g_{\mathrm{e},\alpha}}, \]" src="form_122.png"/>
</p>
<p>where <img class="formulaInl" alt="$m_{{ge},max}$" src="form_1089.png"/> represents the PFT-specific maximum mortality rate when no growth occurs (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>). <img class="formulaInl" alt="$k_{m}$" src="form_1090.png"/> is a parameter set to <img class="formulaInl" alt="$0.3\,m^{2}\,(g\,C)^{-1}$" src="form_125.png"/>. <img class="formulaInl" alt="$g_\mathrm{e}$" src="form_1091.png"/> is the growth efficiency of the PFT ( <img class="formulaInl" alt="$g\,C\,m^{-2}$" src="form_127.png"/>) calculated based on the maximum LAI ( <img class="formulaInl" alt="$L_{\alpha,max}$" src="form_1092.png"/>; <img class="formulaInl" alt="$m^{2}\,m^{-2}$" src="form_129.png"/>) and the increment in stem and root mass over the course of the previous year ( <img class="formulaInl" alt="$\Delta C_\mathrm{S}$" src="form_1093.png"/> and <img class="formulaInl" alt="$\Delta C_\mathrm{R}$" src="form_1094.png"/>; <img class="formulaInl" alt="$kg\,C\,m^{-2}$" src="form_100.png"/>, respectively) <a class="el" href="citelist.html#CITEREF_Waring1983-wc">[59]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\mathrm{e},\alpha} = 1000\frac{\max(0,(\Delta C_{\mathrm{S},\alpha}+\Delta C_{\mathrm{R},\alpha}))}{L_{\alpha,max}}. \]" src="form_132.png"/>
</p>
<p>Mortality associated with bioclimatic criteria, <img class="formulaInl" alt="$m_{bioclim}$" src="form_943.png"/> ( <img class="formulaInl" alt="$0.25\,yr^{-1}$" src="form_133.png"/>), is applied when climatic conditions in a grid cell become unfavourable for a PFT to exist and ensures that PFTs do not exist outside their bioclimatic envelopes, as explained in the next section.</p>
<p>The annual mortality rates for <img class="formulaInl" alt="$m_{intr}$" src="form_1084.png"/>, <img class="formulaInl" alt="$m_{ge}$" src="form_1085.png"/> and <img class="formulaInl" alt="$m_{bioclim}$" src="form_943.png"/> are converted to daily rates and applied at the daily time step of the model, while <img class="formulaInl" alt="$m_{dist}$" src="form_937.png"/> is calculated by the fire module of the model based on daily area burned for each PFT as summarized in Appendix fire}. In practice, the <img class="formulaInl" alt="$\frac{\mathrm{d}f_\alpha}{\mathrm{d}t}=-m_{dist,\alpha}f_\alpha$" src="form_1848.png"/> term of Eq. (compact}) is implemented right after area burnt is calculated. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a11a826efba70183880f4f963e93c4247"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mortalty </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>ailcg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramname">iday</td><td>day of the year</td></tr>
    <tr><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramname">sort</td><td>index for correspondence between ctem 9 pfts and size 12 of parameters vectors</td></tr>
    <tr><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">gleafmas</td><td>green leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">ailcg</td><td>green or live lai</td></tr>
    <tr><td class="paramname">bleafmas</td><td>brown leaf mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/> </td></tr>
  </table>
  </dd>
</dl>
<hr/>
 <h2>Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a> </h2>
<p>initialize required arrays to zero</p>
<p>initialization ends </p><hr/>
<p>at the end of every year, i.e. when iday equals 365, we calculate growth related mortality. rather than using this number to kill plants at the end of every year, this mortality rate is applied gradually over the next year.</p>
<p>calculate growth related mortality using last year's growth efficiency or the new growth efficiency if day is 365 and growth efficiency estimate has been updated above.</p>
<p>convert (1/year) rate into (1/day) rate</p>
<p>calculate intrinsic mortality rate due to aging which implicity includes effects of frost, hail, wind throw etc. it is assumed that only 1% of the plants exceed maximum age (which is a pft-dependent parameter). to achieve this some fraction of the plants need to be killed every year.</p>
<p>convert (1/year) rate into (1/day) rate</p>
<p>now that we have both growth related and intrinsic mortality rates, lets combine these rates for every pft and estimate litter generated</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mortality_8f_a11a826efba70183880f4f963e93c4247_icgraph.png" border="0" usemap="#mortality_8f_a11a826efba70183880f4f963e93c4247_icgraph" alt=""/></div>
<map name="mortality_8f_a11a826efba70183880f4f963e93c4247_icgraph" id="mortality_8f_a11a826efba70183880f4f963e93c4247_icgraph">
<area shape="rect" id="node2" href="ctem_8f90.html#ace1598599f37c24cac37dd963f23b497" title="ctem" alt="" coords="123,5,173,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 25 2017 14:33:40 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
