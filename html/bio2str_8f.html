<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: bio2str.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">bio2str.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) Biomass To Structural Attributes Conversion Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3bc457fd89cd3f3af038e068b38b5919"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bio2str_8f.html#a3bc457fd89cd3f3af038e068b38b5919">bio2str</a> (gleafmas, bleafmas, stemmass, rootmass,il1,il2,fcancmx,zbotw,delzw, nol2pfts,soildpth,</td></tr>
<tr class="separator:a3bc457fd89cd3f3af038e068b38b5919"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Canadian Terrestrial Ecosystem Model (CTEM) Biomass To Structural Attributes Conversion Subroutine. </p>
<p>The time-varying biomass in the leaves ( <img class="formulaInl" alt="$C_\mathrm{L}$" src="form_938.png"/>), stem ( <img class="formulaInl" alt="$C_\mathrm{S}$" src="form_939.png"/>) and root ( <img class="formulaInl" alt="$C_\mathrm{R}$" src="form_940.png"/>) components is used to calculate the structural attributes of vegetation for the energy and water balance calculations by CLASS.</p>
<p>Leaf biomass is converted to LAI using specific leaf area ( <img class="formulaInl" alt="${SLA}$" src="form_388.png"/>, <img class="formulaInl" alt="$m^2\,(kg\,C)^{-1}$" src="form_389.png"/>), which itself is assumed to be a function of leaf lifespan ( <img class="formulaInl" alt="$\tau_\mathrm{L}$" src="form_1022.png"/>; see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>)</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{sla} SLA= \gamma_\mathrm{L}\tau_\mathrm{L}^{-0.5}\\ LAI = C_\mathrm{L}SLA\nonumber \]" src="form_390.png"/>
</p>
<p>where <img class="formulaInl" alt="$\gamma_\mathrm{L}$" src="form_1023.png"/> is a constant with value equal to <img class="formulaInl" alt="$25\,m^2\,(kg\,C)^{-1}\,yr^{0.5}$" src="form_392.png"/>.</p>
<p>The vegetation height ( <img class="formulaInl" alt="$H$" src="form_1024.png"/>; <img class="formulaInl" alt="$m$" src="form_20.png"/>) is calculated for tree, crop and grass PFTs as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[\label{height} H = \begin{cases} \min\left(10.0C_\mathrm{S}^{0.385},45\right) trees\\ (C_\mathrm{S} + C_\mathrm{L})^{0.385} crops\\ 3.5 (C_{L,g} + 0.55\,C_{L,b})^{0.5} grasses,\\ \end{cases} \]" src="form_394.png"/>
</p>
<p> where <img class="formulaInl" alt="$C_{L,g}$" src="form_1025.png"/> is the green leaf biomass and <img class="formulaInl" alt="$C_{L,b}$" src="form_1026.png"/> is the brown leaf biomass that is scaled by 0.55 to reduce its contribution to the plant height. CTEM explicitly tracks brown leaf mass for grass PFTs. The turnover of green grass leaves, due to normal aging or stress from drought and/or cold, does not contribute to litter pool directly as the leaves first turn brown. The brown leaves themselves turnover to litter relatively rapidly <img class="formulaInl" alt="$(\tau_{L,b} = 0.1\,\tau_\mathrm{L}$" src="form_1027.png"/>).</p>
<p>CTEM dynamically simulates root distribution and depth in soil following <a class="el" href="citelist.html#CITEREF_Arora2003838">[3]</a>. The root distribution takes an exponential form and roots grow and deepen with increasing root biomass. The cumulative root fraction at depth <img class="formulaInl" alt="$z$" src="form_1028.png"/> is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{fracroo} f_\mathrm{R}(z) = 1 - \exp(-\iota z). \]" src="form_399.png"/>
</p>
<p>Rooting depth ( <img class="formulaInl" alt="$d_\mathrm{R}$" src="form_1029.png"/>; <img class="formulaInl" alt="$m$" src="form_20.png"/>), which is defined to be the depth containing <img class="formulaInl" alt="$99\,{\%}$" src="form_401.png"/> of the root mass, is found by setting <img class="formulaInl" alt="$z$" src="form_1028.png"/> equal to <img class="formulaInl" alt="$d_\mathrm{R}$" src="form_1029.png"/> and <img class="formulaInl" alt="$f_\mathrm{R} = 0.99$" src="form_1030.png"/>, which yields </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{rootterm1} d_\mathrm{R} = \frac{-\ln(1-f_\mathrm{R})}{\iota} = \frac{-\ln(1 - 0.99)}{\iota} = \frac{4.605}{\iota}. \]" src="form_403.png"/>
</p>
<p>The parameter <img class="formulaInl" alt="$\iota$" src="form_1031.png"/> that describes the exponential root distribution is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{iota} \iota = \overline{\iota} \left(\frac{\overline{C_\mathrm{R}}}{C_\mathrm{R}} \right)^{0.8}, \]" src="form_405.png"/>
</p>
<p>where <img class="formulaInl" alt="$\overline{\iota}$" src="form_1032.png"/> represents the PFT-specific mean root distribution profile parameter and <img class="formulaInl" alt="$\overline{C_\mathrm{R}}$" src="form_1033.png"/> the average root biomass derived from <a class="el" href="citelist.html#CITEREF_Jackson1996-va">[24]</a> (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>). Equation (iota}) yields a lower (higher) value of <img class="formulaInl" alt="$\iota$" src="form_1031.png"/> than <img class="formulaInl" alt="$\overline{\iota}$" src="form_1032.png"/> when root biomass <img class="formulaInl" alt="$C_\mathrm{R}$" src="form_940.png"/> is higher (lower) than the PFT-specific mean root biomass <img class="formulaInl" alt="$\overline{C_\mathrm{R}}$" src="form_1033.png"/>, resulting in a deeper (shallower) root profile than the mean root profile.</p>
<p>The rooting depth <img class="formulaInl" alt="$d_\mathrm{R}$" src="form_1029.png"/> is checked to ensure it does not exceed the soil depth. If so, <img class="formulaInl" alt="$d_\mathrm{R}$" src="form_1029.png"/> is set to the soil depth and <img class="formulaInl" alt="$\iota$" src="form_1031.png"/> is recalculated as <img class="formulaInl" alt="$\iota = 4.605/d_\mathrm{R}$" src="form_1034.png"/> (see Eq. rootterm1} for derivation of 4.605 term). The new value of <img class="formulaInl" alt="$\iota$" src="form_1031.png"/> is used to determine the root distribution profile adjusted to the shallower depth. Finally, the root distribution profile is used to calculate fraction of roots in each of the model's soil layers. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a3bc457fd89cd3f3af038e068b38b5919"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bio2str </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>zbotw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>delzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>soildpth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>input: il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>input: il2=ilg</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>input: number of level 2 pfts</td></tr>
    <tr><td class="paramname">gleafmas</td><td>input: green or live leaf mass in kg c/m2, for the 9 pfts</td></tr>
    <tr><td class="paramname">bleafmas</td><td>input: brown or dead leaf mass in kg c/m2, for the 9 pfts</td></tr>
    <tr><td class="paramname">stemmass</td><td>input: stem biomass in kg c/m2, for the 9 pfts</td></tr>
    <tr><td class="paramname">rootmass</td><td>input: root biomass in kg c/m2, for the 9 pfts</td></tr>
    <tr><td class="paramname">fcancmx</td><td>input: max. fractional coverages of ctem's 9 pfts. this is different from fcanc and fcancs (which may vary with snow depth). fcancmx doesn't change, unless of course its changed by land use change or dynamic vegetation.</td></tr>
    <tr><td class="paramname">delzw</td><td>input: thicknesses of the 3 soil layers</td></tr>
    <tr><td class="paramname">zbotw</td><td>input: bottom of soil layers</td></tr>
    <tr><td class="paramname">soildpth</td><td>input: soil depth (m) </td></tr>
  </table>
  </dd>
</dl>
<p>Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a></p>
<p>class' original root parameterization has deeper roots than ctem's default values based on literature. in the coupled model this leads to lower evapotranspiration (et) values. an option is provided here to deepen roots, but this will also increase photosynthesis and vegetation biomass slightly, due to more access to soil water. so while use of deeper roots is desirable in the coupled global model, one may decide to use ctem's default parameterizarion for stand alone simulations, and set deeproots to .false.</p>
<p>&mdash;&mdash; 1. conversion of leaf biomass into leaf area index -&mdash;&mdash;</p>
<p>find specific leaf area (sla, m2/kg) using leaf life span</p>
<p>convert leaf biomass into lai. brown leaves could have less lai than the green leaves for the same leaf mass. for now we assume sla of brown leaves is fracbofg times that of green leaves.</p>
<p>also find stem area index as a function of stem biomass</p>
<p>plant area index is sum of green and brown leaf area indices and stem area index</p>
<p>make class see some minimum pai, otherwise it runs into numerical problems</p>
<p>get fcancmx weighted leaf area index for use by class needle leaf evg + dcd = total needle leaf broad leaf evg + dcd cld + dcd dry = total broad leaf crop c3 + c4 = total crop grass c3 + c4 = total grass also add brown lai. note that although green + brown lai is to be used by class for energy and water balance calculations, stomatal conductance estimated by the photosynthesis subroutine is only based on green lai. that is although both green+brown leaves intercept water and light, only the green portion photosynthesizes. also lump stem and plant area indices for class' 4 pfts</p>
<p>for crops and grasses set the minimum lai to a small number, other wise class will never run tsolvc and thus phtsyn and ctem will not be able to grow crops or grasses.</p>
<p>&mdash;&mdash; 2. conversion of stem biomass into roughness length -&mdash;&mdash;</p>
<p>class uses log of roughness length (zoln) as an input parameter. when vegetation grows and dies as per ctem, then zoln is provided by ctem.</p>
<ol type="1">
<li>convert stem biomass into vegetation height for trees and crops, and convert leaf biomass into vegetation height for grass</li>
<li>convert vegetation height into roughness length &amp; take its log</li>
<li>lump this for ctem's 9 pfts into class' 4 pfts</li>
</ol>
<p>&mdash;&mdash; 3. estimating fraction of roots in each soil layer for &ndash;&mdash; &mdash;&mdash; ctem's each vegetation type, using root biomass &ndash;&mdash;</p>
<p>estimate parameter b of variable root profile parameterization</p>
<p>use b to estimate 99% rooting depth</p>
<p>if estimated rooting depth is greater than soil depth, or the maximum rooting depth then adjust rooting depth and parameter alpha</p>
<p>also find "a" (parameter determining root profile). this is the "a" which depends on time varying root biomass</p>
<p>using parameter "a" we can find fraction of roots in each soil layer just like class</p>
<p>if rootdepth is shallower than the bottom of current layer and is deeper than bottom of the previous top layer</p>
<p>if rootdepth is shallower than the bottom of 2nd layer</p>
<p>if rootdepth is shallower than the bottom of 3rd layer or even the deeper layer (ignd&gt;3)</p>
<p>make sure all fractions (of roots in each layer) add to one.</p>
<p>lump rmatctem(i,9,ignd) into rmatc(i,4,ignd) for use by class</p>
<p>-&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; 4. calculate storage lai --&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>
<p>need a minimum slai to be able to grow from scratch. consider this as model seeds.</p>
<p>&mdash; 5. calculate total vegetation biomass for each ctem pft, and &ndash; ----&mdash;&mdash;&mdash;&mdash; canopy mass for each class pft ------&mdash;&mdash;&mdash;&mdash;</p>
<p>since class uses canopy mass and not total vegetation biomass as an input, we find canopy mass as a sum of stem and leaf mass, for each class pft, i.e. only above ground biomass.</p>
<p>if there is no vegetation canopy mass will be abszero. this should essentially mean more bare ground, but since we are not changing fractional coverages at present, we pass a minimum canopy mass to class so that it doesn't run into numerical problems.</p>
<p>&mdash; 6. calculate albedo for class' 4 pfts based on specified -&mdash; ---&mdash; albedos of ctem 9 pfts and their fractional coveraes --&mdash;</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 29 2016 15:12:15 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
