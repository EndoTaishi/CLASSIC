<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM Documentation: GRINFL.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">GRINFL.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Quantify movement of liquid water between soil layers under conditions of infiltration.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aac6f2d3fad2a7b2c287fb2b821ba61f4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GRINFL_8f.html#aac6f2d3fad2a7b2c287fb2b821ba61f4">grinfl</a> (IVEG, THLIQ, THICE, TBARW, BASFLW, TBASFL, RUNOFF, TRUNOF, ZFAV, LZFAV, THLINV, QFG, WLOST, FI, EVAP, R, TR, TPOND, ZPOND, DT, ZMAT, WMOVE, TMOVE, THLIQX, THICEX, TBARWX, DELZX, ZBOTX, FDT, TFDT, PSIF, THLINF, GRKINF, THLMAX, THTEST, ZRMDR, FDUMMY, TDUMMY, THLDUM, THIDUM, TDUMW, TRMDR, ZF, FMAX, TUSED, RDUMMY, ZERO, WEXCES, FDTBND, WADD, TADD, WADJ, TIMPND, DZF, DTFLOW, THLNLZ, THLQLZ, DZDISP, WDISP, WABS, THPOR, THLRET, THLMIN, BI, PSISAT, GRKSAT, THLRAT, THFC, DELZW, ZBOTW, XDRAIN, DELZ, ISAND, IGRN, IGRD, IFILL, IZERO, LZF, NINF, IFIND, ITER, NEND, ISIMP, IGDR, IG, IGP1, IGP2, ILG, IL1, IL2, JL, N)</td></tr>
<tr class="separator:aac6f2d3fad2a7b2c287fb2b821ba61f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Quantify movement of liquid water between soil layers under conditions of infiltration. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="aac6f2d3fad2a7b2c287fb2b821ba61f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine grinfl </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IVEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBARW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>BASFLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TBASFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RUNOFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRUNOF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ZFAV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>LZFAV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>THLINV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WLOST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>EVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension     (ilg)&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZPOND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,igp2,igp1)&#160;</td>
          <td class="paramname"><em>ZMAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,igp2)&#160;</td>
          <td class="paramname"><em>WMOVE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,igp2)&#160;</td>
          <td class="paramname"><em>TMOVE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>THLIQX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>THICEX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>TBARWX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,igp1)&#160;</td>
          <td class="paramname"><em>DELZX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,igp1)&#160;</td>
          <td class="paramname"><em>ZBOTX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,igp1)&#160;</td>
          <td class="paramname"><em>FDT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,igp1)&#160;</td>
          <td class="paramname"><em>TFDT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,igp1)&#160;</td>
          <td class="paramname"><em>PSIF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>THLINF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>GRKINF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THTEST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,igp1)&#160;</td>
          <td class="paramname"><em>ZRMDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>FDUMMY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,igp1)&#160;</td>
          <td class="paramname"><em>TDUMMY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLDUM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THIDUM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>TDUMW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TRMDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>ZF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TUSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RDUMMY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ZERO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>WEXCES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FDTBND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WADD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TADD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WADJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TIMPND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>DZF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>DTFLOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>THLNLZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>THLQLZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>DZDISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WDISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WABS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>GRKSAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLRAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>XDRAIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>IGRN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>IGRD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>IFILL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>IZERO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>LZF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>NINF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>IFIND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ITER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>NEND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ISIMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>IGDR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IGP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IGP2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iveg</td><td>Subarea type flag</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layer <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_l)$" src="form_777.png"/></td></tr>
    <tr><td class="paramname">thice</td><td>Volumetric frozen water content of soil layer <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_i)$" src="form_778.png"/></td></tr>
    <tr><td class="paramname">tbarw</td><td>Temperature of water in soil layer [C]</td></tr>
    <tr><td class="paramname">basflw</td><td>Base flow from bottom of soil column [m]</td></tr>
    <tr><td class="paramname">tbasfl</td><td>Temperature of base flow from bottom of soil column [K]</td></tr>
    <tr><td class="paramname">runoff</td><td>Total runoff from soil column [m]</td></tr>
    <tr><td class="paramname">trunof</td><td>Temperature of total runoff from soil column [K]</td></tr>
    <tr><td class="paramname">qfg</td><td>Evaporation from soil surface (diagnostic) <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">wlost</td><td>Residual amount of water that cannot be supplied by surface stores <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">zfav</td><td>Average depth of wetting front over current time step [m]</td></tr>
    <tr><td class="paramname">thlinv</td><td>Liquid water content behind the wetting front <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">lzfav</td><td>Soil layer index in which the average position of the wetting front occurs</td></tr>
    <tr><td class="paramname">fi</td><td>Fractional coverage of subarea in question on modelled area [ ]</td></tr>
    <tr><td class="paramname">evap</td><td>Evaporation rate from ground surface <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">r</td><td>Rainfall rate at ground surface <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">tr</td><td>Temperature of rainfall [C]</td></tr>
    <tr><td class="paramname">tpond</td><td>Temperature of ponded water [C]</td></tr>
    <tr><td class="paramname">zpond</td><td>Depth of ponded water on soil surface [m]</td></tr>
    <tr><td class="paramname">dt</td><td>Time period over which water movement takes place [s]</td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_p)$" src="form_783.png"/></td></tr>
    <tr><td class="paramname">thlret</td><td>Liquid water retention capacity for organic soil <img class="formulaInl" alt="$[m^3 m^{-3}] (\theta_{l,ret})$" src="form_1413.png"/></td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation <img class="formulaInl" alt="$[m^3 m^{-3}] (theta_{l,min})$" src="form_1414.png"/></td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical "b" parameter [ ] (b)</td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation <img class="formulaInl" alt="$[m] (\Psi_{sat})$" src="form_1415.png"/></td></tr>
    <tr><td class="paramname">grksat</td><td>Hydraulic conductivity of soil at saturation <img class="formulaInl" alt="$[m s^{-1}] (K_{sat})$" src="form_787.png"/></td></tr>
    <tr><td class="paramname">thlrat</td><td>Fractional saturation of soil behind the wetting front <img class="formulaInl" alt="$[ ] (f_{inf})$" src="form_1416.png"/></td></tr>
    <tr><td class="paramname">thfc</td><td>Field capacity <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable depth of soil layer <img class="formulaInl" alt="$[m] (\Delta z_{g,w})$" src="form_1212.png"/></td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth to permeable bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">xdrain</td><td>Drainage index for water flow at bottom of soil profile [ ]</td></tr>
    <tr><td class="paramname">delz</td><td>Overall thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">igrn</td><td>Flag to indicate whether calculations in this subroutine are to be done</td></tr>
    <tr><td class="paramname">igrd</td><td>Flag to indicate whether calculations in subroutine GRDRAN are to be done</td></tr>
    <tr><td class="paramname">igdr</td><td>Index of soil layer in which bedrock is encountered </td></tr>
  </table>
  </dd>
</dl>
<p>In loop 50, the flag IGRN is first set to 1 for all grid cells where the calculations in this subroutine are to be performed. The necessary conditions are: that the surface being modelled is not a glacier or ice sheet (ISAND &gt; -4); that the time period DT is greater than zero; and that either the rainfall rate is greater than zero or that ponded water exists on the surface. If any of these conditions is not met, IGRN is set to zero.</p>
<p>In loop 100, a series of local arrays THLIQX, THICEX, TBARWX, DELZX and ZBOTX are defined for use in the subsequent infiltration calculations, with a “y” dimension of IG+1, where IG is the number of soil layers. The entries from 1 to IG are set equal to the corresponding values in THLIQ, THICE, TBARW, DELZW and ZBOTW. An effective saturated hydraulic conductivity GRKSATF is calculated for each soil layer, applying an empirical correction for the presence of ice. This ice content factor, <img class="formulaInl" alt="$f_{ice}$" src="form_1417.png"/>, is calculated from Zhao and Gray (1997) as:</p>
<p><img class="formulaInl" alt="$f_{ice} = [1.0 – min(1.0, \theta_i / \theta_p )]^2$" src="form_1418.png"/></p>
<p>To further account for the presence of ice, a modified pore volume THPORF for the soil layer is calculated as the maximum of the available pore volume <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> – <img class="formulaInl" alt="$\theta_i$" src="form_1419.png"/> (where <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> is the total pore volume and <img class="formulaInl" alt="$\theta_i$" src="form_1419.png"/> is the ice content of the layer), the actual liquid water content <img class="formulaInl" alt="$\theta_l$" src="form_738.png"/>, and the minimum residual liquid water content <img class="formulaInl" alt="$\theta_{l,min}$" src="form_801.png"/>. (The last two conditions are required because in the case of a saturated soil undergoing freezing, since water expands when frozen, the sum of the liquid and frozen volumetric water contents may be greater than the pore volume, and thus <img class="formulaInl" alt="$\theta_l$" src="form_738.png"/> or <img class="formulaInl" alt="$\theta_{l,min}$" src="form_801.png"/> may be greater than <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> – <img class="formulaInl" alt="$\theta_i$" src="form_1419.png"/>.) Finally, the water content THLINF and the hydraulic conductivity GRKINF behind the wetting front are evaluated, following the analysis of Green and Ampt (1911) and treating the change in soil moisture due to infiltration as a downward-propagating square wave. THLINF is calculated as the maximum of <img class="formulaInl" alt="$f_{inf} ( \theta_p – \theta_i)$" src="form_1420.png"/>, <img class="formulaInl" alt="$\theta_l$" src="form_738.png"/>, and <img class="formulaInl" alt="$\theta_{l,min}$" src="form_801.png"/>, where <img class="formulaInl" alt="$f_{inf}$" src="form_736.png"/> represents the fractional saturation of the soil behind the wetting front, corresponding to a hydraulic conductivity of half the saturated value (this correction is applied in order to account for the fact that as infiltration occurs, a small amount of air is usually trapped in the soil). GRKINF is calculated from GRKSATF, THLINF and THPORF, using the classic Clapp and Hornberger (1978) equation</p>
<p><img class="formulaInl" alt="$K(z) = K_{sat} ( \theta_l / \theta_p)^{(2b + 3)}$" src="form_1421.png"/></p>
<p>where K(z) is the hydraulic conductivity at a depth z, <img class="formulaInl" alt="$K_{sat}$" src="form_729.png"/> is the hydraulic conductivity at saturation, <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> is the pore volume and b is an empirical coefficient.</p>
<p>In loop 150, values for the IG+1 entries in each of the above arrays are assigned. If the permeable thickness DELZW of the IG layer is less than its overall thickness DELZ (indicating the presence of bedrock) the IG+1 entries are set to 0; otherwise they are set to the values for the IG layer in the case of THLIQX, THICEX, TBARWX and THLINF, and for DELZX and ZBOTX they are set to large positive numbers. GRKINF is set to the value for the IG layer multiplied by the drainage parameter XDRAIN, which takes a value of 0 if the soil is underlain by an impermeable layer (as in a bog), and a value of 1 otherwise.</p>
<p>In loop 200, the soil water suction across the wetting front psi_f is calculated for each soil layer, using equation 25 in Verseghy (1991):</p>
<p><img class="formulaInl" alt="$\Psi_f = b[\Psi_{inf} K_{inf} - \Psi(z) K(z)]/[K_{inf} (b+3)]$" src="form_1422.png"/></p>
<p>where <img class="formulaInl" alt="$\Psi_{inf}$" src="form_1423.png"/> and <img class="formulaInl" alt="$K_{inf}$" src="form_1424.png"/> are the soil moisture suction and the hydraulic conductivity behind the wetting front, and <img class="formulaInl" alt="$\Psi(z)$" src="form_791.png"/> and <img class="formulaInl" alt="$K(z)$" src="form_794.png"/> are the soil moisture suction and the hydraulic conductivity ahead of the wetting front. The soil moisture suction values are obtained using the classic Clapp and Hornberger (1978) equation:</p>
<p><img class="formulaInl" alt="$\Psi(z) = \Psi_{sat} (\theta_l / \theta_p )^{(-b)}$" src="form_1425.png"/></p>
<p>where <img class="formulaInl" alt="$\Psi_{sat}$" src="form_611.png"/> is the soil moisture suction at saturation.</p>
<p>In loop 400, a test is carried out to determine whether saturated conditions are already present in the soil. Generally it is assumed that a period of unsaturated flow occurs initially, so the flag IFILL is set to 1, the depth of the wetting front ZF is set to zero, and the flag LZF indicating the index of the soil layer in which the wetting front occurs is set to 1. If a pond is present on the soil surface or if the hydraulic conductivity if the first soil layer is very small, it is deemed that saturated flow begins immediately, so IFILL is set to zero. Then each soil layer is checked in turn, to ascertain whether the liquid water content is greater than THLINF. If so, it is concluded that saturated flow is occurring in this layer; ZF is set to ZBOTW, the depth of the bottom of the soil layer, LZF is set to the index of the next layer, and IFILL is set to zero. For each layer found to be undergoing saturated flow, its water content is stored in the J+1 level of the water movement matrix WMOVE, and its water temperature is stored in the J+1 level of the matrix TMOVE. The counter NINF is set to the number of soil layers behind and including the one with the wetting front, plus 2.</p>
<p>A series of subroutines is called to complete the infiltration calculations. Subroutine WFILL treats the period of unsaturated flow up the point when saturated flow begins. Subroutine WFLOW treats the period of saturated flow. Subroutine WEND reassigns liquid water contents and temperatures at the conclusion of the infiltration period. THLIQ, THICE and TBARW are then set to the corresponding updated values of THLIQX, THICEX and TBARWX. The average depth of the wetting front in the soil layer in which it occurs, the index of the soil layer, and the moisture content behind the wetting front are stored in output variables ZFAV, LZFAV and THLINV respectively. Finally, if there is any time remaining in the current time step following the infiltration period, subroutine GRDRAN is called to treat the movement of soil water over the remainder of the time step.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 31 2016 14:29:32 for CLASS-CTEM Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
