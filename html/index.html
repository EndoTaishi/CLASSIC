<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CLASS-CTEM Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#overviewCTEM">Overview of the Canadian Terrestrial Ecosystem Model (CTEM)</a></li>
<li class="level1"><a href="#overviewCLASS">Overview of the Canadian Land Surface Scheme (CLASS)</a><ul><li class="level2"><a href="#devHistory">Developmental history of CLASS</a></li>
</ul>
</li>
<li class="level1"><a href="#dataRequirements">Data Requirements</a><ul><li class="level2"><a href="#forcingData">Forcing Data</a></li>
<li class="level2"><a href="#vegetationData">Vegetation Data</a></li>
<li class="level2"><a href="#soilData">Soil Data</a></li>
<li class="level2"><a href="#initProgVar">Initialization of Prognostic Variables</a></li>
</ul>
</li>
<li class="level1"><a href="#runStandAloneMode">Running CLASS-CTEM</a><ul><li class="level2"><a href="#compvsmosaic">One thing to note about composite versus mosaic running of the model</a></li>
<li class="level2"><a href="#inputs">The Input Files</a><ul><li class="level3"><a href="#MET">The MET file (Meteorological forcings)</a></li>
<li class="level3"><a href="#INI">The INI file (CLASS's initialization file)</a></li>
<li class="level3"><a href="#classvals">Typical values of vegetation-related fields for CLASS-only simulations</a></li>
<li class="level3"><a href="#classtoctem">CLASS and CTEM PFTs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="overviewCTEM"></a>
Overview of the Canadian Terrestrial Ecosystem Model (CTEM)</h1>
<p>Version 1 of the CTEM is the terrestrial carbon cycle component of the second generation Canadian Earth System Model (CanESM2) <a class="el" href="citelist.html#CITEREF_Arora2011-79f">[10]</a> where it is coupled to version 2.7 of the Canadian Land Surface Scheme (CLASS). CTEM v. 2.0 <a class="el" href="citelist.html#CITEREF_Melton2016-zx">[39]</a> is currently coupled to the CLASS v. 3.6 <a class="el" href="citelist.html#CITEREF_Verseghy2012-c0e">[55]</a>. The coupled CLASS&ndash;CTEM model is capable of being run online in the CanESM model or offline, as is the case in this study, driven by observation-based meteorological forcings. CTEM models terrestrial ecosystem processes for nine PFTs, two of which are crop PFTs (see Table tab:compparams}), by tracking the flow of carbon through three living vegetation components (leaves, stem and roots) and two dead carbon pools (litter and soil). The carbon budget equations for the model's five pools are summarized in Sect. rate_change_eqns} of the Appendix. The amount of carbon in these five carbon pools is simulated prognostically. CLASS models the land surface energy and water balance and calculates liquid and frozen soil moisture, and soil temperature for three soil layers (with thicknesses 0.1, 0.25 and 3.75\, <img class="formulaInl" alt="$m$" src="form_20.png"/>). In the CLASS&ndash;CTEM framework, CLASS uses structural vegetation attributes (including LAI, vegetation height, canopy mass and rooting depth) simulated by CTEM, and CTEM uses soil moisture, soil temperature and net radiation calculated by CLASS. Combined, CLASS and CTEM simulate the atmosphere&ndash;land fluxes of energy, water and <img class="formulaInl" alt="$CO_2$" src="form_19.png"/>.</p>
<p>Version 1.0 of CTEM is described in a collection of papers detailing parametrization of photosynthesis, autotrophic and heterotrophic respiration <a class="el" href="citelist.html#CITEREF_Arora2003-3b7">[11]</a>; phenology, carbon allocation, biomass turnover and conversion of biomass to structural attributes <a class="el" href="citelist.html#CITEREF_Arora2005-6b1">[5]</a>; dynamic root distribution <a class="el" href="citelist.html#CITEREF_Arora2003838">[3]</a>; and disturbance (fire) <a class="el" href="citelist.html#CITEREF_Arora20052ac">[4]</a>. These processes are modelled over prescribed fractional coverage of nine PFTs <a class="el" href="citelist.html#CITEREF_Wang2006-he">[57]</a> and determine the structural vegetation dynamics including vegetation biomass, LAI, vegetation height, fraction of roots in each of the three soil layers, leaf onset and offset times and primary <img class="formulaInl" alt="$CO_2$" src="form_19.png"/> fluxes of gross primary productivity (GPP) and NPP. A full description of CTEM and changes from v. 1.0 to v. 2.0 are included in the Appendix.</p>
<p>A parametrization for competition between PFTs in an earlier version of CTEM is described by <a class="el" href="citelist.html#CITEREF_Arora2006-pp">[6]</a> <a class="el" href="citelist.html#CITEREF_Arora2006-ax">[7]</a> where it was evaluated at select locations. Here we present CTEM v. 2.0, which builds upon the model framework of CTEM v. 1.0 and can be run in two different modes, either (i) using specified fractional coverage of its nine PFTs, or (ii) allowing the fractional coverage of its seven non-crop PFTs to be dynamically determined based on competition between PFTs. The parametrization for simulating competition between PFTs is summarized in Sect. compmain}. The fire parametrization has also been refined in the new model version as described in Appendix fire}. The CLASS&ndash;CTEM modelling framework has the capability of representing the sub-grid scale variability of PFTs using either a composite or a mosaic configuration <a class="el" href="citelist.html#CITEREF_Li2012-f7f">[33]</a> <a class="el" href="citelist.html#CITEREF_Melton2014-xk">[37]</a>. In the composite (or single tile) configuration, the vegetation attributes for all PFTs present in a grid cell are averaged and used in energy and water balance calculations that determine the physical land surface conditions including soil moisture, soil temperature and thickness and fractional coverage of snow (if present). In the mosaic (or multi-tile) configuration each PFT is allocated its own tile for which separate energy and water balance calculations are performed. As a result, the simulated carbon balance evolves somewhat differently in the two configurations despite being driven with identical climate forcing (see <a class="el" href="citelist.html#CITEREF_Melton2014-xk">[37]</a>). The results presented in this paper are obtained using the composite configuration.</p>
<h1><a class="anchor" id="overviewCLASS"></a>
Overview of the Canadian Land Surface Scheme (CLASS)</h1>
<p>The Canadian Land Surface Scheme, CLASS, was originally developed for use with the Canadian Global Climate Model or GCM (Verseghy, 1991; Verseghy et al., 1993). This documentation describes version 3.6 of CLASS, which was released in December of 2011. The table at the end of this overview summarizes the development of CLASS from the late 1980’s to the present.</p>
<p>The basic function of CLASS is to integrate the energy and water balances of the land surface forward in time from an initial starting point, making use of atmospheric forcing data to drive the simulation. When CLASS is run in coupled mode with a global or regional atmospheric model, the required forcing data are passed to it at each time step over each modeled grid cell from the atmospheric driver. CLASS then performs its internal calculations, evaluating a suite of prognostic and diagnostic variables such as albedo and surface radiative and turbulent fluxes, which are in turn passed back to the driver. CLASS can also be run in uncoupled or offline mode, using forcing data derived from field measurements, and the output values of its prognostic and diagnostic variables can then be validated against observations. Version 3.6 includes a single-column offline driver which can be used for this purpose.</p>
<p>CLASS models separately the energy and water balances of the soil, snow, and vegetation canopy (see the diagram below). The basic prognostic variables consist of the temperatures and the liquid and frozen moisture contents of the soil layers; the mass, temperature, density, albedo and liquid water content of the snow pack; the temperature of the vegetation canopy and the mass of intercepted rain and snow present on it; the temperature and depth of ponded water on the soil surface; and an empirical vegetation growth index. These variables must be initialized, and a set of physical parameters describing the soil and vegetation existing on the modelled area must be assigned background values, at the beginning of the simulation.</p>
<p>At each time step, CLASS calculates the bulk characteristics of the vegetation canopy on the basis of the vegetation types present over the modelled area. In a pre-processing step, each vegetation type is assigned representative values of parameters such as albedo, roughness length, annual maximum and minimum plant area index, rooting depth and so on (see the section on “Data Requirements”). These values are then aggregated over four main vegetation categories identified by CLASS: needleleaf trees, broadleaf trees, crops, and grass (i.e. short vegetation). The physiological characteristics of the vegetation in each category are determined at the current time step using the aggregated background parameters and assumed annual or diurnal variation functions. These physiological characteristics are then aggregated to produce the bulk canopy characteristics for the current time step.</p>
<div class="image">
<img src="schematicDiagramOfClass.png" alt="schematicDiagramOfClass.png"/>
<div class="caption">
Schematic Diagram Of CLASS</div></div>
 In performing the surface flux calculations the modeled area is divided into up to four subareas: bare soil, vegetation over soil, snow over bare soil, and vegetation over snow. The fractional snow coverage is determined using the concept of a threshold snow depth. If the calculated snow depth is less than this value, the snow depth is set to the threshold value and the fractional snow cover is calculated on the basis of conservation of snow mass. The fluxes are calculated for each of the four subareas, and these and the prognostic variables are then areally averaged before being passed back to the atmospheric model.</p>
<p>Originally CLASS performed only one set of these calculations for each grid cell of the model domain. In more recent versions, a “mosaic” option has been added to handle sub-grid scale heterogeneity more effectively. When this option is utilized, each grid cell is divided into a user-specified number of mosaic “tiles”, and the CLASS calculations are performed in turn over each. The surface fluxes are averaged, but the prognostic variables are kept separate for each of the tiles of the mosaic between time steps.</p>
<p>The section on the CLASS offline driver, RUNCLASS, provides information on how a CLASS run is typically performed, from assigning the background and initial values of variables, through calling the high-level CLASS subroutines, to calculating values of diagnostic and output variables. A gather-scatter operation is included in the driver, mimicking the practice in atmospheric models of “gathering” land surface points on latitude circles onto long vectors prior to the calculations, for improved computational efficiency on vector supercomputers. For CLASS, the mosaic tiles on each of the modelled grid cells are “gathered” onto long arrays prior to calling the CLASS subroutines (thus collapsing the first two dimensions of the arrays into one), and subsequently “scattered” back onto the grid cells before performing the diagnostic averaging calculations.</p>
<p>The two sections following the one that describes the driver provide detailed descriptions first of the common block and other preliminary routines that are called before the run is launched, and then of the pre- and post-processing routines that are called at the beginning and end of each time step. The next three sections detail the three main CLASS subroutines together with the auxiliary subroutines that they call: CLASSA, which handles the calculation of the albedos and other surface parameters; CLASST, which addresses the evaluation of the surface energy balance and related variables; and CLASSW, which performs the surface water balance calculations and the re-aggregation of the prognostic variables. The sub-section on each subroutine contains a dictionary of the variables passed into and out of it, with units. The final section provides a list of references cited.</p>
<h2><a class="anchor" id="devHistory"></a>
Developmental history of CLASS</h2>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | l || l | } 1.0 &amp; April 1989 &amp; Basic thermal and hydrological model of snow and soil. \\ 2.0 &amp; August 1991 &amp; Addition of vegetation thermal and hydrological model. \\ 2.1 &amp; May 1993 &amp; Full vectorization of code to enable efficienr running on vector supercomputers. \\ 2.2 &amp; April 1994 &amp; Augmentation of diagnostic calculations; incorporation of in-line comments throughout; development \\ &amp; &amp; of a parallel stand-alone version of the model for use with field data. \\ 2.3 &amp; December 1994 &amp; Revisions to diagnostic calculations; new near-surface atmospheric stability functions. \\ 2.4 &amp; August 1995 &amp; Complete set of water budget diagnostic calculations; parametrizations of organic soils and \\ &amp; &amp;rock soils; allowance for inhomegeneity between soil layers; incorporation of variable \\ &amp; &amp; surface detention capacity. \\ 2.5 &amp; January 1996 &amp; Completion of energy budget diagnostic calculations. \\ 2.6 &amp; August 1997 &amp; Revisions to surface stability function calculations. \\ 2.7 &amp; December 1997 &amp; Incorporation of variable soil permeable depth; calculation of soil thermal and hydraulic \\ &amp; &amp; properties based on textural composition; modified surface temperature iteration scheme. \\ 3.0 &amp; December 2002 &amp; Improved treatment of soil evaporation; complete treatment of organic soils; new canopy \\ &amp; &amp; conductance formulation; preliminary routines for lateral movement of soil water; enhanced snow \\ &amp; &amp; density and snow interception; improved turbulent transfer from vegetation; mosaic formulation. \\ 3.1 &amp; April 2005 &amp; Faster surface temperature iteration scheme; refinements to leaf boundary resistance formulation; \\ &amp; &amp; improved treatment of snow sublimation and interception; transition to Fortran 90 and\\ &amp; &amp; single precision variables. \\ 3.2 &amp; May 2006 &amp; Option for multiple soil layers at depth; additional liquid water content of snow pack; revised radiation \\ &amp; &amp; transmission in vegetation. \\ 3.3 &amp; December 2006 &amp; Separate temperature profile curve fit for snow and soil; multiple-layer option for ice sheets;\\ &amp; &amp; water and energy balance checks for each time step; modifications to soil hydraulic \\ &amp; &amp; conductivity calculations. \\ 3.4 &amp; April 2008 &amp; Streamline and clean up code; updated soil thermal conductivity calculations; revisions to handling of\\ &amp; &amp; water stored on vegetation. \\ 3.5 &amp; December 2010 &amp; Updated field capacity calculation; revised treatment of water on canopy; \\ &amp; &amp; reworked calculation of baseflow. \\ 3.6 &amp; December 2011 &amp; Revised ponding depth over organic soils; revised snow albedo refreshment \\ &amp; &amp; threshold; new snow thermal conductivity algorithm; interface with Canadian Terrestrial \\ &amp; &amp; Ecosystem Model (CTEM). \\ \end{tabular} \]" src="form_1903.png"/>
</p>
<h1><a class="anchor" id="dataRequirements"></a>
Data Requirements</h1>
<p>This section describes the three types of data that are required to run CLASS: atmospheric forcing data, surface vegetation and soil data, and initial values for the prognostic variables.</p>
<h2><a class="anchor" id="forcingData"></a>
Forcing Data</h2>
<p>At each time step, for each grid cell or modelled area, the following atmospheric forcing data are required:</p>
<ul>
<li>FCLOROW Fractional cloud cover [ ]</li>
<li>FDLROW Downwelling longwave sky radiation <img class="formulaInl" alt="$[ W m^{-2} ]$" src="form_629.png"/></li>
<li>FSIHROW Near infrared shortwave radiation incident on a horizontal surface <img class="formulaInl" alt="$[W m^{-2} ]$" src="form_630.png"/></li>
<li>FSVHROW Visible shortwave radiation incident on a horizontal surface <img class="formulaInl" alt="$[W m^{-2} ]$" src="form_630.png"/></li>
<li>PREROW Surface precipitation rate <img class="formulaInl" alt="$[kg m^{-2} s^{-1} ]$" src="form_631.png"/></li>
<li>PRESROW Surface air pressure <img class="formulaInl" alt="$[P_a ]$" src="form_632.png"/></li>
<li>QAROW Specific humidity at reference height <img class="formulaInl" alt="$[kg kg^{-1} ]$" src="form_633.png"/></li>
<li>TAROW Air temperature at reference height [K]</li>
<li>ULROW Zonal component of wind velocity <img class="formulaInl" alt="$[m s^{-1} ]$" src="form_634.png"/></li>
<li>VLROW Meridional component of wind velocity <img class="formulaInl" alt="$[m s^{-1} ]$" src="form_634.png"/></li>
<li>VMODROW Wind speed at reference height <img class="formulaInl" alt="$[m s^-1 ]$" src="form_635.png"/></li>
<li>ZBLDROW Atmospheric blending height for surface roughness length averaging [m]</li>
<li>ZRFHROW Reference height associated with forcing air temperature and humidity [m]</li>
<li>ZRFMROW Reference height associated with forcing wind speed [m]</li>
</ul>
<p>When assembling the forcing data, the following guidelines should be noted:</p>
<p>1) CLASS ordinarily requires that the forcing incoming shortwave radiation be partitioned into the visible and near-infrared components. If these are not available, however, they can each be roughly estimated as approximately half of the total incoming solar radiation.</p>
<p>2) The fractional cloud cover is used to calculate the direct and diffuse components of the incoming shortwave radiation. If it is not available it can be estimated on the basis of the solar zenith angle and the occurrence of precipitation (see the section on the RUNCLASS driver).</p>
<p>3) For atmospheric models, the air temperature supplied to CLASS should be the lowest level air temperature extrapolated using the dry adiabatic lapse rate to the bottom of the atmosphere, i.e. to where the wind speed is zero and the pressure is equal to the surface pressure P a . For field data, the actual measured air temperature at the reference height should be used, since in this case the adiabatic extrapolation is performed within CLASS.</p>
<p>4) Atmospheric models provide the zonal and meridional components of the wind velocity, but CLASS does not actually require information on wind direction. Thus, if only the scalar wind speed is available, either ULROW or VLROW can be set to it, and the other to zero. (Both of these terms, plus the scalar wind speed VMODROW, must be supplied to CLASS.)</p>
<p>5) In atmospheric models the forcing wind speed, air temperature and specific humidity are obtained from the lowest modelled atmospheric layer, and thus the reference height will be the height above the “surface” (i.e. the location where the wind speed is zero and the pressure is equal to the surface pressure P a ) corresponding to that lowest layer. Some atmospheric models use a vertical co-ordinate system in which the momentum and thermodynamic levels are staggered, and if so, ZFRMROW and ZRFHROW will have different values. If that is the case, the switch ISLFD in the CLASS driver should be set to 2, so that the subroutines FLXSURFZ and DIASURFZ are called (see the RUNCLASS documentation), since the other options do not support different reference heights. In the case of field data, the reference height is the height above the ground surface at which the variables are measured. If the measurement height for wind speed is different from that for the air temperature and specific humidity, again the ISLFD switch in the CLASS driver should be set to 2. (Note that neither ZRFHROW nor ZRFMROW may be smaller than the vegetation canopy height, as this will cause the model run to crash.)</p>
<p>6) If the surface being modelled is a heterogeneous one, care must be taken to ensure that the reference heights are greater than the “blending height”, the distance above the surface at which the atmospheric variables are not dominated by any one surface type. In principle this height depends on the length scale of the roughness elements; it is usually of the order of 50-100 m. In CLASS the blending height is used in averaging the roughness lengths over the modelled area, and is read in separately from ZRFMROW and ZRFHROW as ZBLDROW.</p>
<p>7) CLASS is able to run with total incoming precipitation, partitioning it into rainfall and snowfall on the basis of empirically derived equations. If the rainfall rate (RPREROW) and snowfall rate (SPREROW) are available, they should be used instead. The READ statement in the CLASS driver should be modified accordingly, and the switch IPCP should be set to 4.</p>
<p>8) The length of the time step should be carefully considered in assembling the forcing data. CLASS has been designed to run at a time step of 30 minutes or less, and the explicit prognostic time stepping scheme used for the soil, snow and vegetation variables is based on this assumption. Longer time steps may lead to the appearance of numerical instabilities in the modelled prognostic variables.</p>
<h2><a class="anchor" id="vegetationData"></a>
Vegetation Data</h2>
<p>For each of the four main vegetation categories (needleleaf trees, broadleaf trees, crops and grass), the following data are required for each mosaic tile over each grid cell or modelled area:</p>
<ul>
<li>ALICROT Average near-IR albedo of vegetation category when fully-leafed [ ]</li>
<li>ALVCROT Average visible albedo of vegetation category when fully-leafed [ ]</li>
<li>CMASROT Annual maximum canopy mass for vegetation category <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>FCANROT Annual maximum fractional coverage of modelled area [ ]</li>
<li>LNZ0ROT Natural logarithm of maximum vegetation roughness length [ ]</li>
<li>PAMNROT Annual minimum plant area index of vegetation category [ ]</li>
<li>PAMXROT Annual maximum plant area index of vegetation category [ ]</li>
<li>PSGAROT Soil moisture suction coefficient (used in stomatal resistance calculation) [ ]</li>
<li>PSGBROT Soil moisture suction coefficient (used in stomatal resistance calculation) [ ]</li>
<li>QA50ROT Reference value of incoming shortwave radiation (used in stomatal resistance calculation) <img class="formulaInl" alt="$[W m^{-2} ]$" src="form_630.png"/></li>
<li>ROOTROT Annual maximum rooting depth of vegetation category [m]</li>
<li>RSMNROT Minimum stomatal resistance of vegetation category <img class="formulaInl" alt="$[s m^{-1} ]$" src="form_637.png"/></li>
<li>VPDAROT Vapour pressure deficit coefficient (used in stomatal resistance calculation) [ ]</li>
<li>VPDBROT Vapour pressure deficit coefficient (used in stomatal resistance calculation) [ ]</li>
</ul>
<p>CLASS models the physiological characteristics of trees as remaining constant throughout the year except for the leaf area index and plant area index, which vary seasonally between the limits defined by PAMXROT and PAMNROT. The areal coverage of crops varies from zero in the winter to FCANROT at the height of the growing season, and their physiological characteristics undergo a corresponding cycle. Grasses remain constant year-round. (For full details of these calculations, see the documentation for subroutine APREP). Urban areas are also treated as “vegetation” in the CLASS code, and have associated values for FCANROT, ALVCROT, ALICROT and LNZ0ROT. Thus these arrays have a third dimension of 5 rather than 4.</p>
<p>Ideally the above vegetation parameters should be measured at the modelled location. Of course this is not always possible, especially when running over a large modelling domain. As a guide, the table in Appendix A provides representative values for the 20 vegetation types recognized by the Canadian GCM. If more than one type of vegetation in a given category is present on the modelled area, the parameters for the category should be areally averaged over the vegetation types present. For the stomatal resistance parameters, typical values of these for the four principal vegetation types are given below:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | c | c | c | c | c | c | } &amp; RSMN &amp; QA50 &amp; VPDA &amp; VPDB &amp; PSGA &amp; PSGB \\ Needleleaf trees &amp; 200.0 &amp; 30.0 &amp; 0.65 &amp; 1.05 &amp; 100.0 &amp; 5.0 \\ Broadleaf trees &amp; 125.0 &amp; 40.0 &amp; 0.50 &amp; 0.60 &amp; 100.0 &amp; 5.0 \\ Crops &amp; 85.0 &amp; 30.0 &amp; 0.50 &amp; 1.00 &amp; 100.0 &amp; 5.0 \\ Grass &amp; 100.0 &amp; 30.0 &amp; 0.50 &amp; 1.00 &amp; 100.0 &amp; 5.0 \\ \end{tabular} \]" src="form_1904.png"/>
</p>
<h2><a class="anchor" id="soilData"></a>
Soil Data</h2>
<p>The following information is required for each modelled soil layer:</p>
<ul>
<li>DELZ Layer thickness [m]</li>
<li>ZBOT Depth of bottom [m]</li>
</ul>
<p>The standard operational configuration for CLASS consists of three soil layers, of thicknesses 0.10 m, 0.25 m and 3.75 m, and thus of bottom depths 0.10, 0.35 and 4.10 m respectively. CLASS versions 3.2 and higher support other options: the third soil layer may be replaced with a larger number of thinner layers, and/or the bottom of the soil profile may be extended below 4.10 m. However, because the temperature stepping scheme used in CLASS is of an explicit formulation, care must be taken not to make the layers too thin, since this may lead to numerical instability problems.</p>
<p>For each of the modelled soil layers on each of the mosaic tiles, the following texture data are required:</p>
<ul>
<li>CLAYROT Percentage clay content</li>
<li>ORGMROT Percentage organic matter content</li>
<li>SANDROT Percentage sand content</li>
</ul>
<div class="image">
<img src="percentSand.png" alt="percentSand.png"/>
<div class="caption">
Percent Sand</div></div>
 1) For mineral soils, the percentages of sand, clay and organic matter content need not add up to 100%, since the residual is assigned to silt content. If the exact sand, clay and organic matter contents are not known, estimates can be made for the general soil type on the basis of the standard USDA texture triangle shown above. Organic matter contents in mineral soils are typically not more than a few percent.</p>
<p>2) If the soil layer is a fully organic one, SANDROT, CLAYROT and ORGMROT are used differently. The sand content is assigned a flag value of -2, and the organic matter content may be assigned a flag value of 1, 2 or 3 depending on whether the peat texture is fibric, hemic or sapric (see Letts et al., 2000). The current default is for the first layer to be assumed as fibric, the second as hemic and any lower layers as sapric. CLAYROT is not used and is set to zero.</p>
<p>3) If the layer consists of rock, SANDROT is assigned a flag value of -3. If it is part of a continental ice sheet, it is assigned a flag value of -4. In both cases, CLAYROT and ORGMROT are not used and are set to zero.</p>
<p>SANDROT, CLAYROT and ORGMROT are utilized in the calculation of the soil layer thermal and hydraulic properties in subroutine CLASSB. If the measured values of these properties are available, they should be used instead.</p>
<p>For each of the mosaic tiles over the modelled area, the following surface parameters must be specified:</p>
<ul>
<li>DRNROT Soil drainage index</li>
<li>FAREROT Fractional coverage of mosaic tile on the modelled area</li>
<li>MIDROT Mosaic tile type identifier (1 for land surface, 0 for inland lake)</li>
<li>SDEPROT Soil permeable depth [m]</li>
</ul>
<p>1) The soil permeable depth, i.e. the depth to bedrock, may be less than the modelled thermal depth of the soil profile. This permeable depth is indicated by the variable SDEPROT. If the depth to bedrock occurs within a soil layer rather than at the interface between two layers, CLASS assigns the specified mineral or organic soil characteristics to the part of the layer above bedrock, and values corresponding to rock to the portion below.</p>
<p>2) The drainage index, DRNROT, is set to 1 except in cases of deep soils where it is desired to suppress drainage from the bottom of the soil profile (e.g. in bogs, or in deep soils with a high water table). In this case it is set to 0.</p>
<p>When the standard three-layer soil configuration is used, CLASS provides a means of accounting for the possibility of the depth to bedrock falling within the thick third layer, and therefore of phase changes of water taking place in only the upper part of the layer, by introducing the variable TBASROT, which refers to the temperature of the lower part of the layer containing the bedrock. At the beginning of the time step the temperature of the upper part of the layer is disaggregated from the overall average layer temperature using the saved value of TBASROT. The heat flow between the upper part of the soil layer and the lower part is diagnosed from the heat flux at the top of the layer. The upper layer temperature and TBASROT are stepped ahead separately, and the net heat flux in the upper part of the layer is used in the phase change of water if appropriate. The upper layer temperature and TBASROT are re-aggregated at the end of the time step to yield once again the overall average layer temperature.</p>
<p>Two variables, assumed to be constant over the grid cell, are provided if required for atmospheric model runs:</p>
<ul>
<li>GGEOROW Geothermal heat flux <img class="formulaInl" alt="$[W m^{-2} ]$" src="form_630.png"/></li>
<li>Z0ORROW Orographic roughness length [m]</li>
</ul>
<p>Unless the soil depth is very large and/or the run is very long, the geothermal heat flux can be set to zero. Z0ORROW is the surface roughness length representing the contribution of orography or other terrain effects to the overall roughness, which becomes important when the modelled grid cell is very large (e.g. in a GCM). For field studies it can be set to zero.</p>
<p>Finally, four parameters are required for modelling lateral movement of soil water: GRKFROT, WFCIROT, WFSFROT and XSLPROT. However, the routines for interflow and streamflow modelling are still under development, so unless the user is involved in this development, these parameters can be set to arbitrary values, since they will not be used.</p>
<h2><a class="anchor" id="initProgVar"></a>
Initialization of Prognostic Variables</h2>
<p>CLASS requires initial values of the land surface prognostic variables, either from the most recent atmospheric model integration or from field measurements. These are listed below, with guidelines for specifying values for each.</p>
<ul>
<li>ALBSROT Snow albedo [ ]</li>
<li>CMAIROT Aggregated mass of vegetation canopy <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>GROROT Vegetation growth index [ ]</li>
<li>QACROT Specific humidity of air within vegetation canopy space <img class="formulaInl" alt="$[kg kg^{-1} ]$" src="form_633.png"/></li>
<li>RCANROT Intercepted liquid water stored on canopy <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>RHOSROT Density of snow <img class="formulaInl" alt="$[kg m^{-3} ]$" src="form_640.png"/></li>
<li>SCANROT Intercepted frozen water stored on canopy <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>SNOROT Mass of snow pack <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>TACROT Temperature of air within vegetation canopy [K]</li>
<li>TBARROT Temperature of soil layers [K]</li>
<li>TBASROT Temperature of bedrock in third soil layer [K]</li>
<li>TCANROT Vegetation canopy temperature [K]</li>
<li>THICROT Volumetric frozen water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3} ]$" src="form_641.png"/></li>
<li>THLQROT Volumetric liquid water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3} ]$" src="form_641.png"/></li>
<li>TPNDROT Temperature of ponded water [K]</li>
<li>TSFSROT Ground surface temperature over subarea [K]</li>
<li>TSNOROT Snowpack temperature [K]</li>
<li>WSNOROT Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2} ]$" src="form_636.png"/></li>
<li>ZPNDROT Depth of ponded water on surface [m]</li>
</ul>
<p>1) TBARROT, THLQROT and THICROT are required for each of the modelled soil layers. Thin soil layers near the surface equilibrate quickly, but thicker, deeper layers respond more slowly, and long-term biases can be introduced into the simulation if their temperatures and moisture contents are not initialized to reasonable values. For the moisture contents, it may be better to err on the low side, since soil moisture recharge typically takes place on shorter time scales than soil moisture loss. Field capacity is commonly used as an initial value. If the soil layer temperature is above freezing, the liquid moisture content would be set to the field capacity and the frozen moisture content to zero; if the layer temperature is below zero, the liquid moisture content would be set to the minimum value and the frozen moisture content to the field capacity minus the minimum value. Very deep soil temperatures do not have a large effect on surface fluxes, but errors in their initial values can adversely effect hydrological simulations. If the standard three-layer soil configuration is being used, TBASROT should be set to the third soil layer temperature; otherwise it can be arbitrarily set to zero. For rock or ice layers, THLQROT and THICROT should both be set to zero.</p>
<p>2) It is best to begin a simulation in snow-free conditions, so that the snow simulation can start from the simplest possible state where SNOROT, TSNOROT, ALBSROT, RHOSROT and WSNOROT are all initialized to zero. If erroneous values of the snow variables are specified as initial conditions, this can lead to a persistent bias in the land surface simulation.</p>
<p>3) The vegetation canopy has a relatively small heat capacity and water storage capacity compared with the soil, so its temperature and intercepted water stores equilibrate quite quickly. TCANROT and TACROT can be initialized to the air temperature and QACROT to the air specific humidity. RCANROT and SCANROT can be initialized to zero. CMAIROT, which is used only in the diagnostic energy balance check during the time step, can also be set to zero.</p>
<p>4) GROROT should be initialized to 1 during the growing season and to 0 otherwise.</p>
<p>5) Surface ponded water is a small term and is ephemeral in nature, so ZPNDROT and TPNDROT can both be initialized to zero. TSFSROT is included simply to provide a first guess for the surface temperature iteration in the next time step, so it can be initialized to an arbitrary value. For the snow-covered subareas of the surface it can be set to the freezing point of water; for the snow-free subareas it can be set to the temperature of the first soil layer.</p>
<h1><a class="anchor" id="runStandAloneMode"></a>
Running CLASS-CTEM</h1>
<p>Some points:</p><ol type="1">
<li><a class="el" href="runclass36ctem_8f.html" title="Principle driver program to run CLASS in stand-alone mode using specified boundary conditions and atm...">runclass36ctem.f</a> is the primary driver via which most input data is read (CTEM's initialization files are read in <a class="el" href="io__driver_8f90.html" title="Central module that handles all CTEM reading and writing of external files. ">io_driver.f90</a>) and subroutines are called.</li>
<li>The model initialization files include one for CLASS (SITENAME.INI) and one for CTEM (SITENAME.CTM). Examples provided in the Benchmarks folder.</li>
<li>The file containing meteorological data (SITENAME.MET). Also provided in the Benchmarks folder.</li>
<li>A Makefile is included which compiles all .f and .f90 files and generates an executable called CLASS36CTEM. The standard Makefile, currently set up for pgf90 (but can also be setup for xlf and gfortran) may not be suitable for your Unix station and might require modification. You may need your system administrator’s help to do this. Note that when the code is compiled it generates .mod files that corresponds to the Fortran modules.</li>
</ol>
<p>Other than the .INI, .CTM and .MET files which are mandatory, some other CTEM related files are also required depending on which CTEM functionality is switched on. These required files are discussed further down in this user guide.</p>
<h2><a class="anchor" id="compvsmosaic"></a>
One thing to note about composite versus mosaic running of the model</h2>
<p>In the composite mode, the structural vegetation attributes (including leaf area index, vegetation height, rooting depth) of PFTs that exist in a grid cell are averaged in proportion to their fractional coverages and then used in the grid-averaged energy and water balance calculations. As a result the entire grid cell is characterized by land surface physical environment (including soil temperature, soil moisture, fractional snow cover, and net radiation) that is common to all PFTs. In contrast, in the mosaic mode a grid box is split into multiple tiles representing individual PFTs for each of which energy, water and carbon balance calculations are performed separately. The mosaic mode is, however, able to represent all forms of sub-grid scale variabilities. In principle, the mosaic mode may be used to represent tiles that are characterized by different soil types. For the purposes of coupling to CTEM, however, each tile represents each PFT.</p>
<p>In the composite mode then there is only one tile which covers the whole grid cell and the fractional coverage of CLASS’s 4 PFTs and CTEM’s 9 PFTs are specified or dynamically modelled by CTEM. In the mosaic mode, the grid cell is divided into multiple tiles and each tile is assumed to be covered by only one PFT (for simplicity) although the entire grid cell is still assumed to be characterized by the same soil type. <a class="el" href="citelist.html#CITEREF_Melton2016-zx">[39]</a> describe the composite and mosaic approaches for the CLASS-CTEM modelling framework.</p>
<p>Although pretty clever, running the mosaic version and interpreting the model results can be a logical nightmare, especially with competition on where the fractions of different tiles/mosaic change with time. So if you are new at this, please consider running the model in the composite mode.</p>
<h2><a class="anchor" id="inputs"></a>
The Input Files</h2>
<h3><a class="anchor" id="MET"></a>
The MET file (Meteorological forcings)</h3>
<p>The .MET files contain (usually) half-hourly values of all seven variables that are needed to drive the CLASS land surface scheme. Please see the Benchmarks folder for an example .MET file. The format of the .MET file cannot be changed since CLASS reads in these data using a fixed FORTRAN format (1X,I2,I3,I5,I6,2F9.2,E14.4,F9.2,E12.3,F8.2,F12.2,3F9.2,F9.4).</p>
<h3><a class="anchor" id="INI"></a>
The INI file (CLASS's initialization file)</h3>
<p>The .INI file is the initialization file for CLASS, and includes initialization data for soil moisture, temperature, and other related fields. Like the .MET file, the .INI file also uses fixed FORTRAN formats to read data, so caution must be taken when changing the .INI file fields. In addition, note that when the code is run with dynamic vegetation (when CTEM is switched on) several of the vegetation- related fields specified in the .INI file are replaced by those estimated by CTEM. These fields include:</p>
<ul>
<li>Leaf area index (LAI)</li>
<li>Log of roughness length</li>
<li>Visible and near-infrared albedos</li>
<li>Canopy mass</li>
<li>Rooting depth</li>
</ul>
<p>In addition, CTEM calculates stomatal resistance values so parameters related to CLASS’ stomatal resistance formulation and the associated parameters in the .INI file (RSMN, QA50, VPDA, VPDB, PSGA and PSGB) do not matter.</p>
<p>If CLASS is being run on its own, without CTEM, proper specification of vegetation related attributes and parameters is crucial.</p>
<p>Version 2.0 of CTEM adds the capability to divide each cell into several mosaics or ‘tiles’ as mentioned above. When running for multiple tiles, Both the CLASS and CTEM calculations are performed over each tile. The prognostic variables are saved for each tile in addition to grid averaged values.</p>
<p>A sample .INI file is found in the Benchmarks folder. The INI file has very speficic formatting. You can see it in <a class="el" href="runclass36ctem_8f.html" title="Principle driver program to run CLASS in stand-alone mode using specified boundary conditions and atm...">runclass36ctem.f</a> where the INI file is read and written (search for file units 10 and 100, respectively). Below is an explanation of the variables found in the INI file:</p>
<ul>
<li>ZRFM and ZRFH (m): The reference height at which the climate variables (wind speed, temperature and specific humidity) are provided. If the model is driven by the atmospheric model forcing data, these heights would vary by time step. If the model is driven by field data (such as the sample file here), these heights refer to the measurement height of these variables.</li>
<li>ZBLD (m): Atmospheric blending height. Here it is assigned a value of 50 m.</li>
<li>GC: GCM surface description variable. For land surface (including inland water) it has a value of -1.</li>
<li>Plant growth index: CLASS uses specified maximum and minimum leaf area indices (LAIs) for each of its four plant functional types (PFTs). The LAI goes from this minimum to the maximum specified LAI at a specified rate and dependent on the soil temperature. Plant growth index determines what the LAI would be at initialization. This is little tricky if you aren’t familiar with CLASS, so it’s best left at zero. In addition, when coupled to CTEM this doesn’t matter because then CLASS uses LAI simulated by CTEM. When CTEM is switched on then all vegetation-related fields are estimated by CTEM. Competition between PFTs is now simulated and so if a user switches on this option then the fractional coverage of PFTs that grow in a grid cell is also simulated dynamically by CTEM. However, please read the discussion related to each of CTEM’s capabilities associated with each switch further down this user guide.</li>
<li>NLTEST and NMTEST: Number of grid cells and the number of mosaic tiles. NLTEST can not be greater than NLAT. Also, NMTEST must not be greater than NMOS. Typically this standalone code is run for 1 grid cell (NLTEST=1) with 1 or more mosaic tiles (NMTEST=1 or more).</li>
<li>RSMN (s m-1), QA50 (W/m2), VPDA, VPDB, PSGA and PSGB: Used in stomatal resistance calculation in CLASS subroutine CANALB. Note that these values do not matter when CTEM is switched on. Typical values for the four CLASS vegetation categories are listed above in section <b>Vegetation Data</b>.</li>
<li>DRN: Set it to 1 to allow drainage. Set it to 0 if drainage is suppressed at the bottom of the soil layer. Coupling of CLASS 3.6 to CTEM required a lot of tuning because it seems CLASS 3.6 is drier than CLASS 2.7. As a result a value of 0.1 has been lately used the CCCma Earth system model.</li>
<li>SDEP (m): Depth to bedrock in the soil profile</li>
<li>XSLP, GRKF, WFSF, WFCI: Parameters used when running MESH code, not used in Version 3.6 of CLASS.</li>
<li>TBAR, THLQ and THIC: Thin soil layers near the surface equilibrate quickly, but thicker, deeper layers respond more slowly. Long-term biases can be introduced into the simulation if the soil layers temperatures and moisture contents are not initialized accurately. For the moisture contents, it is better to err on the low side, since soil moisture recharge typically takes place on shorter scales than soil moisture loss. Very deep soil temperatures do not have a large effect on surface fluxes, but errors in their initial values can affect hydrological simulations. For rock or ice layers, THLQ and THIC should both be set to zero.</li>
<li>RCAN (kg/m2): Intercepted liquid water stored on canopy. RCAN can be initialized to zero.</li>
<li>SCAN (kg/m2): Intercepted frozen water stored on canopy The vegetation canopy has a relatively small heat capacity and water storage capacity relative to the soil, so its temperature and intercepted water stores equilibrate quickly. TCAN can be initialized to the air temperature. SCAN can be initialized to zero.</li>
<li>SNO (kg/m2): Mass of snow pack.</li>
<li>ALBS: Snow albedo.</li>
<li>RHOS (kg/m3): Snow density</li>
</ul>
<p>The above three variables and TSNO can be all initialized to 0 in snow-free conditions.</p>
<ul>
<li>TPND and ZPND: Surface ponded water is a small term and is ephemeral in nature, so ZPNDROW and TPNDROW can both be initialized to zero.</li>
<li>GRO: Vegetation growth index, should be initialized to 1 during the growing season and to 0 otherwise. If CTEM is switched on, these values do not matter.</li>
<li>DELZ and ZBOT: The standard operational configuration for CLASS consists of three soil layers, of thicknesses 0.10 m, 0.25 m and 3.75 m, and thus of bottom depths 0.10, 0.35 and 4.10 m respectively. Version 3.6 supports other options: the third soil layer may be replaced with a larger number of thinner layers, and/or the bottom of the soil profile may be extended below 4.10 m. However, care must be taken not to make the soil layers too thin since this may lead to numerical instability.</li>
</ul>
<h3><a class="anchor" id="classvals"></a>
Typical values of vegetation-related fields for CLASS-only simulations</h3>
<p>If you run CLASS without CTEM you will need to specify all vegetation-related parameters. The table below shows typical values you may want to use for different vegetation types.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | c | c | c | c | c | c | c | c | } Biome &amp; CLASS PFT &amp; Visible albedo &amp; Near-infrared Albedo &amp; Roughness length (m) \\ Needleleaf evergreen forest &amp; 1 &amp; 0.03 &amp; 0.19 &amp; 1.5 \\ Needleleaf deciduous forest &amp; 1 &amp; 0.03 &amp; 0.19 &amp; 1.0 \\ Broadleaf evergreen forest &amp; 2 &amp; 0.03 &amp; 0.23 &amp; 3.5 \\ Broadleaf cold deciduous forest &amp; 2 &amp; 0.05 &amp; 0.29 &amp; 2.0 \\ Broadleaf tropical evergreen forest &amp; 2 &amp; 0.03 &amp; 0.23 &amp; 3.0 \\ Broadleaf tropical drought deciduous forest &amp; 2 &amp; 0.05 &amp; 0.29 &amp; 0.8 \\ Broadleaf evergreen shrub &amp; 4 &amp; 0.03 &amp; 0.19 &amp; 0.05 \\ Broadleaf deciduous shrub &amp; 2 &amp; 0.05 &amp; 0.29 &amp; 0.15 \\ Broadleaf thorn shrub &amp; 2 &amp; 0.06 &amp; 0.32 &amp; 0.15 \\ Short grass and forbs &amp; 4 &amp; 0.06 &amp; 0.34 &amp; 0.02 \\ Long grass &amp; 4 &amp; 0.05 &amp; 0.31 &amp; 0.08 \\ Arable &amp; 3 &amp; 0.06 &amp; 0.34 &amp; 0.08 \\ Rice &amp; 3 &amp; 0.06 &amp; 0.36 &amp; 0.08 \\ Sugarcane &amp; 3 &amp; 0.05 &amp; 0.31 &amp; 0.35 \\ Maize &amp; 3 &amp; 0.05 &amp; 0.33 &amp; 0.25 \\ Cotton &amp; 3 &amp; 0.07 &amp; 0.43 &amp; 0.10 \\ Irrigated crop &amp; 3 &amp; 0.07 &amp; 0.36 &amp; 0.08 \\ Tundra &amp; 4 &amp; 0.05 &amp; 0.29 &amp; 0.01 \\ Swamp &amp; 4 &amp; 0.03 &amp; 0.25 &amp; 0.05 \\ Urban &amp; 5 &amp; 0.09 &amp; 0.15 &amp; 1.35 \\ \end{tabular} \]" src="form_1905.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | c | c | c | c | c | c | c | c | } Biome &amp; CLASS PFT &amp; Max. LAI (m2/m2) &amp; Min. LAI (m2/m2) &amp; Aboveground biomass (kg/m2) &amp; Rooting depth (m) \\ Needleleaf evergreen forest &amp; 1 &amp; 2.0 &amp; 1.6 &amp; 25.0 &amp; 1.0 \\ Needleleaf deciduous forest &amp; 1 &amp; 2.0 &amp; 0.5 &amp; 15.0 &amp; 1.0 \\ Broadleaf evergreen forest &amp; 2 &amp; 8.0 &amp; 8.0 &amp; 50.0 &amp; 5.0 \\ Broadleaf cold deciduous forest &amp; 6.0 &amp; 0.5 &amp; 20.0 &amp; 2.0 \\ Broadleaf tropical evergreen forest &amp; 8.0 &amp; 8.0 &amp; 40.0 &amp; 5.0 \\ Broadleaf tropical drought deciduous forest &amp; 4.0 &amp; 4.0 &amp; 15.0 &amp; 5.0 \\ Broadleaf evergreen shrub &amp; 2.0 &amp; 2.0 &amp; 2.0 &amp; 0.2 \\ Broadleaf deciduous shrub &amp; 4.0 &amp; 0.5 &amp; 8.0 &amp; 1.0 \\ Broadleaf thorn shrub &amp; 3.0 &amp; 3.0 &amp; 8.0 &amp; 5.0 \\ Short grass and forbs &amp; 3.0 &amp; 3.0 &amp; 1.5 &amp; 1.2 \\ Long grass &amp; 4.0 &amp; 4.0 &amp; 3.0 &amp; 1.2 \\ Arable &amp; 4.0 &amp; 0.0 &amp; 2.0 &amp; 1.2 \\ Rice &amp; 6.5 &amp; 0.0 &amp; 2.0 &amp; 1.2 \\ Sugarcane &amp; 5.0 &amp; 0.0 &amp; 5.0 &amp; 1.0 \\ Maize &amp; 4.0 &amp; 0.0 &amp; 5.0 &amp; 1.5 \\ Cotton &amp; 5.0 &amp; 0.0 &amp; 2.0 &amp; 2.0 \\ Irrigated crop &amp; 4.0 &amp; 0.0 &amp; 2.0 &amp; 5.0 \\ Tundra &amp; 1.5 &amp; 1.5 &amp; 0.2 &amp; 0.1 \\ Swamp &amp; 1.5 &amp; 1.5 &amp; 1.0 &amp; 5.0 \\ Urban &amp; - &amp; - &amp; - &amp; - \\ \end{tabular} \]" src="form_1906.png"/>
</p>
 <h3><a class="anchor" id="classtoctem"></a>
CLASS and CTEM PFTs</h3>
<p>While CLASS models all physical processes related to energy and water balance for four PFTs, CTEM models its terrestrial ecosystem processes for nine PFTs. The nine PFTs of CTEM, however, line up with CLASS’ four PFTs perfectly as shown in Table 4. Needleleaf trees are divided into their evergreen and deciduous versions, broadleaf trees are divided into evergreen and cold and drought/dry deciduous versions, and crops and grasses are divided into their C3 and C4 versions based on their photosynthetic pathway.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{tabular}{ | l | c | c | } &amp; CTEM PFTs &amp; CLASS PFTs \\ 1. &amp; Needleleaf Evergreen &amp; Needleleaf \\ 2. &amp; Needleleaf Deciduous &amp; \\ 3. &amp; Broadleaf Evergreen &amp; Broadleaf \\ 4. &amp; Broadleaf Cold Deciduous &amp; \\ 5. &amp; Broadleaf Drought/Dry Deciduous &amp; \\ 6. &amp; C3 Crop &amp; Crops \\ 7. &amp; C4 Crop &amp; \\ 8. &amp; C3 Grass &amp; Grasses \\ 9. &amp; C4 Grass &amp; \\ \end{tabular} \]" src="form_1907.png"/>
</p>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 3 2017 14:39:14 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
