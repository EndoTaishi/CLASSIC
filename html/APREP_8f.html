<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: APREP.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">APREP.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Calculate various land surface parameters.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5fe4fa336815bc509d646edae0744405"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="APREP_8f.html#a5fe4fa336815bc509d646edae0744405">aprep</a> (FC, FG, FCS, FGS, PAICAN, PAICNS, FSVF, FSVFS, FRAINC, FSNOWC, FRAICS, FSNOCS, RAICAN, RAICNS, SNOCAN, SNOCNS, DISP, DISPS, ZOMLNC, ZOMLCS, ZOELNC, ZOELCS, ZOMLNG, ZOMLNS, ZOELNG, ZOELNS, CHCAP, CHCAPS, CMASSC, CMASCS, CWLCAP, CWFCAP, CWLCPS, CWFCPS, RBCOEF, ZPLIMC, ZPLIMG, ZPLMCS, ZPLMGS, HTCC, HTCS, HTC, FROOT, FROOTS, WTRC, WTRS, WTRG, CMAI, PAI, PAIS, AIL, FCAN, FCANS, PSIGND, FCANMX, ZOLN, PAIMAX, PAIMIN, CWGTMX, ZRTMAX, PAIDAT, HGTDAT, THLIQ, THICE, TBAR, RCAN, SNCAN, TCAN, GROWTH, ZSNOW, TSNOW, FSNOW, RHOSNO, SNO, Z0ORO, ZBLEND, ZPLMG0, ZPLMS0, TA, RHOAIR, RADJ, DLON, RHOSNI, DELZ, DELZW, ZBOTW, THPOR, THLMIN, PSISAT, BI, PSIWLT, HCPS, ISAND, ILG, IL1, IL2, JL, IC, ICP1, IG, IDAY, IDISP, IZREF, IWF, IPAI, IHGT, RMAT, H, HS, CWCPAV, GROWA, GROWN, GROWB, RRESID, SRESID, FRTOT, FRTOTS, FCANCMX, ICTEM, ctem_on, RMATC, AILC, PAIC, AILCG, L2MAX, NOL2PFTS, AILCGS, FCANCS, FCANC, ZOLNC, CMASVEGC, SLAIC, ipeatland)</td></tr>
<tr class="memdesc:a5fe4fa336815bc509d646edae0744405"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is hard-coded to handle the standard four vegetation categories recognized by CLASS (needleleaf trees, broadleaf trees, crops and grass), so a call to abort is performed if the number of vegetation classes, IC, is not equal to 4. A set of diagnostic and accumulator arrays is then initialized to zero, and the liquid water suction in the soil is set to an arbitrarily high value.  <a href="#a5fe4fa336815bc509d646edae0744405">More...</a><br /></td></tr>
<tr class="separator:a5fe4fa336815bc509d646edae0744405"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Calculate various land surface parameters. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a5fe4fa336815bc509d646edae0744405"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine aprep </td>
          <td>(</td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>FGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PAICNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>FSVF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSVFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRAINC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOWC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRAICS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FSNOCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RAICNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SNOCNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>DISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>DISPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOMLNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZOELNS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>CHCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CHCAPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CMASCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWLCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWFCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RBCOEF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ig)&#160;</td>
          <td class="paramname"><em>HTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>FROOTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>WTRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>CMAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>AIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>FCANS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>PSIGND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icp1)&#160;</td>
          <td class="paramname"><em>FCANMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,icp1)&#160;</td>
          <td class="paramname"><em>ZOLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>CWGTMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ZRTMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>HGTDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THICE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>TBAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>SNCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>TCAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>GROWTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>SNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>Z0ORO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZBLEND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMG0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ZPLMS0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>RADJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>DLON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ig)&#160;</td>
          <td class="paramname"><em>DELZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>DELZW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ZBOTW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THPOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>THLMIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSISAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ig)&#160;</td>
          <td class="paramname"><em>BI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ig)&#160;</td>
          <td class="paramname"><em>PSIWLT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg,ig)&#160;</td>
          <td class="paramname"><em>HCPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IDAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IDISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IZREF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IWF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IPAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IHGT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic,ig)&#160;</td>
          <td class="paramname"><em>RMAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension     (ilg,ic)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg,ic)&#160;</td>
          <td class="paramname"><em>HS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>CWCPAV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>GROWB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RRESID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>SRESID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FRTOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>FRTOTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANCMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ICTEM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>ctem_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic,ig)&#160;</td>
          <td class="paramname"><em>RMATC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ic)&#160;</td>
          <td class="paramname"><em>AILC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg,ic)&#160;</td>
          <td class="paramname"><em>PAIC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>AILCG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>L2MAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ic)&#160;</td>
          <td class="paramname"><em>NOL2PFTS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ictem)&#160;</td>
          <td class="paramname"><em>AILCGS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ictem)&#160;</td>
          <td class="paramname"><em>FCANC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>ZOLNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>CMASVEGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ic)&#160;</td>
          <td class="paramname"><em>SLAIC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ipeatland</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is hard-coded to handle the standard four vegetation categories recognized by CLASS (needleleaf trees, broadleaf trees, crops and grass), so a call to abort is performed if the number of vegetation classes, IC, is not equal to 4. A set of diagnostic and accumulator arrays is then initialized to zero, and the liquid water suction in the soil is set to an arbitrarily high value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fg</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fcs</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">fgs</td><td>Subarea fractional coverage of modelled area (X) [ ]</td></tr>
    <tr><td class="paramname">paican</td><td>Plant area index of canopy over bare ground ( <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/>) [ ]</td></tr>
    <tr><td class="paramname">paicns</td><td>Plant area index of canopy over snow ( <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fsvf</td><td>Sky view factor for bare ground under canopy ( <img class="formulaInl" alt="$\chi$" src="form_1.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fsvfs</td><td>Sky view factor for snow under canopy ( <img class="formulaInl" alt="$\chi$" src="form_1.png"/>) [ ]</td></tr>
    <tr><td class="paramname">frainc</td><td>Fractional coverage of canopy by liquid water over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">fsnowc</td><td>Fractional coverage of canopy by frozen water over snow-free subarea [ ]</td></tr>
    <tr><td class="paramname">fraics</td><td>Fractional coverage of canopy by liquid water over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">fsnocs</td><td>Fractional coverage of canopy by frozen water over snow-covered subarea [ ]</td></tr>
    <tr><td class="paramname">raican</td><td>Intercepted liquid water stored on canopy over bare ground ( <img class="formulaInl" alt="$W_l$" src="form_562.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">raicns</td><td>Intercepted liquid water stored on canopy over snow ( <img class="formulaInl" alt="$W_l$" src="form_562.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">snocan</td><td>Intercepted frozen water stored on canopy over bare soil ( <img class="formulaInl" alt="$W_f$" src="form_563.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">snocns</td><td>Intercepted frozen water stored on canopy over snow ( <img class="formulaInl" alt="$W_f$" src="form_563.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">disp</td><td>Displacement height of vegetation over bare ground (d) [m]</td></tr>
    <tr><td class="paramname">disps</td><td>Displacement height of vegetation over snow (d) [m]</td></tr>
    <tr><td class="paramname">zomlnc</td><td>Logarithm of roughness length for momentum of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">zomlcs</td><td>Logarithm of roughness length for momentum of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">zoelnc</td><td>Logarithm of roughness length for heat of vegetation over bare ground [ ]</td></tr>
    <tr><td class="paramname">zoelcs</td><td>Logarithm of roughness length for heat of vegetation over snow [ ]</td></tr>
    <tr><td class="paramname">zomlng</td><td>Logarithm of roughness length for momentum of bare ground [ ]</td></tr>
    <tr><td class="paramname">zomlns</td><td>Logarithm of roughness length for momentum of snow [ ]</td></tr>
    <tr><td class="paramname">zoelng</td><td>Logarithm of roughness length for heat of bare ground [ ]</td></tr>
    <tr><td class="paramname">zoelns</td><td>Logarithm of roughness length for heat of snow [ ]</td></tr>
    <tr><td class="paramname">rbcoef</td><td>Parameter for calculation of leaf boundary resistance ( <img class="formulaInl" alt="$C_{rb}$" src="form_575.png"/>)</td></tr>
    <tr><td class="paramname">chcap</td><td>Heat capacity of canopy over bare ground [ <img class="formulaInl" alt="$J m^{-2} K^{-1}$" src="form_567.png"/>]</td></tr>
    <tr><td class="paramname">chcaps</td><td>Heat capacity of canopy over snow [ <img class="formulaInl" alt="$J m^{-2} K^{-1}$" src="form_567.png"/>]</td></tr>
    <tr><td class="paramname">cmassc</td><td>Mass of canopy over bare ground [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">cmascs</td><td>Mass of canopy over snow [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">cwlcap</td><td>Storage capacity of canopy over bare ground for liquid water ( <img class="formulaInl" alt="$W_{l,max}$" src="form_564.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">cwfcap</td><td>Storage capacity of canopy over bare ground for frozen water ( <img class="formulaInl" alt="$W_{f,max}$" src="form_565.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">cwlcps</td><td>Storage capacity of canopy over snow for liquid water ( <img class="formulaInl" alt="$W_{l,max}$" src="form_564.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">cwfcps</td><td>Storage capacity of canopy over snow for frozen water ( <img class="formulaInl" alt="$W_{f,max}$" src="form_565.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">zplimc</td><td>Maximum water ponding depth for ground under canopy [m]</td></tr>
    <tr><td class="paramname">zplimg</td><td>Maximum water ponding depth for bare ground [m]</td></tr>
    <tr><td class="paramname">zplmcs</td><td>Maximum water ponding depth for ground under snow under canopy [m]</td></tr>
    <tr><td class="paramname">zplmgs</td><td>Maximum water ponding depth for ground under snow [m]</td></tr>
    <tr><td class="paramname">htcc</td><td>Diagnosed internal energy change of vegetation canopy due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_568.png"/>]</td></tr>
    <tr><td class="paramname">htcs</td><td>Diagnosed internal energy change of snow pack due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_568.png"/>]</td></tr>
    <tr><td class="paramname">wtrc</td><td>Diagnosed residual water transferred off the vegetation canopy [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_569.png"/>]</td></tr>
    <tr><td class="paramname">wtrs</td><td>Diagnosed residual water transferred into or out of the snow pack [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_569.png"/>]</td></tr>
    <tr><td class="paramname">wtrg</td><td>Diagnosed residual water transferred into or out of the soil [ <img class="formulaInl" alt="$kg m^{-2} s^{-1}$" src="form_569.png"/>]</td></tr>
    <tr><td class="paramname">cmai</td><td>Aggregated mass of vegetation canopy [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">froot</td><td>Fraction of total transpiration contributed by soil layer [ ]</td></tr>
    <tr><td class="paramname">htc</td><td>Diagnosed internal energy change of soil layer due to conduction and/or change in mass [ <img class="formulaInl" alt="$W m^{-2}$" src="form_568.png"/>]</td></tr>
    <tr><td class="paramname">pai</td><td>Plant area index of vegetation category over bare ground [ ]</td></tr>
    <tr><td class="paramname">pais</td><td>Plant area index of vegetation category over snow [ ]</td></tr>
    <tr><td class="paramname">ail</td><td>Leaf area index of vegetation category over bare ground [ ]</td></tr>
    <tr><td class="paramname">fcan</td><td>Fractional coverage of vegetation category over bare ground ( <img class="formulaInl" alt="$X_i$" src="form_566.png"/>) [ ]</td></tr>
    <tr><td class="paramname">fcans</td><td>Fractional coverage of vegetation category over snow ( <img class="formulaInl" alt="$X_i$" src="form_566.png"/>) [ ]</td></tr>
    <tr><td class="paramname">psignd</td><td>Minimum liquid moisture suction in soil layers [m]</td></tr>
    <tr><td class="paramname">fcanmx</td><td>Maximum fractional coverage of modelled area by vegetation category [ ]</td></tr>
    <tr><td class="paramname">zoln</td><td>Natural logarithm of maximum roughness length of vegetation category [ ]</td></tr>
    <tr><td class="paramname">paimax</td><td>Maximum plant area index of vegetation category [ ]</td></tr>
    <tr><td class="paramname">paimin</td><td>Minimum plant area index of vegetation category [ ]</td></tr>
    <tr><td class="paramname">cwgtmx</td><td>Maximum canopy mass for vegetation category [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">zrtmax</td><td>Maximum rooting depth of vegetation category [m]</td></tr>
    <tr><td class="paramname">paidat</td><td>Optional user-specified value of plant area indices of vegetation categories to override CLASS-calculated values [ ]</td></tr>
    <tr><td class="paramname">hgtdat</td><td>Optional user-specified values of height of vegetation categories to override CLASS-calculated values [m]</td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers ( <img class="formulaInl" alt="$\theta$" src="form_2.png"/> l) [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>]</td></tr>
    <tr><td class="paramname">thice</td><td>Frozen water content of soil layers under vegetation [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>]</td></tr>
    <tr><td class="paramname">tbar</td><td>Temperature of soil layers [K]</td></tr>
    <tr><td class="paramname">rcan</td><td>Intercepted liquid water stored on canopy ( <img class="formulaInl" alt="$W_l$" src="form_562.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">sncan</td><td>Intercepted frozen water stored on canopy ( <img class="formulaInl" alt="$W_f$" src="form_563.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">tcan</td><td>Vegetation canopy temperature [K]</td></tr>
    <tr><td class="paramname">growth</td><td>Vegetation growth index [ ]</td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack ( <img class="formulaInl" alt="$z_s$" src="form_571.png"/>) [m]</td></tr>
    <tr><td class="paramname">tsnow</td><td>Snowpack temperature [K]</td></tr>
    <tr><td class="paramname">fsnow</td><td>Diagnosed fractional snow coverage [ ]</td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow ( <img class="formulaInl" alt="$ s$" src="form_560.png"/>) [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_559.png"/>]</td></tr>
    <tr><td class="paramname">sno</td><td>Mass of snow pack ( <img class="formulaInl" alt="$W_s$" src="form_572.png"/>) [ <img class="formulaInl" alt="$kg m^{-2}$" src="form_558.png"/>]</td></tr>
    <tr><td class="paramname">ta</td><td>Air temperature at reference height [K]</td></tr>
    <tr><td class="paramname">rhoair</td><td>Density of air [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_559.png"/>]</td></tr>
    <tr><td class="paramname">dlon</td><td>Longitude of grid cell (east of Greenwich) [degrees]</td></tr>
    <tr><td class="paramname">z0oro</td><td>Orographic roughness length [m]</td></tr>
    <tr><td class="paramname">zblend</td><td>Atmospheric blending height for surface roughness length averaging ( <img class="formulaInl" alt="$z_b$" src="form_573.png"/>) [m]</td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow ( <img class="formulaInl" alt="$\rho$" src="form_3.png"/> s,f) [ <img class="formulaInl" alt="$kg m^{-3}$" src="form_559.png"/>]</td></tr>
    <tr><td class="paramname">zplmg0</td><td>Maximum water ponding depth for snow-free subareas (user-specified when running MESH code) [m]</td></tr>
    <tr><td class="paramname">zplms0</td><td>Maximum water ponding depth for snow-covered subareas (user-specified when running MESH code) [m]</td></tr>
    <tr><td class="paramname">radj</td><td>Latitude of grid cell (positive north of equator) [rad]</td></tr>
    <tr><td class="paramname">delzw</td><td>Permeable thickness of soil layer [m]</td></tr>
    <tr><td class="paramname">zbotw</td><td>Depth to permeable bottom of soil layer [m]</td></tr>
    <tr><td class="paramname">thpor</td><td>Pore volume in soil layer ( <img class="formulaInl" alt="$\theta$" src="form_2.png"/> p) [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>]</td></tr>
    <tr><td class="paramname">thlmin</td><td>Residual soil liquid water content remaining after freezing or evaporation [ <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>]</td></tr>
    <tr><td class="paramname">psisat</td><td>Soil moisture suction at saturation ( <img class="formulaInl" alt="$\Psi$" src="form_4.png"/> sat) [m]</td></tr>
    <tr><td class="paramname">bi</td><td>Clapp and Hornberger empirical "b" parameter [ ]</td></tr>
    <tr><td class="paramname">psiwlt</td><td>Soil moisture suction at wilting point ( <img class="formulaInl" alt="$\Psi$" src="form_4.png"/> w) [m]</td></tr>
    <tr><td class="paramname">hcps</td><td>Volumetric heat capacity of soil particles [ <img class="formulaInl" alt="$J m^{-3}$" src="form_574.png"/>]</td></tr>
    <tr><td class="paramname">isand</td><td>Sand content flag</td></tr>
    <tr><td class="paramname">delz</td><td>Soil layer thickness [m]</td></tr>
    <tr><td class="paramname">ailcg</td><td>GREEN LAI FOR USE WITH PHTSYN SUBROUTINE</td></tr>
    <tr><td class="paramname">ailcgs</td><td>GREEN LAI FOR CANOPY OVER SNOW SUB-AREA</td></tr>
    <tr><td class="paramname">fcanc</td><td>FRACTION OF CANOPY OVER GROUND FOR CTEM's 9 PFTs</td></tr>
    <tr><td class="paramname">fcancs</td><td>FRACTION OF CANOPY OVER SNOW FOR CTEM's 9 PFTs </td></tr>
  </table>
  </dd>
</dl>
<p>In the 120 loop, the growth index for crops, GROWA, is calculated (if CLASS is not being run coupled to CTEM). This is done by referring to the three-dimensional array GROWYR, which contains values corresponding to the four Julian days of the year on which crops are planted, on which they reach maturity, on which harvesting begins, and on which the harvest is complete, for each ten-degree latitude half-circle in each hemisphere. These are generic, average dates, approximated using information gleaned from annual UN FAO (Food and Agriculture Organization) reports. (In the tropics, it is assumed that areas classified as agricultural are constantly under cultivation, so all four values are set to zero.)</p>
<p>First, the latitude of the modelled area is converted from a value in radians to a value from 1 to 18, IN, corresponding to the index of the latitude circle (1 for latitudes <img class="formulaInl" alt="$80-90^o S$" src="form_656.png"/>, 18 for latitudes <img class="formulaInl" alt="$80-90^o N$" src="form_657.png"/>). Then the hemisphere index, NL, is set to 1 for the Eastern Hemisphere, and 2 for the Western Hemisphere. If the planting date for the modelled area is zero (indicating a location in the tropics), GROWA is set to 1. Otherwise, GROWA is set to 1 if the day of the year lies between the maturity date and the start of the 54harvest, and to zero if the day of the year lies between the end of the harvest and the planting date. For dates in between, the value of GROWA is interpolated between 0 and 1. Checks are performed at the end to ensure that GROWA is not less than 0 or greater than 1. If the calculated value of GROWA is vanishingly small, it is set to zero.</p>
<p>In the 150 loop the other three growth indices are evaluated, as well as the vegetation heights and plant area indices for the four vegetation categories over snow-covered and snow-free ground. The background growth index for trees, GROWTH, is evaluated separately in subroutine CGROW. It varies from a value of 0 for dormant or leafless periods to 1 for fully-leafed periods, with a sixty-day transition between the two. When senescence begins, it is set instantaneously to -1 and thereafter increases over a sixty-day period back to 0. (The onset of spring budburst and fall senescence are triggered by near-zero values of the air temperature and the first soil layer temperature.) For needleleaf trees, the growth index GROWN is simply set to the absolute value of GROWTH. For broadleaf trees, the transition period is assumed to last thirty days instead of sixty, and so the growth index GROWB is set to the absolute value of double the value of GROWTH, with upper and lower limits of 1 and 0. Finally, the growth index of grasses is set to 1 all year round.</p>
<p>A branch in the code occurs next, depending on the value of the flag IHGT. If IHGT=0, the values of vegetation height calculated by CLASS are to be used. For trees and grass, the vegetation height under snow-free conditions is assumed to be constant year-round, and is calculated as 10 times the exponential of ZOLN, the logarithm of the maximum vegetation roughness length. For crops, this maximum height is multiplied by GROWA. If IHGT=1, vegetation heights specified by the user are utilized instead. This height H for each of the four vegetation categories is used to calculate the height HS over snow-covered areas. For needleleaf and broadleaf trees, HS is set to H. For crops and grass, HS is calculated by subtracting the snow depth ZSNOW from H, to account for the burying of short vegetation by snow.</p>
<p>If CLASS is being run uncoupled to CTEM, a second branch now occurs, depending on the value of the flag IPAI. If IPAI=0, the values of plant area index calculated by CLASS are to be used. For all four vegetation categories, the plant area index over snow-free ground, PAI, is determined by interpolating between the annual maximum and minimum plant area indices using the growth index. If IPAI=1, plant area index values specified by the user are utilized instead. For trees, the plant area index over snow- covered ground, PAIS, is set to PAI. For crops and grass, if H&gt;0, PAIS is set to PAI scaled by the ratio of HS/H; otherwise, it is set to zero. Lastly, the leaf area indices for the four vegetation categories over snow-free ground, AIL, are determined from the PAI values. For needleleaf trees, AIL is estimated as 0.90 PAI; for broadleaf trees it is estimated as the excess PAI over the annual minimum value. For crops and grass AIL is assumed to be equal to PAI. (If CLASS is being run coupled to CTEM, the CTEM- generated values of PAI and AIL are used instead.)</p>
<p>In the 175 loop, the fractional coverage of the modelled area by each of the four vegetation categories is calculated, for snow-free (FCAN) and snow-covered ground (FCANS). For needleleaf and broadleaf trees, FCAN is set to the maximum coverage FCANMX of the vegetation category, scaled by the snow- free fraction of the modelled area, 1-FSNOW. For crops and grass, this calculation is modified for cases where the plant area index has been calculated as falling below a threshold value owing to growth stage or burying by snow. (If CLASS is being run coupled to CTEM, this threshold value is set to 0.05; otherwise it is set to 1.) In such cases the vegetation coverage is assumed to become discontinuous, and so an additional multiplication by PAI is performed to produce a reduced value of FCAN, and PAI is reset to the threshold value. An identical procedure is followed to determine the FCANS values.</p>
<p>The areal fractions of each of the four CLASS subareas, vegetation over bare soil (FC), bare soil (FG), vegetation over snow (FCS) and snow (FGS) are then calculated, using the FCAN and FCANS values and FSNOW. Checks are carried out, and adjustments performed if necessary, to ensure that none of the four subareas is vanishingly small. The values of FSNOW and of the four FCANs and FCANSs are recalculated accordingly. Finally, checks are carried out to ensure that each of the four subareas is greater than zero, and that their sum is unity. If this is not the case, a call to abort is performed. In the last part of the 175 loop, the limiting ponding depth for surface water is determined for each of the four subareas. If the flag IWF is zero, indicating that lateral flow of water within the soil is to be neglected, these values are assigned as follows. If the index ISAND of the first soil layer is -3 or -4, indicating a rock surface or an ice sheet, the bare soil ponding limit, ZPLIMG, is set to 1 mm; otherwise ZPLIMG is set to 2 mm. If the fractional area of snow on bare soil is greater than zero, the subarea ponding limit ZPLMGS is set to the weighted average of ZPLIMG over the areas where snow has not buried vegetation and where it has buried crops, and to 3 mm over areas where it has buried grass; otherwise to zero. If the fractional area of canopy over bare soil is greater than zero, the subarea ponding depth ZPLIMC is set to the weighted average of 1 cm under trees and 3 mm under crops and grass; otherwise to zero. If the fractional area of canopy over snow is greater than zero, the subarea ponding depth ZPLMCS is also currently set to the weighted average of 1 cm under trees and 3 mm under crops and grass; otherwise to zero. Finally, if the flag IWF is greater than zero, indicating that lateral flow of soil water is being modelled, externally derived user-specified values of the ponding limit for the four subareas are assigned.</p>
<p>In loop 200, calculations are done related to the interception of water on vegetation. First, the plant area indices of the composite vegetation canopy over the snow-free and snow-covered subareas are calculated as weighted averages of the plant area indices of the four vegetation categories over each subarea. The liquid water interception capacity <img class="formulaInl" alt="$W_{l,max}$" src="form_564.png"/> on each of the two subareas is calculated as <img class="formulaInl" alt="$W_{l,max} = 0.20 \Lambda_p$" src="form_576.png"/> where <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/> is the plant area index of the composite canopy. This simple relation has been found to work well for a wide range of canopy types and precipitation events (see Verseghy et al, 1993). If either the average amount of liquid water on the canopy, RCAN, or the total cancpy coverage, FC+FCS, is less than a small threshold value, the value of RCAN is stored in a residual water array RRESID, and RCAN is set to zero. Next the intercepted liquid water is partitioned between FC and FCS. First RCAN is re- evaluated as an average value over the canopy-covered area only, rather than over the whole modelled area. Then the intercepted liquid water amounts on vegetation over snow-free (RAICAN) and snow- covered areas (RAICNS) are calculated by making use of the relations <img class="formulaInl" alt="$W_{L,0} / \Lambda_{p,0} = W_{L,s} / \Lambda_{p,s}$" src="form_577.png"/> and <img class="formulaInl" alt="$W_l (X_0 + X_s) = W_{l,0} X_0 + W_{l,s} X_s$" src="form_578.png"/> where <img class="formulaInl" alt="$W_l$" src="form_562.png"/> is the liquid water on the canopy, <img class="formulaInl" alt="$X$" src="form_579.png"/> is the fractional area, and the subscripts <img class="formulaInl" alt="$0$" src="form_580.png"/> and <img class="formulaInl" alt="$s$" src="form_581.png"/> refer to snow-free and snow-covered areas respectively.</p>
<p>For snow interception on the canopy, a modified calculation of the plant area indices <img class="formulaInl" alt="$\Lambda_{p,0}$" src="form_582.png"/> and <img class="formulaInl" alt="$\Lambda_{p,s}$" src="form_583.png"/> is performed, assigning a weight of 0.7 to the plant area index of needleleaf trees, to account for the effect of needle clumping. The interception capacity for snow, <img class="formulaInl" alt="$W_{f,max}$" src="form_565.png"/>, is calculated following Bartlett et al. (2006), using a relation developed by Schmidt and Gluns (1991): <img class="formulaInl" alt="$W_{f,max} = 6.0 \Lambda_p [0.27 + 46.0 \rho_{s,f} ]$" src="form_584.png"/> where</p>
<p>In loops 250 and 275, calculations of the displacement height and the logarithms of the roughness lengths for heat and momentum are performed for the vegetated subareas. The displacement height <img class="formulaInl" alt="$d_i$" src="form_585.png"/> and the roughness length <img class="formulaInl" alt="$z_{0,i}$" src="form_586.png"/> for the separate vegetation categories are obtained as simple ratios of the canopy height H: <img class="formulaInl" alt="$d_i = 0.70 H$" src="form_587.png"/> <img class="formulaInl" alt="$z_{0,i} = 0.10 H$" src="form_588.png"/></p>
<p>The averaged displacement height d over the vegetated subareas is only calculated if the flag IDISP has been set to 1. If IDISP = 0, this indicates that the atmospheric model is using a terrain-following coordinate system, and thus the displacement height is treated as part of the "terrain". If DISP = 1, d is calculated as a logarithmic average over the vegetation categories: <img class="formulaInl" alt="$X ln(d) = \Sigma [X_i ln(d_i)]$" src="form_589.png"/> where X is the fractional coverage of the subarea. The averaged roughness length for momentum <img class="formulaInl" alt="$z_{0m}$" src="form_592.png"/> over the subarea is determined based on the assumption that averaging should be performed on the basis of the drag coefficient formulation. Thus, following Delage et al. (1999), and after Mason (1988): <img class="formulaInl" alt="$X/ln^2 (z_b /z_{0m}) = \Sigma [X_i /ln^2 (z_b /z_{0i})]$" src="form_590.png"/></p>
<p>The averaged roughness length for heat <img class="formulaInl" alt="$z_{0e}$" src="form_593.png"/> over the subarea is calculated as a geometric mean over the vegetation categories: <img class="formulaInl" alt="$z_{0e} z_{0mX} = \Pi ( z_{0i}^{2Xi} )$" src="form_591.png"/></p>
<p>In loop 300, calculations of the logarithms of the roughness lengths for heat and momentum are performed for the bare ground and snow-covered subareas. Background values of <img class="formulaInl" alt="$ln(z_{om})$" src="form_594.png"/> for soil, snow cover, ice sheets and urban areas are passed into the subroutine through common blocks. In CLASS, urban areas are treated very simply, as areas of bare soil with a high roughness length. The subarea values of <img class="formulaInl" alt="$ln(z_{om})$" src="form_594.png"/> for bare soil and snow are therefore adjusted for the fractional coverage of urban area. Values for the ratio between the roughness lengths for momentum and heat for bare soil and snow are also passed in via common blocks. These are used to derive subarea values of <img class="formulaInl" alt="$ln(z_{oe})$" src="form_595.png"/> from <img class="formulaInl" alt="$ln(z_{om})$" src="form_594.png"/>.</p>
<p>In loop 325, an adjustment is applied to <img class="formulaInl" alt="$ln(z_{om})$" src="form_594.png"/> if the effect of terrain roughness needs to be taken into account. If the surface orographic roughness length is not vanishingly small, its logarithm, LZ0ORO, is calculated. If it is greater than the calculated logarithm of the roughness length for momentum of any of the subareas, these are reset to LZ0ORO.</p>
<p>In loop 350, the canopy mass is calculated as a weighted average over the vegetation categories, for canopy over bare soil (CMASSC) and over snow (CMASCS). (For crops over bare soil, the mass is adjusted according to the growth index; for crops and grass over snow, the mass is additionally adjusted to take into account burying by snow.) If IDISP = 0, indicating that the vegetation displacement height is part of the "terrain", the mass of air within the displacement height is normalized by the vegetation heat capacity and added to the canopy mass. If IZREF = 2, indicating that the bottom of the atmosphere is taken to lie at the local roughness length rather than at the ground surface, the mass of air within the roughness length is likewise normalized by the vegetation heat capacity and added to the canopy mass. The canopy heat capacities over bare soil (CHCAP) and over snow (CHCAPS) are evaluated from the respective values of canopy mass and of intercepted liquid water and snow. The aggregated canopy mass CMAI is recalculated, and is used to determine the change in internal energy of the canopy, HTCC, owing to growth or disappearance of the vegetation.</p>
<p>In the 450 and 500 loops, the fraction of plant roots in each soil layer is calculated. If CLASS is being run coupled to CTEM, the CTEM-derived values are assigned. Otherwise, for each vegetation category the rooting depth ZROOT is set to the background maximum value, except in the case of crops, for which it is set to the maximum scaled by GROWA. If the soil permeable depth is less than ZROOT, ZROOT is set to this depth instead. Values are then assigned in the matrix RMAT, which stores the fraction of roots in each vegetation category for each soil layer. According to Feddes et al. (1974), the fractional root volume R(z) below a depth z is well represented for many varieties of plants by the following exponential function: <img class="formulaInl" alt="$R(z) = a_1 exp(-3.0z) + a_2.$" src="form_596.png"/></p>
<p>Making use of the boundary conditions <img class="formulaInl" alt="$R(0) = 1$" src="form_597.png"/> and <img class="formulaInl" alt="$R(z_r ) = 0$" src="form_598.png"/>, where <img class="formulaInl" alt="$z_r$" src="form_599.png"/> is the rooting depth ZROOT, it can be seen that the fraction of roots within a soil depth interval <img class="formulaInl" alt="$\Delta z$" src="form_600.png"/> can be obtained as the difference between R(z) evaluated at the top <img class="formulaInl" alt="$(z_T)$" src="form_601.png"/> and bottom <img class="formulaInl" alt="$(z_B)$" src="form_602.png"/> of the interval: <img class="formulaInl" alt="$R(\Delta z) = [exp(-3.0z_T) - exp(-3.0z_B)]/ [1 - exp(-3.0z_r)]$" src="form_603.png"/></p>
<p>The total fraction of roots in each soil layer, FROOT, can then be determined as a weighted average over the four vegetation categories.</p>
<p>In loop 450, a leaf boundary resistance parameter <img class="formulaInl" alt="$C_{rb}$" src="form_575.png"/> , incorporating the plant area indices of the four vegetation subareas, is also calculated for later use in subroutine TSOLVC: <img class="formulaInl" alt="$C_{rb} = C_l \Lambda_{p,i}^{0.5} /0.75 \bullet [1 - exp(-0.75 \Lambda_{p,i}^{0.5} )]$" src="form_604.png"/> where <img class="formulaInl" alt="$C_l$" src="form_605.png"/> is a parameter that varies with the vegetation category. The aggregated value of <img class="formulaInl" alt="$C_{rb}$" src="form_575.png"/> is obtained as a weighted average over the four vegetation categories over bare ground and snow cover.</p>
<p>In loop 600, the sky view factor <img class="formulaInl" alt="$\chi$" src="form_1.png"/> of the ground underlying the canopy is calculated for the vegetated subareas. The standard approach is to determine <img class="formulaInl" alt="$\chi$" src="form_1.png"/> as an exponential function of the plant area index <img class="formulaInl" alt="$\Lambda_p$" src="form_561.png"/> : <img class="formulaInl" alt="$\chi = exp[-c \Lambda_p ]$" src="form_606.png"/> where c is a constant depending on the vegetation category. The subarea values of <img class="formulaInl" alt="$\chi$" src="form_1.png"/> are obtained as weighted averages over the four vegetation categories.</p>
<p>In the 650 loop, the fraction of the total transpiration of water by plants that is extracted from each soil layer is determined. This is done by weighting the values of FROOT calculated above by the relative soil moisture suction in each layer: <img class="formulaInl" alt="$( \Psi_w - \Psi_i )/( \Psi_w - \Psi_{sat} )$" src="form_607.png"/> where <img class="formulaInl" alt="$\Psi_i$" src="form_608.png"/> , the soil moisture suction in the layer, is obtained as <img class="formulaInl" alt="$\Psi_i = \Psi_{sat} ( \theta_{l,i} / \theta_p )^{-b}$" src="form_609.png"/> In these equations <img class="formulaInl" alt="$\Psi_w$" src="form_610.png"/> is the soil moisture suction at the wilting point, <img class="formulaInl" alt="$\Psi_{sat}$" src="form_611.png"/> is the suction at saturation, <img class="formulaInl" alt="$\theta_{l,i}$" src="form_612.png"/> is the volumetric liquid water content of the soil layer, <img class="formulaInl" alt="$\theta_p$" src="form_613.png"/> is the pore volume, and b is an empirical parameter developed by Clapp and Hornberger (1978). The layer values of FROOT are then re-normalized so that their sum adds up to unity. In this loop, the representative soil moisture suction PSIGND is also calculated for later use in the vegetation stomatal resistance formulation, as the minimum value of <img class="formulaInl" alt="$\Psi_i$" src="form_608.png"/> and <img class="formulaInl" alt="$\Psi_w$" src="form_610.png"/> over all the soil layers.</p>
<p>Finally, in loop 800 the aggregated canopy plant area indices PAICAN and PAICNS are set back to their original values, from the modified values used for the snow interception calculations above; and if CLASS is being run coupled with CTEM, a set of CTEM-related calculations is performed.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 29 2016 15:12:15 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
