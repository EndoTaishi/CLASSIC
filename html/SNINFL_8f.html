<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM Documentation: SNINFL.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">SNINFL.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Address infiltration of rain and meltwater into snow pack, and snow ripening.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a40705488cafaec0ed712b2b926c1d67d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SNINFL_8f.html#a40705488cafaec0ed712b2b926c1d67d">sninfl</a> (R, TR, ZSNOW, TSNOW, RHOSNO, HCPSNO, WSNOW, HTCS, HMFN, PCPG, ROFN, FI, ILG, IL1, IL2, JL)</td></tr>
<tr class="separator:a40705488cafaec0ed712b2b926c1d67d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Address infiltration of rain and meltwater into snow pack, and snow ripening. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a40705488cafaec0ed712b2b926c1d67d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sninfl </td>
          <td>(</td>
          <td class="paramtype">real, dimension     (ilg)&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>TR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>HCPSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HMFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>PCPG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>ROFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Rainfall rate incident on snow pack <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">tr</td><td>Temperature of rainfall [C]</td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack <img class="formulaInl" alt="$[m] (z_g)$" src="form_803.png"/></td></tr>
    <tr><td class="paramname">tsnow</td><td>Temperature of the snow pack <img class="formulaInl" alt="$[C] (T_s)$" src="form_804.png"/></td></tr>
    <tr><td class="paramname">rhosno</td><td>Density of snow pack <img class="formulaInl" alt="$[kg m^{-3}] (\rho_s )$" src="form_805.png"/></td></tr>
    <tr><td class="paramname">hcpsno</td><td>Heat capacity of snow pack <img class="formulaInl" alt="$[J m^{-3} K^{-1}] (C_s)$" src="form_806.png"/></td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2}] (w_s)$" src="form_807.png"/></td></tr>
    <tr><td class="paramname">htcs</td><td>Internal energy change of snow pack due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}] (I_s)$" src="form_808.png"/></td></tr>
    <tr><td class="paramname">hmfn</td><td>Energy associated with freezing or thawing of water in the snow pack <img class="formulaInl" alt="$[W m^{-2}]$" src="form_809.png"/></td></tr>
    <tr><td class="paramname">pcpg</td><td>Precipitation incident on ground <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">rofn</td><td>Runoff reaching the ground surface from the bottom of the snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">fi</td><td>Fractional coverage of subarea in question on modelled area <img class="formulaInl" alt="$[ ] (X_i)$" src="form_1178.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>The rainfall rate, i.e. the liquid water precipitation rate incident on the snow pack from the atmosphere, from canopy drip and/or from melting of the top of the snow pack, may cause warming and/or melting of the snow pack as a whole. The overall change of internal energy of the snow pack as a result of the rainfall added to it, <img class="formulaInl" alt="$I_s$" src="form_1459.png"/> or HTCS, is calculated as the difference in Is between the beginning and end of the subroutine:</p>
<p><img class="formulaInl" alt="$\Delta I_s = X_i \Delta [C_s z_s T_s]/Delta t$" src="form_1460.png"/></p>
<p>where <img class="formulaInl" alt="$C_s$" src="form_1461.png"/> represents the volumetric heat capacity of the snow pack, <img class="formulaInl" alt="$T_s$" src="form_1462.png"/> its temperature, <img class="formulaInl" alt="$\Delta$" src="form_7.png"/> the length of the time step, and <img class="formulaInl" alt="$X_i$" src="form_566.png"/> the fractional coverage of the subarea under consideration relative to the modelled area.</p>
<p>Four diagnostic variables are evaluated at the outset. HRCOOL, the energy sink required to cool the whole rainfall amount to 0 C, is calculated from the rainfall rate and temperature, and the heat capacity of water. HRFREZ, the energy sink required to freeze all the rainfall, is obtained from the latent heat of melting, the density of water and the rainfall rate. HSNWRM, the energy required to warm the whole snow pack to 0 C, is calculated from the temperature, heat capacity and depth of the snow pack. HSNMLT, the energy required to melt all the snow, is obtained from the latent heat of melting and the heat capacity and depth of the snow pack.</p>
<p>If HRCOOL <img class="formulaInl" alt="$\geq$" src="form_10.png"/> (HSNWRM + HSNMLT), the energy contributed by the temperature of the rainfall is sufficient to warm to 0 C and melt the whole snow pack. HRCOOL is recalculated as the difference between HRCOOL and (HSNWRM + HSNMLT), and the snow depth is converted to a water depth ZMELT. The energy used to melt the snow is added to the diagnostic variables HMFN, representing the energy associated with water phase changes in the snow pack, and HTCS. The new temperature of the rainfall is calculated by applying HRCOOL over the new rainfall rate reaching the soil, which now includes the original rainfall rate, the melted snow pack and the liquid water that was contained in the snow pack. The depth, temperature, density, heat capacity and liquid water content of the snow pack are set to zero.</p>
<p>If HRCOOL <img class="formulaInl" alt="$\geq$" src="form_10.png"/> HSNWRM but HRCOOL &lt; (HSNWRM + HSNMLT), the energy contributed by the temperature of the rainfall is sufficient to warm the whole snowpack to 0 C but not to melt all of it. HSNMLT is therefore recalculated as HRCOOL - HSNWRM, and used to determine a melted depth of the snowpack ZMELT, which is subtracted from the snow depth ZSNOW. The energy used to melt this depth of snow is added to HMFN and HTCS. The total water now available for retention in the snowpack, WAVAIL, is obtained as the sum of the mass of melted water and the mass of water originally retained in the snow pack, WSNOW. This amount is compared to the water retention capacity of the snow pack, calculated from the maximum retention percentage by weight, WSNCAP (currently set to 4%). If WAVAIL is greater than the water retention capacity, WSNOW is set to the capacity value and the excess is reassigned to ZMELT. Otherwise WSNOW is set to WAVAIL and ZMELT is set to zero. The temperature of the snow and the temperature TR of the rainfall reaching the ground surface are each set to 0 C, HCPSNO is recalculated, and ZMELT is added to the rainfall rate R.</p>
<p>If HSNWRM <img class="formulaInl" alt="$\geq$" src="form_10.png"/> (HRCOOL + HRFREZ), the energy sink of the snow pack is sufficient to cool to 0 C and freeze all of the rainfall. HSNWRM is recalculated as the difference between HSNWRM and (HRCOOL + HRFREZ). The energy used in the freezing, HRFREZ, is added to HMFN and HTCS. The rainfall is applied to increasing the density of the snow pack RHOSNO; if the new density is greater than the density of ice, RHOSNO is reset to the ice density and ZSNOW is recalculated. HCPSNO is also recalculated, and the new snow temperature is obtained from HSNWRM, HCPSNO and ZSNOW. R and TR are set to zero.</p>
<p>If HSNWRM &gt; HRCOOL and HSNWRM &lt; (HRCOOL + HRFREZ), the energy sink of the snow pack is sufficient to cool the rainfall to 0 C, but not to freeze all of it. HRFREZ is therefore recalculated as HSNWRM – HRCOOL, and used to determine a depth of rain to be frozen, ZFREZ. The energy used in the freezing is added to HMFN and HTCS. The frozen rainfall is applied to increasing the density of the snow pack as above; if the calculated density exceeds that of ice, RHOSNO and ZSNOW are recalculated. The water available for retention in the snow pack, WAVAIL, is obtained as the sum of the unfrozen rainfall and WSNOW, and compared to the water retention capacity of the snow pack. If WAVAIL is greater than the water retention capacity, WSNOW is set to the capacity value and WAVAIL is recalculated. Otherwise WSNOW is set to WAVAIL and WAVAIL is set to zero. The heat capacity of the snow is recalculated, R is calculated from WAVAIL, and TR and TSNOW are set to zero.</p>
<p>Finally, the calculation of the change in internal energy is completed, and the rainfall rate leaving the bottom of the snow pack and reaching the soil is added to the diagnostic variables PCPG and ROFN.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 7 2016 18:08:21 for CLASS-CTEM Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
