<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASS-CTEM: SNOVAP.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASS-CTEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">SNOVAP.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Sublimation calculations for the snow pack on the ground.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a64f8b35d4ad3e8ced53867425e4500d3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SNOVAP_8f.html#a64f8b35d4ad3e8ced53867425e4500d3">snovap</a> (RHOSNO, ZSNOW, HCPSNO, TSNOW, EVAP, QFN, QFG, HTCS, WLOST, TRUNOF, RUNOFF, TOVRFL, OVRFLW, FI, R, S, RHOSNI, WSNOW, ILG, IL1, IL2, JL)</td></tr>
<tr class="separator:a64f8b35d4ad3e8ced53867425e4500d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Sublimation calculations for the snow pack on the ground. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a64f8b35d4ad3e8ced53867425e4500d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine snovap </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ZSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>HCPSNO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>TSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>EVAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension   (ilg)&#160;</td>
          <td class="paramname"><em>QFG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension  (ilg)&#160;</td>
          <td class="paramname"><em>HTCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WLOST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TRUNOF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RUNOFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>TOVRFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>OVRFLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension     (ilg)&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension     (ilg)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>RHOSNI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>WSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rhosno</td><td>Density of snow pack <img class="formulaInl" alt="$[kg m^{-3}] (\rho_s)$" src="form_1222.png"/></td></tr>
    <tr><td class="paramname">zsnow</td><td>Depth of snow pack <img class="formulaInl" alt="$[m] (z_g)$" src="form_803.png"/></td></tr>
    <tr><td class="paramname">hcpsno</td><td>Heat capacity of snow pack <img class="formulaInl" alt="$[J m^{-3} K^{-1}] (C_s)$" src="form_806.png"/></td></tr>
    <tr><td class="paramname">tsnow</td><td>Temperature of the snow pack <img class="formulaInl" alt="$[C] (T_s)$" src="form_804.png"/></td></tr>
    <tr><td class="paramname">evap</td><td>Sublimation rate from snow surface at start of subroutine <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">qfn</td><td>Sublimation from snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">qfg</td><td>Evaporation from ground <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">htcs</td><td>Internal energy change of snow pack due to conduction and/or change in mass <img class="formulaInl" alt="$[W m^{-2}] (I_s)$" src="form_808.png"/></td></tr>
    <tr><td class="paramname">wlost</td><td>Residual amount of water that cannot be supplied by surface stores <img class="formulaInl" alt="$[kg m^{-2}]$" src="form_780.png"/></td></tr>
    <tr><td class="paramname">trunof</td><td>Temperature of total runoff [K]</td></tr>
    <tr><td class="paramname">runoff</td><td>Total runoff <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">tovrfl</td><td>Temperature of overland flow [K]</td></tr>
    <tr><td class="paramname">ovrflw</td><td>Overland flow from top of soil column <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">fi</td><td>Fractional coverage of subarea in question on modelled area <img class="formulaInl" alt="$[ ] (X_i)$" src="form_1178.png"/></td></tr>
    <tr><td class="paramname">r</td><td>Rainfall rate incident on snow pack <img class="formulaInl" alt="$[m s^{-1}]$" src="form_782.png"/></td></tr>
    <tr><td class="paramname">s</td><td>Snowfall rate incident on snow pack <img class="formulaInl" alt="$[kg m^{-2} s^{-1}]$" src="form_779.png"/></td></tr>
    <tr><td class="paramname">rhosni</td><td>Density of fresh snow <img class="formulaInl" alt="$[kg m^{-3}]$" src="form_1180.png"/></td></tr>
    <tr><td class="paramname">wsnow</td><td>Liquid water content of snow pack <img class="formulaInl" alt="$[kg m^{-2}] (w_s)$" src="form_807.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>These calculations are done if a snowpack is present and there is no rainfall or snowfall occurring. The change of internal energy <img class="formulaInl" alt="$I_s$" src="form_1459.png"/> of the snow pack as a result of the change in its mass is calculated as the difference in <img class="formulaInl" alt="$I_s$" src="form_1459.png"/> between the beginning and end of the subroutine:</p>
<p><img class="formulaInl" alt="$\Delta I_s = X_i \Delta [ C_s z_s T_s ] / \Delta t$" src="form_1497.png"/></p>
<p>where <img class="formulaInl" alt="$C_s$" src="form_1461.png"/> represents the volumetric heat capacity of the snow pack, <img class="formulaInl" alt="$T_s$" src="form_1462.png"/> its temperature, <img class="formulaInl" alt="$\Delta t$" src="form_1192.png"/> the length of the time step, and <img class="formulaInl" alt="$X_i$" src="form_566.png"/> the fractional coverage of the subarea under consideration relative to the modelled area.</p>
<p>If the sublimation rate EVAP over the snow pack is negative (downward), the deposited depth of snow ZADD is calculated from EVAP by converting it from a liquid water flux to a fresh snow depth using RHOSNI, the fresh snow density. The snowpack density is updated as a weighted average of the original snow density RHOSNO and RHOSNI. The new snow depth is calculated as the sum of the old snow depth ZSNOW and ZADD. The new volumetric heat capacity of the snow pack is obtained from the heat capacities of ice and water <img class="formulaInl" alt="$C_i$" src="form_1080.png"/> and <img class="formulaInl" alt="$C_w$" src="form_1464.png"/>, the snow, ice and water densities <img class="formulaInl" alt="$\rho_s$" src="form_1465.png"/> <img class="formulaInl" alt="$\rho_i$" src="form_1498.png"/>, and <img class="formulaInl" alt="$\rho_w$" src="form_1467.png"/>, and the water content and depth of the snow pack <img class="formulaInl" alt="$w_s$" src="form_1468.png"/> and <img class="formulaInl" alt="$z_s$" src="form_571.png"/>, as:</p>
<p><img class="formulaInl" alt="$C_s = C_i [\rho_s / \rho_i ] + C_w w_s /[\rho_w z_s]$" src="form_1499.png"/></p>
<p>If the sublimation rate is positive, the depth of the snow pack ZLOST that is sublimated over the time step is calculated from EVAP using RHOSNO. If ZLOST <img class="formulaInl" alt="$\leq$" src="form_12.png"/> ZSNOW, the snow depth is reduced and HCPSNO is recalculated. Otherwise the deficit amount ZREM is calculated from ZLOST – ZSNOW and converted to a depth of water. This amount is further converted to an evaporation rate by applying a correction factor of <img class="formulaInl" alt="$(L_m+ L_v)/L_v$" src="form_1500.png"/>, where <img class="formulaInl" alt="$L_m$" src="form_1501.png"/> is the latent heat of melting and <img class="formulaInl" alt="$L_v$" src="form_1502.png"/> is the latent heat of vaporization (to account for the fact that the energy is now being used to evaporate water instead of sublimate snow). This necessarily leads to a small discrepancy between the overall vapour flux for the subarea that was originally calculated in CLASST, and the actual change of water storage in the subarea, and therefore this discrepancy is added to the housekeeping variable WLOST for use in the water balance checks done later in CHKWAT. If there was liquid water in the snow pack, WSNOW, it is assigned to overall runoff RUNOFF, and to overland flow OVRFLW. The resulting temperatures of the runoff and overland flow, TRUNOF and TOVRFL, are recalculated as weighted averages using the original runoff amounts and temperatures, and the original snow temperature TSNOW for WSNOW. The snow depth, heat capacity, temperature and water content are all set to zero. Finally, since ZREM now becomes soil evaporation rather than snow sublimation, the diagnostic variables QFN and QFG, representing the vapour flux from snow and soil respectively, are adjusted to reflect this.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 4 2017 18:26:35 for CLASS-CTEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
