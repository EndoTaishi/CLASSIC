<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: src/GRALB.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('GRALB_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">GRALB.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Purpose: Calculate visible and near-IR ground albedos.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a99502ab3789165086e450da1aef1ecd5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GRALB_8f.html#a99502ab3789165086e450da1aef1ecd5">gralb</a> (ALVSG, ALIRG, ALVSGC, ALIRGC, ALGWV, ALGWN, ALGDV, ALGDN, THLIQ, FSNOW, ALVSU, ALIRU, FCMXU, AGVDAT, AGIDAT, FG, ISAND, ILG, IG, IL1, IL2, JL, IALG)</td></tr>
<tr class="separator:a99502ab3789165086e450da1aef1ecd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Purpose: Calculate visible and near-IR ground albedos. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a99502ab3789165086e450da1aef1ecd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gralb </td>
          <td>(</td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALVSG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALIRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALVSGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALIRGC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALGWV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALGWN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALGDV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALGDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>THLIQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FSNOW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALVSU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>ALIRU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (ilg)&#160;</td>
          <td class="paramname"><em>FCMXU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>AGVDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>AGIDAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension    (ilg)&#160;</td>
          <td class="paramname"><em>FG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension (ilg,ig)&#160;</td>
          <td class="paramname"><em>ISAND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ILG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IL2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>JL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IALG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alvsg</td><td>Visible albedo of bare ground <img class="formulaInl" alt="$[ ] (\alpha_{g,VIS})$" src="form_1406.png"/></td></tr>
    <tr><td class="paramname">alirg</td><td>Near-IR albedo of bare ground <img class="formulaInl" alt="$[ ] (\alpha_{g,NIR})$" src="form_1407.png"/></td></tr>
    <tr><td class="paramname">alvsgc</td><td>Visible albedo of ground under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">alirgc</td><td>Near-IR albedo of ground under vegetation canopy [ ]</td></tr>
    <tr><td class="paramname">algwv</td><td>Visible albedo of wet soil for modelled area <img class="formulaInl" alt="$[ ] (alpha_{g,NIR,wet})$" src="form_1911.png"/></td></tr>
    <tr><td class="paramname">algwn</td><td>Near-infrared albedo of wet soil for modelled area <img class="formulaInl" alt="$[ ] (alpha_{g,NIR,wet})$" src="form_1911.png"/></td></tr>
    <tr><td class="paramname">algdv</td><td>Visible albedo of dry soil for modelled area <img class="formulaInl" alt="$[ ] (alpha_{g,VIS,dry})$" src="form_1912.png"/></td></tr>
    <tr><td class="paramname">algdn</td><td>Near-infrared albedo of dry soil for modelled area <img class="formulaInl" alt="$[ ] (alpha_{g,NIR,dry})$" src="form_1913.png"/></td></tr>
    <tr><td class="paramname">thliq</td><td>Volumetric liquid water content of soil layers <img class="formulaInl" alt="$[m^3 m^{-3}]$" src="form_759.png"/></td></tr>
    <tr><td class="paramname">alvsu</td><td>Visible albedo of urban part of modelled area <img class="formulaInl" alt="$[ ] (alpha_{u,VIS})$" src="form_1410.png"/></td></tr>
    <tr><td class="paramname">aliru</td><td>Near-IR albedo of urban part of modelled area <img class="formulaInl" alt="$[ ] (alpha_{u,NIR})$" src="form_1411.png"/></td></tr>
    <tr><td class="paramname">fcmxu</td><td>Fractional coverage of urban part of modelled area <img class="formulaInl" alt="$[ ] (X_u)$" src="form_1412.png"/></td></tr>
    <tr><td class="paramname">agvdat</td><td>Assigned value of visible albedo of ground – optional [ ]</td></tr>
    <tr><td class="paramname">agidat</td><td>Assigned value of near-IR albedo of ground – optional [ ]</td></tr>
    <tr><td class="paramname">fg</td><td>Fractional coverage of bare soil on modelled area <img class="formulaInl" alt="$[ ] (X_g)$" src="form_1914.png"/></td></tr>
    <tr><td class="paramname">fsnow</td><td>Fractional coverage of snow on modelled area [ ]</td></tr>
    <tr><td class="paramname">isand</td><td>Soil type flag based on sand content, assigned in subroutine CLASSB </td></tr>
  </table>
  </dd>
</dl>
<p>If the ISAND flag for the surface soil layer is greater than or equal to zero (indicating mineral soil), first the urban area not covered by snow is evaluated. Next the visible and near-IR open ground albedos, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/>, for each wavelength range, are calculated on the basis of the wet and dry ground albedos <img class="formulaInl" alt="$\alpha_{g,wet}$" src="form_765.png"/> and <img class="formulaInl" alt="$\alpha_{g,dry}$" src="form_766.png"/> which were assigned for the modelled area in CLASSB. Idso et al. (1975) found a correlation between the soil liquid moisture content in the top 10 cm of soil (represented in CLASS by that of the first soil layer, <img class="formulaInl" alt="$\theta_{1,1}$" src="form_767.png"/>) and the total surface albedo <img class="formulaInl" alt="$\alpha_{g,T}$" src="form_768.png"/>: for water contents less than 0.22 <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>, <img class="formulaInl" alt="$\alpha_{g,T}$" src="form_768.png"/> took on the value of <img class="formulaInl" alt="$\alpha_{g,dry}$" src="form_766.png"/>; for liquid water contents greater than 0.26 <img class="formulaInl" alt="$m^3 m^{-3}$" src="form_570.png"/>, <img class="formulaInl" alt="$\alpha_{g,T}$" src="form_768.png"/> took on the value of <img class="formulaInl" alt="$\alpha_{g,wet}$" src="form_765.png"/>. For values of <img class="formulaInl" alt="$\theta_{1,1}$" src="form_767.png"/> between these two limits, a linear relationship is assumed:</p>
<p><img class="formulaInl" alt="$[\alpha_{g,T} - \alpha_{g,dry} ] / [\theta_{l,1} - 0.22] = [\alpha_{g,wet} - \alpha_{g,dry} ]/[0.26 - 0.22]$" src="form_769.png"/></p>
<p>Thus, in GRALB for each of the two wavelength ranges <img class="formulaInl" alt="$\alpha_{g}$" src="form_1915.png"/> is calculated as follows:</p>
<p><img class="formulaInl" alt="$\alpha_{g,T} = \alpha_{g,dry}$" src="form_1837.png"/> <img class="formulaInl" alt="$\theta_{l,1} \leq 0.22 $" src="form_1838.png"/> <br />
 <img class="formulaInl" alt="$\alpha_{g,T} = \theta_{l,1} [\alpha_{g,wet} - \alpha_{g,dry} ]/0.04 - 5.50 [\alpha_{g,wet} - \alpha_{g,dry} ] + \alpha_{g,dry} $" src="form_1839.png"/> <img class="formulaInl" alt="$0.22 < \theta_{l,1} < 0.26 $" src="form_1840.png"/> <br />
 <img class="formulaInl" alt="$\alpha_{g,T} = \alpha{g,wet} $" src="form_1841.png"/> <img class="formulaInl" alt="$ 0.26 \leq \theta_{l,1}$" src="form_1842.png"/></p>
<p>Afterwards, a correction is applied to <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> in order to account for the possible presence of urban surfaces over the modelled area. Visible and near-IR albedos are assigned for local urban areas, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/>, as part of the background data (see the section on “Data Requirements”). A weighted average over the bare soil area <img class="formulaInl" alt="$X_g$" src="form_1916.png"/> is calculated from the fractional snow-free urban area <img class="formulaInl" alt="$X_u$" src="form_774.png"/> as:</p>
<p><img class="formulaInl" alt="$\alpha_{g,VIS} = [X_u \alpha_{u,VIS} + (X_g-X_u ) \alpha_{g,VIS}] / X_g $" src="form_1917.png"/><br />
 <img class="formulaInl" alt="$\alpha_{g,NIR} = [X_u \alpha_{u,NIR} + (1.0-X_u ) \alpha_{g,NIR}] / X_g $" src="form_1918.png"/></p>
<p>If the soil on the modelled area is not mineral, i.e. if the ISAND flag is less than zero, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> are determined as follows:</p>
<p>If ISAND = -2, indicating organic soil, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> are assigned values of 0.05 and 0.30 respectively from the lookup tables in the block data subroutine CLASSBD, corresponding to average measured values reported in Comer et al. (2000) <a class="el" href="citelist.html#CITEREF_Comer2000-mz">[23]</a>.</p>
<p>If ISAND = -3, indicating rock at the surface, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> are assigned the dry ground values from CLASSB.</p>
<p>If ISAND = -4, indicating continental ice sheet or glacier, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> are assigned values of 0.95 and 073 from CLASSBD, reflecting values reported for Antarctica (e.g. Sellers, 1974).</p>
<p>The above calculations are all performed if the flag IALG is set to zero. If IALG is set to one, indicating that assigned ground albedos are to be used instead of calculated values, <img class="formulaInl" alt="$\alpha_{g,VIS}$" src="form_770.png"/> and <img class="formulaInl" alt="$\alpha_{g,NIR}$" src="form_771.png"/> are set to the assigned values AGVDAT and AGIDAT respectively.</p>
<p>Lastly, the ground values of visible and near-IR albedo under the vegetation canopy are currently set equal to the open values (this approach is under review).</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="GRALB_8f.html">GRALB.f</a></li>
    <li class="footer">Generated on Tue Sep 12 2017 13:46:17 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
