<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CLASSIC: src/phenolgy.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CLASSIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('phenolgy_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">phenolgy.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Canadian Terrestrial Ecosystem Model (CTEM) Phenology, Leaf Turnover &amp; Mortality Subroutine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa86881c05b7b687b83336b04ee809ebc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phenolgy_8f90.html#aa86881c05b7b687b83336b04ee809ebc">phenolgy</a> (gleafmas, bleafmas,il1,il2, leapnow,tbar,thliq,THLW,THFC,ta,anveg,iday,radl, roottemp,rmatctem, stemmass, rootmass,sort,nol2pfts,fcancmx, isand,</td></tr>
<tr class="separator:aa86881c05b7b687b83336b04ee809ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Canadian Terrestrial Ecosystem Model (CTEM) Phenology, Leaf Turnover &amp; Mortality Subroutine. </p>
<p>The leaf phenology parametrization used in CTEM v. 1.0 is described in detail by <a class="el" href="citelist.html#CITEREF_Arora2005-6b1">[6]</a>. Changes between version 1.0 and 2.0 are limited to parameter values and the parametrization is briefly described here. There are four different leaf phenological states in which vegetation can be at a given instant: (i) no leaves or dormant, (ii) maximum growth, (iii) normal growth and (iv) leaf fall or harvest. PFTs may go through only some, or all, of these phenological states depending on their deciduousness. A broadleaf cold deciduous tree, for example, transitions through all these four states in a year. In winter, the broadleaf cold deciduous trees are in the no leaves/dormant state; favourable climatic conditions in spring trigger leaf growth and the tree enters the maximum leaf growth state when all the NPP is allocated to leaves to accelerate leaf out; when the LAI reaches a threshold (described below) the tree enters the normal leaf growth state and NPP is also allocated to stem and root components; finally the arrival of autumn triggers leaf fall and the trees go into the leaf fall mode where no carbon is allocated to leaves (but it continues for roots and stems). When all the leaves have been shed, the trees go into the no leaves or dormant state again and the cycle is repeated the next year. The evergreen tree PFTs and the grass PFTs do not enter the leaf fall state and maintain a leaf canopy as long as environmental conditions are favourable. Although drought and cold stress cause accelerated leaf loss compared to the normal leaf turnover from these PFTs, they do not explicitly go into the leaf fall mode where the intent is to lose all leaves in a specified amount of time.</p>
<p>The leaf phenological state transitions are dependent upon environmental conditions. In particular, the transition from no leaves/dormant state to the maximum growth state is based on the carbon-gain approach. CTEM uses <img class="formulaInl" alt="$\textit{virtual}$" src="form_346.png"/> leaves to assess favourable meteorological conditions for leaf out. The virtual leaves photosynthesize and respire in a manner similar to normal leaves except the carbon gain or loss is not taken into account in vegetation's carbon balance. A positive net leaf photosynthesis rate ( <img class="formulaInl" alt="$G_{canopy,net}$" src="form_1095.png"/>, Eq. Gnet}) for the virtual leaves over seven consecutive days indicates the arrival of favourable growth conditions and triggers leaf onset and the associated transition from the no leaves/dormant state to the maximum leaf growth state, when the entire positive NPP is allocated to leaves ( <img class="formulaInl" alt="$a_{fL} = 1$" src="form_1018.png"/>, <img class="formulaInl" alt="$a_{fS} = a_{fR} = 0$" src="form_1019.png"/>). When LAI reaches <img class="formulaInl" alt="${LAI}_{thrs}$" src="form_1096.png"/> then the vegetation switches to the normal growth mode and positive NPP is allocated to all three vegetation components &ndash; leaves, stem and roots ( <img class="formulaInl" alt="$a_{fL}, a_{fS}, a_{fR} > 0$" src="form_1097.png"/>). <img class="formulaInl" alt="${LAI}_{thrs}$" src="form_1096.png"/> is calculated as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[{LAI}_{thrs} = L_f \left[ {SLA}\left(\frac{C_S + C_R}{\eta}\right)^{1/\kappa} \right].\]" src="form_2013.png"/>
</p>
<p>The PFT-specific <img class="formulaInl" alt="$L_f$" src="form_2014.png"/> term (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) calculates <img class="formulaInl" alt="${LAI}_{thrs}$" src="form_1096.png"/> to be typically between 40 and 50\,{%} of the maximum LAI that a given amount of stem and root biomass can support (based on the terms in the square brackets and Eq. (propwoody}). <img class="formulaInl" alt="$SLA$" src="form_1099.png"/> is the specific leaf area (Eq. sla}). This rule for transition from a maximum to a normal growth state is also used for evergreen tree PFTs and grass PFTs. Similar to <img class="formulaInl" alt="${LAI}_{thrs}$" src="form_1096.png"/>, the LAI of virtual leaves is <img class="formulaInl" alt="$7.5\,{\%}$" src="form_352.png"/> of the maximum LAI a given amount of root and stem biomass can support for tree and crop PFTsand <img class="formulaInl" alt="$2.5\,{\%}$" src="form_353.png"/> for grass PFTs. In addition, the LAI of virtual leaves is constrained to be, at least, <img class="formulaInl" alt="$0.3\,m^2\,m^{-2}$" src="form_354.png"/> for tree PFTs and <img class="formulaInl" alt="$0.2\,m^2\,m^{-2}$" src="form_355.png"/> for crop and grass PFTs.</p>
<p>The transition from the normal growth state to the leaf fall state is triggered by unfavourable environmental conditions and shorter day length. Broadleaf deciduous trees transition to the leaf fall state when either: (i) day length is less than <img class="formulaInl" alt="$11\,h$" src="form_356.png"/> and the rooting zone temperature drops below <img class="formulaInl" alt="$11.15\,C$" src="form_357.png"/> or (ii) when the rooting zone temperature drops below <img class="formulaInl" alt="$8\,C$" src="form_358.png"/> regardless of the day length. Needleleaf deciduous tress begin leaf fall after seven consecutive days with daily mean air temperature below <img class="formulaInl" alt="$-5\,C$" src="form_359.png"/>. Leaf fall occurs over a period of 15 days. In the leaf fall state, the vegetation continues carbon allocation to its root and stem components, but not to leaves ( <img class="formulaInl" alt="$a_{fL} = 0$" src="form_1100.png"/>, <img class="formulaInl" alt="$a_{fS} + a_{fR} = 1$" src="form_1101.png"/>). Evergreen trees and grasses do not enter the leaf fall state and neither do the broadleaf drought deciduous trees. The implication for the latter PFT is that if the climate changes and the dry season becomes shorter, then the trees will keep their leaves on for a longer period of time since broadleaf drought deciduous trees lose leaves due to soil moisture stress (described below).</p>
<p>The model vegetation is able to transition between the different leaf phenological states in response to changing conditions. For example, a leaf out in spring for broadleaf cold deciduous trees can be interrupted by a cold event when the vegetation goes into a leaf fall state until the return of more favourable conditions.</p>
<p>Leaf litter generation is caused by normal turnover of leaves ( <img class="formulaInl" alt="$\Omega_N$" src="form_2015.png"/>, <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>) and also due to cold ( <img class="formulaInl" alt="$\Omega_C$" src="form_2016.png"/>, <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>) and drought ( <img class="formulaInl" alt="$\Omega_D$" src="form_2017.png"/>, <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>) stress, both of which contribute to seasonality of LAI. For example, the leaf loss associated with drought and reduced photosynthesis during the dry season are the principal causes of the seasonality of LAI for the broadleaf drought deciduous tree PFT.</p>
<p>The conversion of leaf carbon to leaf litter ( <img class="formulaInl" alt="$D_L$" src="form_2018.png"/>, <img class="formulaInl" alt="$kg\,C\,m^{-2}\,day^{-1}$" src="form_95.png"/>) is expressed as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{cltod} D_L = C_L[1 - \exp(-\Omega_N - \Omega_C - \Omega_{D})],\]" src="form_2019.png"/>
</p>
<p>where ( <img class="formulaInl" alt="$\Omega_{N,C,D}$" src="form_1106.png"/>, <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>) are the leaf loss rates associated with normal turnover of leaves and the cold and drought stress. The rate of normal turnover of leaves is governed by PFT-specific leaf lifespan ( <img class="formulaInl" alt="$\tau_L$" src="form_1883.png"/>, <img class="formulaInl" alt="$yr$" src="form_386.png"/>) as <img class="formulaInl" alt="$\Omega_N= 1/365 \tau_L$" src="form_2020.png"/> (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>} for PFT specific values of <img class="formulaInl" alt="$\tau_L$" src="form_1883.png"/>). The leaf loss rate associated with cold stress ( <img class="formulaInl" alt="$\Omega_C$" src="form_2016.png"/>) is calculated as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{gamma_cold} \Omega_C = \Omega_{C,max}L_{cold}^3, \]" src="form_2021.png"/>
</p>
<p>where <img class="formulaInl" alt="$\Omega_{C,max}$" src="form_1108.png"/> ( <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>, see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) is the maximum cold stress loss rate. <img class="formulaInl" alt="$L_{cold}$" src="form_1109.png"/> is a scalar that varies between 0 and 1 as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{cldls} L_{cold} = \begin{cases} 1, \quad T_a < \left(T_{cold}^{leaf} - 5\right) \\ 1 - \frac{T_a - \left(T_{cold}^{leaf} - 5\right)}{5}, \\ \quad T_{cold}^{leaf} > T_a > (T_{cold}^{leaf} - 5) \\ 0, \quad T_a > T_{cold}^{leaf} ,\\ \end{cases} \]" src="form_2022.png"/>
</p>
<p>where <img class="formulaInl" alt="$T_{cold}^{leaf}$" src="form_1110.png"/> is a PFT-specific temperature threshold below which a PFT experiences damage to its leaves promoting leaf loss (see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) and <img class="formulaInl" alt="$T_a$" src="form_692.png"/> is the daily mean air temperature ( <img class="formulaInl" alt="$C$" src="form_27.png"/>). The leaf loss rate due to drought stress is calculated in a similar manner</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{gamma_dry} \Omega_{D} = \Omega_{D,max}\,(1-\phi_{root})^3, \]" src="form_2023.png"/>
</p>
<p>where <img class="formulaInl" alt="$\Omega_{D,max}$" src="form_2024.png"/> ( <img class="formulaInl" alt="$day^{-1}$" src="form_42.png"/>, see also <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a>) is the maximum drought stress loss rate and <img class="formulaInl" alt="$\phi_{root}$" src="form_622.png"/> (Eq. degsoilsat}) is the degree of soil saturation in the rooting zone. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="aa86881c05b7b687b83336b04ee809ebc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine phenolgy </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>gleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>bleafmas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>il2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>leapnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>tbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>thliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THLW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>THFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>anveg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg)&#160;</td>
          <td class="paramname"><em>radl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>roottemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc,ignd)&#160;</td>
          <td class="paramname"><em>rmatctem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>stemmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>rootmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(icc)&#160;</td>
          <td class="paramname"><em>sort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ican)&#160;</td>
          <td class="paramname"><em>nol2pfts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ilg,icc)&#160;</td>
          <td class="paramname"><em>fcancmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ilg,ignd)&#160;</td>
          <td class="paramname"><em>isand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">il1</td><td>il1=1</td></tr>
    <tr><td class="paramname">il2</td><td>il2=ilg</td></tr>
    <tr><td class="paramname">iday</td><td>day of year</td></tr>
    <tr><td class="paramname">leapnow</td><td>true if this year is a leap year. Only used if the switch 'leap' is true.</td></tr>
    <tr><td class="paramname">sort</td><td>index for correspondence between 9 pfts and the 12 values in parameters vectors</td></tr>
    <tr><td class="paramname">nol2pfts</td><td>number of level 2 ctem pfts</td></tr>
    <tr><td class="paramname">gleafmas</td><td>green or live leaf mass in</td></tr>
    <tr><td class="paramname">bleafmas</td><td>brown or dead leaf mass in</td></tr>
    <tr><td class="paramname">ta</td><td>air temperature, k</td></tr>
    <tr><td class="paramname">tbar</td><td>soil temperature, k</td></tr>
    <tr><td class="paramname">thliq</td><td>liquid soil moisture content in 3 so</td></tr>
    <tr><td class="paramname">anveg</td><td>net photosynthesis rate of ctem's pfts, umol co2/m2.s</td></tr>
    <tr><td class="paramname">roottemp</td><td>root temperature, which is a function of soil temperature of course, k.</td></tr>
    <tr><td class="paramname">rmatctem</td><td>fraction of roots in each soil layer for each pft</td></tr>
    <tr><td class="paramname">stemmass</td><td>stem mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">rootmass</td><td>root mass for each of the 9 ctem pfts, <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/></td></tr>
    <tr><td class="paramname">fcancmx</td><td>max. fractional coverage of ctem's 9 pfts, but this can be modified by land-use change, and competition between pfts</td></tr>
    <tr><td class="paramname">thfc</td><td>field capacity soil moisture content both calculated in allocate subroutine</td></tr>
    <tr><td class="paramname">thlw</td><td>wilting point soil moisture content</td></tr>
    <tr><td class="paramname">radl</td><td>latitude in radians </td></tr>
  </table>
  </dd>
</dl>
<hr/>
<p> Constants and parameters are located in <a class="el" href="ctem__params_8f90.html" title="This module holds CTEM globally accessible parameters These parameters are used in all CTEM subroutin...">ctem_params.f90</a> </p><hr/>
<p>initialize required arrays to zero</p>
<p>initialization ends </p><hr/>
<p>convert green leaf mass into leaf area index using specific leaf area <img class="formulaInl" alt="$(sla, m^2 /kg c)$" src="form_1454.png"/> estimated using leaf life span. see bio2str subroutine for more details.</p>
<p>also find threshold lai as a function of stem+root biomass which is used to determine leaf status</p>
<p>using green leaf area index (ailcg) determine the leaf status for each pft. loops 190 and 200 thus initialize lfstatus, if this this information is not passed specifically as an initialization quantity.</p>
<p>knowing lfstatus (after initialization above or using value from from previous time step) we decide if we stay in a given leaf mode or we move to some other mode.</p>
<h2>we start with the "no leaves" mode </h2>
<p>add one to pandays(i,j) if daily an is positive, otherwise set it to zero.</p>
<p>if in "no leaves" mode check if an has been positive over last dayschk(j) days to move into "max. growth" mode. if not we stay in "no leaves" mode. also set the chkmode(i,j) switch to 1.</p>
<p>find day length using day of year and latitude. this is to be used for initiating leaf offset for broad leaf dcd trees.</p>
<p>even if pandays criteria has been satisfied do not go into max. growth mode if environmental conditions are such that they will force leaf fall or harvest mode.</p>
<p>crops</p>
<h2>if in "max growth" mode </h2>
<p>if mode hasn't been checked and we are in "max. growth" mode, then check if we are above pft-dependent lai threshold. if lai is more then this threshold we move into "normal growth" mode, otherwise we stay in "max growth" mode so that leaves can grow at their max. climate-dependent rate</p>
<p>for dcd trees we also need to go into "leaf fall" mode directly from "max. growth" mode.</p>
<p>ndl dcd</p>
<p>bdl dcd cold</p>
<p>bdl dcd dry</p>
<h2>if in "normal growth" mode </h2>
<p>if in "normal growth" mode then go through every pft individually and follow set of rules to determine if we go into "fall/harvest" mode</p>
<p>needle leaf dcd</p>
<p>broad leaf evg</p>
<p>broad leaf dcd cold we use daylength and roottemp to initiate leaf offset</p>
<p>broad leaf dcd dry we still use daylength and roottemp to initiate leaf offset, for the pathological cases of dry dcd trees being further away from the equator then we can imagine. other wise leaf loss will occur due to drought anyway.</p>
<p>"normal growth" to "fall/harvest" transition for crops is based on specified lai. we harvest if lai of crops reaches a threshold. if lai doesn't reach this threshold (say due to a bad year) we harvest anyway if it starts getting cold, otherwise we don't harvest.</p>
<pre class="fragment">add a branch for icc =12, j6, 7 = shrubs,j 8,9 = crops, j10,11,12
= grasses, YW April 15, 2015 -----------------------------------\ </pre><p>"normal growth" to "max. growth" transition for grasses</p>
<h2>if in "fall/harvest" mode </h2>
<p>grasses and evg trees do not come into this mode, because they want to stay green if possible. this mode is activated for dcd plants and crops. once in this mode dcd trees loose their leaves and crops are harvested. ndl dcd trees keep loosing their leaves at rate determined by cold stress, bdl dcd trees loose their leaves at a specified rate, and crops are harvested over a period of 15 days. dcd trees and crops stay in "leaf fall/harvest" model until all green leaves are gone at which time they switch into "no leaves" mode, and then wait for the climate to become favourable to go into "max. growth" mode</p>
<p>check that leaf status of all vegetation types in all grid cells has been updated</p>
<hr/>
<p>having decided leaf status for every pft, we now calculate normal leaf turnover, cold and drought stress mortality, and for bdl dcd plants we also calculate specified loss rate if they are in "leaf fall" mode, and for crops we calculate harvest loss, if they are in "harvest" mode.</p>
<p>all these loss calculations will yield leaf litter in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/> for the given day for all pfts</p>
<p>normal leaf turn over</p>
<p>for drought stress related mortality we need field capacity and wilting point soil moisture contents, which we calculated in allocate subroutine</p>
<p>estimate drought stress term averaged over the rooting depth for each pft</p>
<pre class="fragment">    using this drought stress term and our two vegetation-dependent
    parameters we find leaf loss rate associated with drought </pre><p>estimate leaf loss in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/> due to drought stress</p>
<p>similar to drgtstrs we find coldstrs for each pft. we assume that max. cold stress related leaf loss occurs when temperature is 5 c or more below pft's threshold</p>
<p>using this cold stress term and our two vegetation-dependent parameters we find leaf loss rate associated with cold cold related leaf loss rate</p>
<p>estimate leaf loss in <img class="formulaInl" alt="$kg c/m^2$" src="form_614.png"/> due to cold stress</p>
<p>now that we have all types of leaf losses (due to normal turnover, cold and drought stress, and fall/harvest) we take the losses for grasses and use those to turn live green grass into dead brown grass. we then find the leaf litter from the brown grass which will then go into the litter pool.</p>
<p>we assume life span of brown grass is 10% that of green grass but this is an adjustable parameter.</p>
<p>combine nrmlloss, drgtloss, and coldloss together to get total leaf litter generated, which is what we use to update gleafmass, except for grasses, for which we have already updated gleafmass.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="phenolgy_8f90.html">phenolgy.f90</a></li>
    <li class="footer">Generated on Tue Sep 12 2017 13:46:17 for CLASSIC by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
